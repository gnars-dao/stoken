"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SessionsClient = void 0;
const utils_1 = require("@trezor/utils");
const typedEventEmitter_1 = require("@trezor/utils/lib/typedEventEmitter");
class SessionsClient extends typedEventEmitter_1.TypedEmitter {
    constructor({ requestFn, registerBackgroundCallbacks, }) {
        super();
        this.caller = (0, utils_1.getWeakRandomId)(3);
        this.id = 0;
        this.request = params => {
            params.caller = this.caller;
            params.id = this.id;
            this.id++;
            return requestFn(params);
        };
        if (registerBackgroundCallbacks) {
            registerBackgroundCallbacks(descriptors => {
                this.emit('descriptors', descriptors);
            });
        }
    }
    handshake() {
        return this.request({ type: 'handshake' });
    }
    enumerateIntent() {
        return this.request({ type: 'enumerateIntent' });
    }
    enumerateDone(payload) {
        return this.request({ type: 'enumerateDone', payload });
    }
    acquireIntent(payload) {
        return this.request({ type: 'acquireIntent', payload });
    }
    acquireDone(payload) {
        return this.request({ type: 'acquireDone', payload });
    }
    releaseIntent(payload) {
        return this.request({ type: 'releaseIntent', payload });
    }
    releaseDone(payload) {
        return this.request({ type: 'releaseDone', payload });
    }
    getSessions() {
        return this.request({ type: 'getSessions' });
    }
    getPathBySession(payload) {
        return this.request({ type: 'getPathBySession', payload });
    }
}
exports.SessionsClient = SessionsClient;
//# sourceMappingURL=client.js.map