"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createSocket = void 0;
const errors_1 = require("@trezor/blockchain-link-types/lib/constants/errors");
const tcp_1 = require("./tcp");
const tls_1 = require("./tls");
const tor_1 = require("./tor");
const createSocket = (url, options) => {
    const [host, portString, protocol] = url.replace(/.*:\/\//, '').split(':');
    if (!host)
        throw new errors_1.CustomError('Missing host');
    const port = Number.parseInt(portString, 10);
    if (!port)
        throw new errors_1.CustomError('Invalid port');
    const { timeout, keepAlive, proxyAgent } = options || {};
    if (proxyAgent) {
        return new tor_1.TorSocket({
            host,
            port,
            timeout,
            keepAlive,
            proxyAgent,
        });
    }
    if (protocol === 't') {
        return new tcp_1.TcpSocket({ host, port, timeout, keepAlive });
    }
    if (!protocol || protocol === 's') {
        return new tls_1.TlsSocket({ host, port, timeout, keepAlive });
    }
    throw new errors_1.CustomError('Invalid protocol');
};
exports.createSocket = createSocket;
//# sourceMappingURL=index.js.map