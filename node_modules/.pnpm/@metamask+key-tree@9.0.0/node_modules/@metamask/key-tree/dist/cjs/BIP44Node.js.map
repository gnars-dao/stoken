{"version":3,"sources":["../../src/BIP44Node.ts"],"sourcesContent":["import { assert } from '@metamask/utils';\n\nimport type {\n  BIP44Depth,\n  PartialHDPathTuple,\n  RootedSLIP10PathTuple,\n  SLIP10Path,\n} from './constants';\nimport {\n  BIP44PurposeNodeToken,\n  BIP_32_PATH_REGEX,\n  BIP_39_PATH_REGEX,\n  MAX_BIP_44_DEPTH,\n  MIN_BIP_44_DEPTH,\n} from './constants';\nimport type { SupportedCurve } from './curves';\nimport {\n  decodeExtendedKey,\n  encodeExtendedKey,\n  PRIVATE_KEY_VERSION,\n  PUBLIC_KEY_VERSION,\n} from './extended-keys';\nimport { SLIP10Node, validateBIP32Depth } from './SLIP10Node';\nimport { isHardened } from './utils';\n\nexport type BIP44ExtendedKeyOptions = {\n  readonly depth: number;\n  readonly parentFingerprint: number;\n  readonly index: number;\n  readonly chainCode: Uint8Array | string;\n  readonly privateKey?: Uint8Array | string | undefined;\n  readonly publicKey?: Uint8Array | string | undefined;\n};\n\nexport type BIP44DerivationPathOptions = {\n  readonly derivationPath: RootedSLIP10PathTuple;\n};\n\n/**\n * A wrapper for BIP-44 Hierarchical Deterministic (HD) tree nodes, i.e.\n * cryptographic keys used to generate keypairs and addresses for cryptocurrency\n * protocols.\n */\nexport type JsonBIP44Node = {\n  /**\n   * The 0-indexed BIP-44 path depth of this node.\n   *\n   * A BIP-44 path is of the form:\n   *\n   * `m / 44' / coin_type' / account' / change / address_index`\n   *\n   * With the following depths:\n   *\n   * `0 / 1 / 2 / 3 / 4 / 5`\n   */\n  readonly depth: BIP44Depth;\n\n  /**\n   * The fingerprint of the master node, i.e., the node at depth 0. May be\n   * undefined if this node was created from an extended key.\n   */\n  readonly masterFingerprint?: number | undefined;\n\n  /**\n   * The fingerprint of the parent key, or 0 if this is a master node.\n   */\n  readonly parentFingerprint: number;\n\n  /**\n   * The index of the node, or 0 if this is a master node.\n   */\n  readonly index: number;\n\n  /**\n   * The hexadecimal string representation of the private key for this node.\n   * May be `undefined` if the node is a public node.\n   */\n  readonly privateKey?: string | undefined;\n\n  /**\n   * The hexadecimal string representation of the public key for this node.\n   */\n  readonly publicKey: string;\n\n  /**\n   * The hexadecimal string representation of the chain code for this node.\n   */\n  readonly chainCode: string;\n};\n\nexport type BIP44NodeInterface = JsonBIP44Node & {\n  /**\n   * @returns A JSON-compatible representation of this node's data fields.\n   */\n  toJSON(): JsonBIP44Node;\n};\n\n/**\n * A wrapper for BIP-44 Hierarchical Deterministic (HD) tree nodes, i.e.\n * cryptographic keys used to generate keypairs and addresses for cryptocurrency\n * protocols.\n *\n * This class contains methods and fields that may not serialize well. Use\n * {@link BIP44Node.toJSON} to get a JSON-compatible representation.\n */\nexport class BIP44Node implements BIP44NodeInterface {\n  /**\n   * Wrapper of the {@link fromExtendedKey} function. Refer to that function\n   * for documentation.\n   *\n   * @param json - The JSON representation of a SLIP-10 node.\n   */\n  static async fromJSON(json: JsonBIP44Node): Promise<BIP44Node> {\n    return BIP44Node.fromExtendedKey(json);\n  }\n\n  /**\n   * Create a new BIP-44 node from a key and chain code. You must specify\n   * either a private key or a public key. When specifying a private key,\n   * the public key will be derived from the private key.\n   *\n   * All parameters are stringently validated, and an error is thrown if\n   * validation fails.\n   *\n   * @param options - An object containing the extended key, or an extended\n   * public (xpub) or private (xprv) key.\n   * @param options.depth - The depth of the node.\n   * @param options.privateKey - The private key for the node.\n   * @param options.publicKey - The public key for the node. If a private key is\n   * specified, this parameter is ignored.\n   * @param options.chainCode - The chain code for the node.\n   */\n  static async fromExtendedKey(\n    options: BIP44ExtendedKeyOptions | string,\n  ): Promise<BIP44Node> {\n    if (typeof options === 'string') {\n      const extendedKey = decodeExtendedKey(options);\n\n      const { chainCode, depth, parentFingerprint, index } = extendedKey;\n\n      if (extendedKey.version === PRIVATE_KEY_VERSION) {\n        const { privateKey } = extendedKey;\n\n        return BIP44Node.fromExtendedKey({\n          depth,\n          parentFingerprint,\n          index,\n          privateKey,\n          chainCode,\n        });\n      }\n\n      const { publicKey } = extendedKey;\n\n      return BIP44Node.fromExtendedKey({\n        depth,\n        parentFingerprint,\n        index,\n        publicKey,\n        chainCode,\n      });\n    }\n\n    const {\n      privateKey,\n      publicKey,\n      chainCode,\n      depth,\n      parentFingerprint,\n      index,\n    } = options;\n\n    validateBIP44Depth(depth);\n\n    const node = await SLIP10Node.fromExtendedKey({\n      privateKey,\n      publicKey,\n      chainCode,\n      depth,\n      parentFingerprint,\n      index,\n      curve: 'secp256k1',\n    });\n\n    return new BIP44Node(node);\n  }\n\n  /**\n   * Create a new BIP-44 node from a derivation path. The derivation path\n   * must be rooted, i.e. it must begin with a BIP-39 node, given as a string of\n   * the form `bip39:MNEMONIC`, where `MNEMONIC` is a space-separated list of\n   * BIP-39 seed phrase words.\n   *\n   * All parameters are stringently validated, and an error is thrown if\n   * validation fails.\n   *\n   * Recall that a BIP-44 HD tree path consists of the following nodes:\n   *\n   * `m / 44' / coin_type' / account' / change / address_index`\n   *\n   * With the following depths:\n   *\n   * `0 / 1 / 2 / 3 / 4 / 5`\n   *\n   * @param options - An object containing the derivation path.\n   * @param options.derivationPath - The rooted HD tree path that will be used\n   * to derive the key of this node.\n   */\n  static async fromDerivationPath({\n    derivationPath,\n  }: BIP44DerivationPathOptions): Promise<BIP44Node> {\n    validateBIP44Depth(derivationPath.length - 1);\n    validateBIP44DerivationPath(derivationPath, MIN_BIP_44_DEPTH);\n\n    const node = await SLIP10Node.fromDerivationPath({\n      derivationPath,\n      curve: 'secp256k1',\n    });\n\n    return new BIP44Node(node);\n  }\n\n  #node: SLIP10Node;\n\n  public get depth(): BIP44Depth {\n    return this.#node.depth as BIP44Depth;\n  }\n\n  public get privateKeyBytes(): Uint8Array | undefined {\n    return this.#node.privateKeyBytes;\n  }\n\n  public get publicKeyBytes(): Uint8Array {\n    return this.#node.publicKeyBytes;\n  }\n\n  public get chainCodeBytes(): Uint8Array {\n    return this.#node.chainCodeBytes;\n  }\n\n  public get privateKey(): string | undefined {\n    return this.#node.privateKey;\n  }\n\n  public get publicKey(): string {\n    return this.#node.publicKey;\n  }\n\n  public get compressedPublicKey(): string {\n    return this.#node.compressedPublicKey;\n  }\n\n  public get compressedPublicKeyBytes(): Uint8Array {\n    return this.#node.compressedPublicKeyBytes;\n  }\n\n  public get chainCode(): string {\n    return this.#node.chainCode;\n  }\n\n  public get address(): string {\n    return this.#node.address;\n  }\n\n  public get masterFingerprint(): number | undefined {\n    return this.#node.masterFingerprint;\n  }\n\n  public get parentFingerprint(): number {\n    return this.#node.parentFingerprint;\n  }\n\n  public get fingerprint(): number {\n    return this.#node.fingerprint;\n  }\n\n  public get index(): number {\n    return this.#node.index;\n  }\n\n  public get extendedKey(): string {\n    const data = {\n      depth: this.depth,\n      parentFingerprint: this.parentFingerprint,\n      index: this.index,\n      chainCode: this.chainCodeBytes,\n    };\n\n    if (this.privateKeyBytes) {\n      return encodeExtendedKey({\n        ...data,\n        version: PRIVATE_KEY_VERSION,\n        privateKey: this.privateKeyBytes,\n      });\n    }\n\n    return encodeExtendedKey({\n      ...data,\n      version: PUBLIC_KEY_VERSION,\n      publicKey: this.publicKeyBytes,\n    });\n  }\n\n  public get curve(): SupportedCurve {\n    return this.#node.curve;\n  }\n\n  constructor(node: SLIP10Node) {\n    this.#node = node;\n\n    Object.freeze(this);\n  }\n\n  /**\n   * Get a neutered version of this node, i.e. a node without a private key.\n   *\n   * @returns A neutered version of this node.\n   */\n  public neuter(): BIP44Node {\n    const node = this.#node.neuter();\n    return new BIP44Node(node);\n  }\n\n  /**\n   * Derives a child of the key contains be this node and returns a new\n   * {@link BIP44Node} containing the child key.\n   *\n   * The specified path must be a valid HD path from this node, per BIP-44.\n   * At present, this means that the path must consist of no more than 5 BIP-32\n   * nodes, depending on the depth of this node.\n   *\n   * Recall that a BIP-44 HD tree path consists of the following nodes:\n   *\n   * `m / 44' / coin_type' / account' / change / address_index`\n   *\n   * With the following depths:\n   *\n   * `0 / 1 / 2 / 3 / 4 / 5`\n   *\n   * @param path - The partial (non-rooted) BIP-44 HD tree path will be used\n   * to derive a child key from the parent key contained within this node.\n   * @returns The {@link BIP44Node} corresponding to the derived child key.\n   */\n  public async derive(path: PartialHDPathTuple): Promise<BIP44Node> {\n    if (this.depth === MAX_BIP_44_DEPTH) {\n      throw new Error(\n        'Illegal operation: This HD tree node is already a leaf node.',\n      );\n    }\n\n    const newDepth = this.depth + path.length;\n\n    validateBIP44Depth(newDepth);\n    validateBIP44DerivationPath(path, (this.depth + 1) as BIP44Depth);\n\n    const node = await this.#node.derive(path);\n    return new BIP44Node(node);\n  }\n\n  // This is documented in the interface of this class.\n  public toJSON(): JsonBIP44Node {\n    return {\n      depth: this.depth,\n      masterFingerprint: this.masterFingerprint,\n      parentFingerprint: this.parentFingerprint,\n      index: this.index,\n      privateKey: this.privateKey,\n      publicKey: this.publicKey,\n      chainCode: this.chainCode,\n    };\n  }\n}\n\n/**\n * Validates a BIP-44 path depth. Effectively, asserts that the depth is an\n * integer `number` N such that 0 <= N <= 5. Throws an error if validation\n * fails.\n *\n * @param depth - The depth to validate.\n */\nexport function validateBIP44Depth(\n  depth: unknown,\n): asserts depth is BIP44Depth {\n  validateBIP32Depth(depth);\n\n  if (depth < MIN_BIP_44_DEPTH || depth > MAX_BIP_44_DEPTH) {\n    throw new Error(\n      `Invalid HD tree path depth: The depth must be a positive integer N such that 0 <= N <= 5. Received: \"${depth}\"`,\n    );\n  }\n}\n\n/**\n * Ensures that the given derivation is valid by BIP-44.\n *\n * Recall that a BIP-44 HD tree path consists of the following nodes:\n *\n * `m / 44' / coin_type' / account' / change / address_index`\n *\n * With the following depths:\n *\n * `0 / 1 / 2 / 3 / 4 / 5`\n *\n * @param path - The path to validate.\n * @param startingDepth - The depth of the first node of the derivation path.\n */\nfunction validateBIP44DerivationPath(\n  path: SLIP10Path,\n  startingDepth: BIP44Depth,\n) {\n  path.forEach((nodeToken, index) => {\n    const currentDepth = startingDepth + index;\n\n    if (currentDepth === MIN_BIP_44_DEPTH) {\n      if (\n        !(nodeToken instanceof Uint8Array) &&\n        !BIP_39_PATH_REGEX.test(nodeToken)\n      ) {\n        throw new Error(\n          'Invalid derivation path: The \"m\" / seed node (depth 0) must be a BIP-39 node.',\n        );\n      }\n\n      return;\n    }\n\n    assert(typeof nodeToken === 'string');\n\n    // eslint-disable-next-line default-case\n    switch (currentDepth) {\n      case 1:\n        if (nodeToken !== BIP44PurposeNodeToken) {\n          throw new Error(\n            `Invalid derivation path: The \"purpose\" node (depth 1) must be the string \"${BIP44PurposeNodeToken}\".`,\n          );\n        }\n        break;\n\n      case 2:\n        if (!BIP_32_PATH_REGEX.test(nodeToken) || !isHardened(nodeToken)) {\n          throw new Error(\n            'Invalid derivation path: The \"coin_type\" node (depth 2) must be a hardened BIP-32 node.',\n          );\n        }\n        break;\n\n      case 3:\n        if (!BIP_32_PATH_REGEX.test(nodeToken) || !isHardened(nodeToken)) {\n          throw new Error(\n            'Invalid derivation path: The \"account\" node (depth 3) must be a hardened BIP-32 node.',\n          );\n        }\n        break;\n\n      case 4:\n        if (!BIP_32_PATH_REGEX.test(nodeToken)) {\n          throw new Error(\n            'Invalid derivation path: The \"change\" node (depth 4) must be a BIP-32 node.',\n          );\n        }\n        break;\n\n      case MAX_BIP_44_DEPTH: // 5\n        if (!BIP_32_PATH_REGEX.test(nodeToken)) {\n          throw new Error(\n            'Invalid derivation path: The \"address_index\" node (depth 5) must be a BIP-32 node.',\n          );\n        }\n        break;\n    }\n  });\n}\n"],"names":["BIP44Node","validateBIP44Depth","fromJSON","json","fromExtendedKey","options","extendedKey","decodeExtendedKey","chainCode","depth","parentFingerprint","index","version","PRIVATE_KEY_VERSION","privateKey","publicKey","node","SLIP10Node","curve","fromDerivationPath","derivationPath","length","validateBIP44DerivationPath","MIN_BIP_44_DEPTH","privateKeyBytes","publicKeyBytes","chainCodeBytes","compressedPublicKey","compressedPublicKeyBytes","address","masterFingerprint","fingerprint","data","encodeExtendedKey","PUBLIC_KEY_VERSION","neuter","derive","path","MAX_BIP_44_DEPTH","Error","newDepth","toJSON","constructor","Object","freeze","validateBIP32Depth","startingDepth","forEach","nodeToken","currentDepth","Uint8Array","BIP_39_PATH_REGEX","test","assert","BIP44PurposeNodeToken","BIP_32_PATH_REGEX","isHardened"],"mappings":";;;;;;;;;;;IAyGaA,SAAS;eAATA;;IAmRGC,kBAAkB;eAAlBA;;;uBA5XO;2BAchB;8BAOA;4BACwC;wBACpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAuMzB;AArHK,MAAMD;IACX;;;;;GAKC,GACD,aAAaE,SAASC,IAAmB,EAAsB;QAC7D,OAAOH,UAAUI,eAAe,CAACD;IACnC;IAEA;;;;;;;;;;;;;;;GAeC,GACD,aAAaC,gBACXC,OAAyC,EACrB;QACpB,IAAI,OAAOA,YAAY,UAAU;YAC/B,MAAMC,cAAcC,IAAAA,+BAAiB,EAACF;YAEtC,MAAM,EAAEG,SAAS,EAAEC,KAAK,EAAEC,iBAAiB,EAAEC,KAAK,EAAE,GAAGL;YAEvD,IAAIA,YAAYM,OAAO,KAAKC,iCAAmB,EAAE;gBAC/C,MAAM,EAAEC,UAAU,EAAE,GAAGR;gBAEvB,OAAON,UAAUI,eAAe,CAAC;oBAC/BK;oBACAC;oBACAC;oBACAG;oBACAN;gBACF;YACF;YAEA,MAAM,EAAEO,SAAS,EAAE,GAAGT;YAEtB,OAAON,UAAUI,eAAe,CAAC;gBAC/BK;gBACAC;gBACAC;gBACAI;gBACAP;YACF;QACF;QAEA,MAAM,EACJM,UAAU,EACVC,SAAS,EACTP,SAAS,EACTC,KAAK,EACLC,iBAAiB,EACjBC,KAAK,EACN,GAAGN;QAEJJ,mBAAmBQ;QAEnB,MAAMO,OAAO,MAAMC,sBAAU,CAACb,eAAe,CAAC;YAC5CU;YACAC;YACAP;YACAC;YACAC;YACAC;YACAO,OAAO;QACT;QAEA,OAAO,IAAIlB,UAAUgB;IACvB;IAEA;;;;;;;;;;;;;;;;;;;;GAoBC,GACD,aAAaG,mBAAmB,EAC9BC,cAAc,EACa,EAAsB;QACjDnB,mBAAmBmB,eAAeC,MAAM,GAAG;QAC3CC,4BAA4BF,gBAAgBG,2BAAgB;QAE5D,MAAMP,OAAO,MAAMC,sBAAU,CAACE,kBAAkB,CAAC;YAC/CC;YACAF,OAAO;QACT;QAEA,OAAO,IAAIlB,UAAUgB;IACvB;IAIA,IAAWP,QAAoB;QAC7B,OAAO,yBAAA,IAAI,EAAEO,OAAKP,KAAK;IACzB;IAEA,IAAWe,kBAA0C;QACnD,OAAO,yBAAA,IAAI,EAAER,OAAKQ,eAAe;IACnC;IAEA,IAAWC,iBAA6B;QACtC,OAAO,yBAAA,IAAI,EAAET,OAAKS,cAAc;IAClC;IAEA,IAAWC,iBAA6B;QACtC,OAAO,yBAAA,IAAI,EAAEV,OAAKU,cAAc;IAClC;IAEA,IAAWZ,aAAiC;QAC1C,OAAO,yBAAA,IAAI,EAAEE,OAAKF,UAAU;IAC9B;IAEA,IAAWC,YAAoB;QAC7B,OAAO,yBAAA,IAAI,EAAEC,OAAKD,SAAS;IAC7B;IAEA,IAAWY,sBAA8B;QACvC,OAAO,yBAAA,IAAI,EAAEX,OAAKW,mBAAmB;IACvC;IAEA,IAAWC,2BAAuC;QAChD,OAAO,yBAAA,IAAI,EAAEZ,OAAKY,wBAAwB;IAC5C;IAEA,IAAWpB,YAAoB;QAC7B,OAAO,yBAAA,IAAI,EAAEQ,OAAKR,SAAS;IAC7B;IAEA,IAAWqB,UAAkB;QAC3B,OAAO,yBAAA,IAAI,EAAEb,OAAKa,OAAO;IAC3B;IAEA,IAAWC,oBAAwC;QACjD,OAAO,yBAAA,IAAI,EAAEd,OAAKc,iBAAiB;IACrC;IAEA,IAAWpB,oBAA4B;QACrC,OAAO,yBAAA,IAAI,EAAEM,OAAKN,iBAAiB;IACrC;IAEA,IAAWqB,cAAsB;QAC/B,OAAO,yBAAA,IAAI,EAAEf,OAAKe,WAAW;IAC/B;IAEA,IAAWpB,QAAgB;QACzB,OAAO,yBAAA,IAAI,EAAEK,OAAKL,KAAK;IACzB;IAEA,IAAWL,cAAsB;QAC/B,MAAM0B,OAAO;YACXvB,OAAO,IAAI,CAACA,KAAK;YACjBC,mBAAmB,IAAI,CAACA,iBAAiB;YACzCC,OAAO,IAAI,CAACA,KAAK;YACjBH,WAAW,IAAI,CAACkB,cAAc;QAChC;QAEA,IAAI,IAAI,CAACF,eAAe,EAAE;YACxB,OAAOS,IAAAA,+BAAiB,EAAC;gBACvB,GAAGD,IAAI;gBACPpB,SAASC,iCAAmB;gBAC5BC,YAAY,IAAI,CAACU,eAAe;YAClC;QACF;QAEA,OAAOS,IAAAA,+BAAiB,EAAC;YACvB,GAAGD,IAAI;YACPpB,SAASsB,gCAAkB;YAC3BnB,WAAW,IAAI,CAACU,cAAc;QAChC;IACF;IAEA,IAAWP,QAAwB;QACjC,OAAO,yBAAA,IAAI,EAAEF,OAAKE,KAAK;IACzB;IAQA;;;;GAIC,GACD,AAAOiB,SAAoB;QACzB,MAAMnB,OAAO,yBAAA,IAAI,EAAEA,OAAKmB,MAAM;QAC9B,OAAO,IAAInC,UAAUgB;IACvB;IAEA;;;;;;;;;;;;;;;;;;;GAmBC,GACD,MAAaoB,OAAOC,IAAwB,EAAsB;QAChE,IAAI,IAAI,CAAC5B,KAAK,KAAK6B,2BAAgB,EAAE;YACnC,MAAM,IAAIC,MACR;QAEJ;QAEA,MAAMC,WAAW,IAAI,CAAC/B,KAAK,GAAG4B,KAAKhB,MAAM;QAEzCpB,mBAAmBuC;QACnBlB,4BAA4Be,MAAO,IAAI,CAAC5B,KAAK,GAAG;QAEhD,MAAMO,OAAO,MAAM,yBAAA,IAAI,EAAEA,OAAKoB,MAAM,CAACC;QACrC,OAAO,IAAIrC,UAAUgB;IACvB;IAEA,qDAAqD;IAC9CyB,SAAwB;QAC7B,OAAO;YACLhC,OAAO,IAAI,CAACA,KAAK;YACjBqB,mBAAmB,IAAI,CAACA,iBAAiB;YACzCpB,mBAAmB,IAAI,CAACA,iBAAiB;YACzCC,OAAO,IAAI,CAACA,KAAK;YACjBG,YAAY,IAAI,CAACA,UAAU;YAC3BC,WAAW,IAAI,CAACA,SAAS;YACzBP,WAAW,IAAI,CAACA,SAAS;QAC3B;IACF;IA/DAkC,YAAY1B,IAAgB,CAAE;QArF9B,gCAAA;;mBAAA,KAAA;;uCAsFQA,OAAOA;QAEb2B,OAAOC,MAAM,CAAC,IAAI;IACpB;AA4DF;AASO,SAAS3C,mBACdQ,KAAc;IAEdoC,IAAAA,8BAAkB,EAACpC;IAEnB,IAAIA,QAAQc,2BAAgB,IAAId,QAAQ6B,2BAAgB,EAAE;QACxD,MAAM,IAAIC,MACR,CAAC,qGAAqG,EAAE9B,MAAM,CAAC,CAAC;IAEpH;AACF;AAEA;;;;;;;;;;;;;CAaC,GACD,SAASa,4BACPe,IAAgB,EAChBS,aAAyB;IAEzBT,KAAKU,OAAO,CAAC,CAACC,WAAWrC;QACvB,MAAMsC,eAAeH,gBAAgBnC;QAErC,IAAIsC,iBAAiB1B,2BAAgB,EAAE;YACrC,IACE,CAAEyB,CAAAA,qBAAqBE,UAAS,KAChC,CAACC,4BAAiB,CAACC,IAAI,CAACJ,YACxB;gBACA,MAAM,IAAIT,MACR;YAEJ;YAEA;QACF;QAEAc,IAAAA,aAAM,EAAC,OAAOL,cAAc;QAE5B,wCAAwC;QACxC,OAAQC;YACN,KAAK;gBACH,IAAID,cAAcM,gCAAqB,EAAE;oBACvC,MAAM,IAAIf,MACR,CAAC,0EAA0E,EAAEe,gCAAqB,CAAC,EAAE,CAAC;gBAE1G;gBACA;YAEF,KAAK;gBACH,IAAI,CAACC,4BAAiB,CAACH,IAAI,CAACJ,cAAc,CAACQ,IAAAA,kBAAU,EAACR,YAAY;oBAChE,MAAM,IAAIT,MACR;gBAEJ;gBACA;YAEF,KAAK;gBACH,IAAI,CAACgB,4BAAiB,CAACH,IAAI,CAACJ,cAAc,CAACQ,IAAAA,kBAAU,EAACR,YAAY;oBAChE,MAAM,IAAIT,MACR;gBAEJ;gBACA;YAEF,KAAK;gBACH,IAAI,CAACgB,4BAAiB,CAACH,IAAI,CAACJ,YAAY;oBACtC,MAAM,IAAIT,MACR;gBAEJ;gBACA;YAEF,KAAKD,2BAAgB;gBACnB,IAAI,CAACiB,4BAAiB,CAACH,IAAI,CAACJ,YAAY;oBACtC,MAAM,IAAIT,MACR;gBAEJ;gBACA;QACJ;IACF;AACF"}