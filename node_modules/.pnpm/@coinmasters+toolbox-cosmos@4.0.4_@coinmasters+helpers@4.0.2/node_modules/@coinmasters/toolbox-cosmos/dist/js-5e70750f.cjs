"use strict";const s=require("./index-dbb7e3c1.cjs");function G(e,r){for(var t=0;t<r.length;t++){const o=r[t];if(typeof o!="string"&&!Array.isArray(o)){for(const i in o)if(i!=="default"&&!(i in e)){const f=Object.getOwnPropertyDescriptor(o,i);f&&Object.defineProperty(e,i,f.get?f:{enumerable:!0,get:()=>o[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const a=s.requireBrowser(),N=s.dist.Buffer.alloc(1,1),I=s.dist.Buffer.alloc(1,0);function Z(e,r,t,o,i){let f=s.dist.Buffer.alloc(32,0),n=s.dist.Buffer.alloc(32,1);f=a("sha256",f).update(n).update(I).update(r).update(e).update(i||"").digest(),n=a("sha256",f).update(n).digest(),f=a("sha256",f).update(n).update(N).update(r).update(e).update(i||"").digest(),n=a("sha256",f).update(n).digest(),n=a("sha256",f).update(n).digest();let d=n;for(;!o(d)||!t(d);)f=a("sha256",f).update(n).update(I).digest(),n=a("sha256",f).update(n).digest(),n=a("sha256",f).update(n).digest(),d=n;return d}var $=Z;const k=s.bnExports$1,F=s.requireElliptic().ec,S=new F("secp256k1"),K=$,B=s.dist.Buffer.alloc(32,0),A=s.dist.Buffer.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),D=s.dist.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex"),u=S.curve.n,H=u.shrn(1),R=S.curve.g,b="Expected Private",m="Expected Point",v="Expected Tweak",j="Expected Hash",U="Expected Signature",M="Expected Extra Data (32 bytes)";function T(e){return s.dist.Buffer.isBuffer(e)&&e.length===32}function P(e){return T(e)?e.compare(A)<0:!1}function l(e){if(!s.dist.Buffer.isBuffer(e)||e.length<33)return!1;const r=e[0],t=e.slice(1,33);if(t.compare(B)===0||t.compare(D)>=0)return!1;if((r===2||r===3)&&e.length===33){try{E(e)}catch{return!1}return!0}const o=e.slice(33);return o.compare(B)===0||o.compare(D)>=0?!1:r===4&&e.length===65}function C(e){return e[0]!==4}function Q(e){return l(e)?C(e):!1}function p(e){return T(e)?e.compare(B)>0&&e.compare(A)<0:!1}function z(e){const r=e.slice(0,32),t=e.slice(32,64);return s.dist.Buffer.isBuffer(e)&&e.length===64&&r.compare(A)<0&&t.compare(A)<0}function g(e,r){return e===void 0&&r!==void 0?C(r):e===void 0?!0:e}function c(e){return new k(e)}function O(e){return e.toArrayLike(s.dist.Buffer,"be",32)}function E(e){return S.curve.decodePoint(e)}function w(e,r){return s.dist.Buffer.from(e._encode(r))}function L(e,r,t){if(!l(e))throw new TypeError(m);if(!l(r))throw new TypeError(m);const o=E(e),i=E(r),f=o.add(i);if(f.isInfinity())return null;const n=g(t,e);return w(f,n)}function V(e,r,t){if(!l(e))throw new TypeError(m);if(!P(r))throw new TypeError(v);const o=g(t,e),i=E(e);if(r.compare(B)===0)return w(i,o);const f=c(r),n=R.mul(f),d=i.add(n);return d.isInfinity()?null:w(d,o)}function X(e,r){if(!l(e))throw new TypeError(m);const t=E(e);if(t.isInfinity())throw new TypeError(m);const o=g(r,e);return w(t,o)}function J(e,r){if(!p(e))throw new TypeError(b);const t=c(e),o=R.mul(t);if(o.isInfinity())return null;const i=g(r);return w(o,i)}function Y(e,r,t){if(!l(e))throw new TypeError(m);if(!P(r))throw new TypeError(v);const o=g(t,e),i=E(e),f=c(r),n=i.mul(f);return n.isInfinity()?null:w(n,o)}function ee(e,r){if(!p(e))throw new TypeError(b);if(!P(r))throw new TypeError(v);const t=c(e),o=c(r),i=O(t.add(o).umod(u));return p(i)?i:null}function re(e,r){if(!p(e))throw new TypeError(b);if(!P(r))throw new TypeError(v);const t=c(e),o=c(r),i=O(t.sub(o).umod(u));return p(i)?i:null}function te(e,r){return W(e,r)}function ne(e,r,t){return W(e,r,t)}function W(e,r,t){if(!T(e))throw new TypeError(j);if(!p(r))throw new TypeError(b);if(t!==void 0&&!T(t))throw new TypeError(M);const o=c(r),i=c(e);let f,n;K(e,r,function(x){const _=c(x),h=R.mul(_);return!(h.isInfinity()||(f=h.x.umod(u),f.isZero()===0)||(n=_.invm(u).mul(i.add(o.mul(f))).umod(u),n.isZero()===0))},p,t),n.cmp(H)>0&&(n=u.sub(n));const y=s.dist.Buffer.allocUnsafe(64);return O(f).copy(y,0),O(n).copy(y,32),y}function fe(e,r,t,o){if(!T(e))throw new TypeError(j);if(!l(r))throw new TypeError(m);if(!z(t))throw new TypeError(U);const i=E(r),f=c(t.slice(0,32)),n=c(t.slice(32,64));if(o&&n.cmp(H)>0||f.gtn(0)<=0||n.gtn(0)<=0)return!1;const d=c(e),y=n.invm(u),x=d.mul(y).umod(u),_=f.mul(y).umod(u),h=R.mulAdd(x,i,_);return h.isInfinity()?!1:h.x.umod(u).eq(f)}var q={isPoint:l,isPointCompressed:Q,isPrivate:p,pointAdd:L,pointAddScalar:V,pointCompress:X,pointFromScalar:J,pointMultiply:Y,privateAdd:ee,privateSub:re,sign:te,signWithEntropy:ne,verify:fe};const oe=s.getDefaultExportFromCjs(q),ie=G({__proto__:null,default:oe},[q]);exports.js=ie;
