const gu=Symbol(),Os=Object.getPrototypeOf,dn=new WeakMap,yu=t=>t&&(dn.has(t)?dn.get(t):Os(t)===Object.prototype||Os(t)===Array.prototype),_u=t=>yu(t)&&t[gu]||null,xs=(t,e=!0)=>{dn.set(t,e)},Gi=t=>typeof t=="object"&&t!==null,Yt=new WeakMap,wi=new WeakSet,bu=(t=Object.is,e=(l,f)=>new Proxy(l,f),r=l=>Gi(l)&&!wi.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),i=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},n=new WeakMap,s=(l,f,_=i)=>{const y=n.get(l);if(y?.[0]===f)return y[1];const w=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return xs(w,!0),n.set(l,[f,w]),Reflect.ownKeys(l).forEach(D=>{if(Object.getOwnPropertyDescriptor(w,D))return;const C=Reflect.get(l,D),$={value:C,enumerable:!0,configurable:!0};if(wi.has(C))xs(C,!1);else if(C instanceof Promise)delete $.value,$.get=()=>_(C);else if(Yt.has(C)){const[q,E]=Yt.get(C);$.value=s(q,E(),_)}Object.defineProperty(w,D,$)}),Object.preventExtensions(w)},a=new WeakMap,c=[1,1],h=l=>{if(!Gi(l))throw new Error("object required");const f=a.get(l);if(f)return f;let _=c[0];const y=new Set,w=(R,N=++c[0])=>{_!==N&&(_=N,y.forEach(L=>L(R,N)))};let D=c[1];const C=(R=++c[1])=>(D!==R&&!y.size&&(D=R,q.forEach(([N])=>{const L=N[1](R);L>_&&(_=L)})),_),$=R=>(N,L)=>{const K=[...N];K[1]=[R,...K[1]],w(K,L)},q=new Map,E=(R,N)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&q.has(R))throw new Error("prop listener already exists");if(y.size){const L=N[3]($(R));q.set(R,[N,L])}else q.set(R,[N])},I=R=>{var N;const L=q.get(R);L&&(q.delete(R),(N=L[1])==null||N.call(L))},b=R=>(y.add(R),y.size===1&&q.forEach(([L,K],G)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&K)throw new Error("remove already exists");const S=L[3]($(G));q.set(G,[L,S])}),()=>{y.delete(R),y.size===0&&q.forEach(([L,K],G)=>{K&&(K(),q.set(G,[L]))})}),v=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),o=e(v,{deleteProperty(R,N){const L=Reflect.get(R,N);I(N);const K=Reflect.deleteProperty(R,N);return K&&w(["delete",[N],L]),K},set(R,N,L,K){const G=Reflect.has(R,N),S=Reflect.get(R,N,K);if(G&&(t(S,L)||a.has(L)&&t(S,a.get(L))))return!0;I(N),Gi(L)&&(L=_u(L)||L);let T=L;if(L instanceof Promise)L.then(W=>{L.status="fulfilled",L.value=W,w(["resolve",[N],W])}).catch(W=>{L.status="rejected",L.reason=W,w(["reject",[N],W])});else{!Yt.has(L)&&r(L)&&(T=h(L));const W=!wi.has(T)&&Yt.get(T);W&&E(N,W)}return Reflect.set(R,N,T,K),w(["set",[N],L,S]),!0}});a.set(l,o);const d=[v,C,s,b];return Yt.set(o,d),Reflect.ownKeys(l).forEach(R=>{const N=Object.getOwnPropertyDescriptor(l,R);"value"in N&&(o[R]=l[R],delete N.value,delete N.writable),Object.defineProperty(v,R,N)}),o})=>[h,Yt,wi,t,e,r,i,n,s,a,c],[wu]=bu();function Zt(t={}){return wu(t)}function gr(t,e,r){const i=Yt.get(t);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!i&&console.warn("Please use proxy object");let n;const s=[],a=i[3];let c=!1;const l=a(f=>{if(s.push(f),r){e(s.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,c&&e(s.splice(0))}))});return c=!0,()=>{c=!1,l()}}function mu(t,e){const r=Yt.get(t);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!r&&console.warn("Please use proxy object");const[i,n,s]=r;return s(i,n(),e)}const Qe=Zt({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),ca={state:Qe,subscribe(t){return gr(Qe,()=>t(Qe))},push(t,e){t!==Qe.view&&(Qe.view=t,e&&(Qe.data=e),Qe.history.push(t))},reset(t){Qe.view=t,Qe.history=[t]},replace(t){Qe.history.length>1&&(Qe.history[Qe.history.length-1]=t,Qe.view=t)},goBack(){if(Qe.history.length>1){Qe.history.pop();const[t]=Qe.history.slice(-1);Qe.view=t}},setData(t){Qe.data=t}},ut={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"?Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return ut.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const t=navigator.userAgent.toLowerCase();return ut.isMobile()&&(t.includes("iphone")||t.includes("ipad"))},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},isArray(t){return Array.isArray(t)&&t.length>0},formatNativeUrl(t,e,r){if(ut.isHttpUrl(t))return this.formatUniversalUrl(t,e,r);let i=t;i.includes("://")||(i=t.replaceAll("/","").replaceAll(":",""),i=`${i}://`),i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},formatUniversalUrl(t,e,r){if(!ut.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let i=t;i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e){window.open(t,e,"noreferrer noopener")},setWalletConnectDeepLink(t,e){try{localStorage.setItem(ut.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(t){try{const[e]=t.split("?");localStorage.setItem(ut.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(ut.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(ut.WCM_VERSION,"2.6.2")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var t;const e=(t=ca.state.data)==null?void 0:t.Wallet;if(!e)throw new Error('Missing "Wallet" view data');return e}},vu=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),st=Zt({enabled:vu,userSessionId:"",events:[],connectedWalletId:void 0}),Eu={state:st,subscribe(t){return gr(st.events,()=>t(mu(st.events[st.events.length-1])))},initialize(){st.enabled&&typeof(crypto==null?void 0:crypto.randomUUID)<"u"&&(st.userSessionId=crypto.randomUUID())},setConnectedWalletId(t){st.connectedWalletId=t},click(t){if(st.enabled){const e={type:"CLICK",name:t.name,userSessionId:st.userSessionId,timestamp:Date.now(),data:t};st.events.push(e)}},track(t){if(st.enabled){const e={type:"TRACK",name:t.name,userSessionId:st.userSessionId,timestamp:Date.now(),data:t};st.events.push(e)}},view(t){if(st.enabled){const e={type:"VIEW",name:t.name,userSessionId:st.userSessionId,timestamp:Date.now(),data:t};st.events.push(e)}}},Rt=Zt({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),Ct={state:Rt,subscribe(t){return gr(Rt,()=>t(Rt))},setChains(t){Rt.chains=t},setWalletConnectUri(t){Rt.walletConnectUri=t},setIsCustomDesktop(t){Rt.isCustomDesktop=t},setIsCustomMobile(t){Rt.isCustomMobile=t},setIsDataLoaded(t){Rt.isDataLoaded=t},setIsUiLoaded(t){Rt.isUiLoaded=t},setIsAuth(t){Rt.isAuth=t}},mi=Zt({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),xr={state:mi,subscribe(t){return gr(mi,()=>t(mi))},setConfig(t){var e,r;Eu.initialize(),Ct.setChains(t.chains),Ct.setIsAuth(Boolean(t.enableAuthMode)),Ct.setIsCustomMobile(Boolean((e=t.mobileWallets)==null?void 0:e.length)),Ct.setIsCustomDesktop(Boolean((r=t.desktopWallets)==null?void 0:r.length)),ut.setModalVersionInStorage(),Object.assign(mi,t)}};var Du=Object.defineProperty,Is=Object.getOwnPropertySymbols,Su=Object.prototype.hasOwnProperty,Ou=Object.prototype.propertyIsEnumerable,Ps=(t,e,r)=>e in t?Du(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xu=(t,e)=>{for(var r in e||(e={}))Su.call(e,r)&&Ps(t,r,e[r]);if(Is)for(var r of Is(e))Ou.call(e,r)&&Ps(t,r,e[r]);return t};const pn="https://explorer-api.walletconnect.com",gn="wcm",yn="js-2.6.2";async function vi(t,e){const r=xu({sdkType:gn,sdkVersion:yn},e),i=new URL(t,pn);return i.searchParams.append("projectId",xr.state.projectId),Object.entries(r).forEach(([n,s])=>{s&&i.searchParams.append(n,String(s))}),(await fetch(i)).json()}const or={async getDesktopListings(t){return vi("/w3m/v1/getDesktopListings",t)},async getMobileListings(t){return vi("/w3m/v1/getMobileListings",t)},async getInjectedListings(t){return vi("/w3m/v1/getInjectedListings",t)},async getAllListings(t){return vi("/w3m/v1/getAllListings",t)},getWalletImageUrl(t){return`${pn}/w3m/v1/getWalletImage/${t}?projectId=${xr.state.projectId}&sdkType=${gn}&sdkVersion=${yn}`},getAssetImageUrl(t){return`${pn}/w3m/v1/getAssetImage/${t}?projectId=${xr.state.projectId}&sdkType=${gn}&sdkVersion=${yn}`}};var Iu=Object.defineProperty,As=Object.getOwnPropertySymbols,Pu=Object.prototype.hasOwnProperty,Au=Object.prototype.propertyIsEnumerable,Ts=(t,e,r)=>e in t?Iu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tu=(t,e)=>{for(var r in e||(e={}))Pu.call(e,r)&&Ts(t,r,e[r]);if(As)for(var r of As(e))Au.call(e,r)&&Ts(t,r,e[r]);return t};const Cs=ut.isMobile(),$t=Zt({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),U1={state:$t,async getRecomendedWallets(){const{explorerRecommendedWalletIds:t,explorerExcludedWalletIds:e}=xr.state;if(t==="NONE"||e==="ALL"&&!t)return $t.recomendedWallets;if(ut.isArray(t)){const r={recommendedIds:t.join(",")},{listings:i}=await or.getAllListings(r),n=Object.values(i);n.sort((s,a)=>{const c=t.indexOf(s.id),h=t.indexOf(a.id);return c-h}),$t.recomendedWallets=n}else{const{chains:r,isAuth:i}=Ct.state,n=r?.join(","),s=ut.isArray(e),a={page:1,sdks:i?"auth_v1":void 0,entries:ut.RECOMMENDED_WALLET_AMOUNT,chains:n,version:2,excludedIds:s?e.join(","):void 0},{listings:c}=Cs?await or.getMobileListings(a):await or.getDesktopListings(a);$t.recomendedWallets=Object.values(c)}return $t.recomendedWallets},async getWallets(t){const e=Tu({},t),{explorerRecommendedWalletIds:r,explorerExcludedWalletIds:i}=xr.state,{recomendedWallets:n}=$t;if(i==="ALL")return $t.wallets;n.length?e.excludedIds=n.map(_=>_.id).join(","):ut.isArray(r)&&(e.excludedIds=r.join(",")),ut.isArray(i)&&(e.excludedIds=[e.excludedIds,i].filter(Boolean).join(",")),Ct.state.isAuth&&(e.sdks="auth_v1");const{page:s,search:a}=t,{listings:c,total:h}=Cs?await or.getMobileListings(e):await or.getDesktopListings(e),l=Object.values(c),f=a?"search":"wallets";return $t[f]={listings:[...$t[f].listings,...l],total:h,page:s??1},{listings:l,total:h}},getWalletImageUrl(t){return or.getWalletImageUrl(t)},getAssetImageUrl(t){return or.getAssetImageUrl(t)},resetSearch(){$t.search={listings:[],total:0,page:1}}},mr=Zt({open:!1}),Yi={state:mr,subscribe(t){return gr(mr,()=>t(mr))},async open(t){return new Promise(e=>{const{isUiLoaded:r,isDataLoaded:i}=Ct.state;if(ut.removeWalletConnectDeepLink(),Ct.setWalletConnectUri(t?.uri),Ct.setChains(t?.chains),ca.reset("ConnectWallet"),r&&i)mr.open=!0,e();else{const n=setInterval(()=>{const s=Ct.state;s.isUiLoaded&&s.isDataLoaded&&(clearInterval(n),mr.open=!0,e())},200)}})},close(){mr.open=!1}};var Cu=Object.defineProperty,Ns=Object.getOwnPropertySymbols,Nu=Object.prototype.hasOwnProperty,Ru=Object.prototype.propertyIsEnumerable,Rs=(t,e,r)=>e in t?Cu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$u=(t,e)=>{for(var r in e||(e={}))Nu.call(e,r)&&Rs(t,r,e[r]);if(Ns)for(var r of Ns(e))Ru.call(e,r)&&Rs(t,r,e[r]);return t};function Lu(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const $r=Zt({themeMode:Lu()?"dark":"light"}),$s={state:$r,subscribe(t){return gr($r,()=>t($r))},setThemeConfig(t){const{themeMode:e,themeVariables:r}=t;e&&($r.themeMode=e),r&&($r.themeVariables=$u({},r))}},ar=Zt({open:!1,message:"",variant:"success"}),M1={state:ar,subscribe(t){return gr(ar,()=>t(ar))},openToast(t,e){ar.open=!0,ar.message=t,ar.variant=e},closeToast(){ar.open=!1}};let Fu=class{constructor(e){this.openModal=Yi.open,this.closeModal=Yi.close,this.subscribeModal=Yi.subscribe,this.setTheme=$s.setThemeConfig,$s.setThemeConfig(e),xr.setConfig(e),this.initUi()}async initUi(){if(typeof window<"u"){await import("./index-e56e7cd5.js");const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),Ct.setIsUiLoaded(!0)}}};var Uu;function Qt(){}Qt.prototype=Object.create(null);function ae(){ae.init.call(this)}ae.EventEmitter=ae;ae.usingDomains=!1;ae.prototype.domain=void 0;ae.prototype._events=void 0;ae.prototype._maxListeners=void 0;ae.defaultMaxListeners=10;ae.init=function(){this.domain=null,ae.usingDomains&&Uu.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Qt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ae.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};function ua(t){return t._maxListeners===void 0?ae.defaultMaxListeners:t._maxListeners}ae.prototype.getMaxListeners=function(){return ua(this)};function Mu(t,e,r){if(e)t.call(r);else for(var i=t.length,n=ii(t,i),s=0;s<i;++s)n[s].call(r)}function ju(t,e,r,i){if(e)t.call(r,i);else for(var n=t.length,s=ii(t,n),a=0;a<n;++a)s[a].call(r,i)}function qu(t,e,r,i,n){if(e)t.call(r,i,n);else for(var s=t.length,a=ii(t,s),c=0;c<s;++c)a[c].call(r,i,n)}function Bu(t,e,r,i,n,s){if(e)t.call(r,i,n,s);else for(var a=t.length,c=ii(t,a),h=0;h<a;++h)c[h].call(r,i,n,s)}function zu(t,e,r,i){if(e)t.apply(r,i);else for(var n=t.length,s=ii(t,n),a=0;a<n;++a)s[a].apply(r,i)}ae.prototype.emit=function(e){var r,i,n,s,a,c,h,l=e==="error";if(c=this._events,c)l=l&&c.error==null;else if(!l)return!1;if(h=this.domain,l){if(r=arguments[1],h)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=h,r.domainThrown=!1,h.emit("error",r);else{if(r instanceof Error)throw r;var f=new Error('Uncaught, unspecified "error" event. ('+r+")");throw f.context=r,f}return!1}if(i=c[e],!i)return!1;var _=typeof i=="function";switch(n=arguments.length,n){case 1:Mu(i,_,this);break;case 2:ju(i,_,this,arguments[1]);break;case 3:qu(i,_,this,arguments[1],arguments[2]);break;case 4:Bu(i,_,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(n-1),a=1;a<n;a++)s[a-1]=arguments[a];zu(i,_,this,s)}return!0};function la(t,e,r,i){var n,s,a;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(s=t._events,s?(s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]):(s=t._events=new Qt,t._eventsCount=0),!a)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),!a.warned&&(n=ua(t),n&&n>0&&a.length>n)){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,Ku(c)}return t}function Ku(t){typeof console.warn=="function"?console.warn(t):console.log(t)}ae.prototype.addListener=function(e,r){return la(this,e,r,!1)};ae.prototype.on=ae.prototype.addListener;ae.prototype.prependListener=function(e,r){return la(this,e,r,!0)};function ha(t,e,r){var i=!1;function n(){t.removeListener(e,n),i||(i=!0,r.apply(t,arguments))}return n.listener=r,n}ae.prototype.once=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,ha(this,e,r)),this};ae.prototype.prependOnceListener=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,ha(this,e,r)),this};ae.prototype.removeListener=function(e,r){var i,n,s,a,c;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(n=this._events,!n)return this;if(i=n[e],!i)return this;if(i===r||i.listener&&i.listener===r)--this._eventsCount===0?this._events=new Qt:(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,a=i.length;a-- >0;)if(i[a]===r||i[a].listener&&i[a].listener===r){c=i[a].listener,s=a;break}if(s<0)return this;if(i.length===1){if(i[0]=void 0,--this._eventsCount===0)return this._events=new Qt,this;delete n[e]}else Hu(i,s);n.removeListener&&this.emit("removeListener",e,c||r)}return this};ae.prototype.off=function(t,e){return this.removeListener(t,e)};ae.prototype.removeAllListeners=function(e){var r,i;if(i=this._events,!i)return this;if(!i.removeListener)return arguments.length===0?(this._events=new Qt,this._eventsCount=0):i[e]&&(--this._eventsCount===0?this._events=new Qt:delete i[e]),this;if(arguments.length===0){for(var n=Object.keys(i),s=0,a;s<n.length;++s)a=n[s],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=new Qt,this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r)do this.removeListener(e,r[r.length-1]);while(r[0]);return this};ae.prototype.listeners=function(e){var r,i,n=this._events;return n?(r=n[e],r?typeof r=="function"?i=[r.listener||r]:i=Vu(r):i=[]):i=[],i};ae.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):fa.call(t,e)};ae.prototype.listenerCount=fa;function fa(t){var e=this._events;if(e){var r=e[t];if(typeof r=="function")return 1;if(r)return r.length}return 0}ae.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Hu(t,e){for(var r=e,i=r+1,n=t.length;i<n;r+=1,i+=1)t[r]=t[i];t.pop()}function ii(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}function Vu(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}var Wu=Object.freeze({__proto__:null,EventEmitter:ae,default:ae}),vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ku(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function er(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var $i={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _n=function(t,e){return _n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},_n(t,e)};function Gu(t,e){_n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var bn=function(){return bn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},bn.apply(this,arguments)};function Yu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ju(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Qu(t,e){return function(r,i){e(r,i,t)}}function Xu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Zu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(_){a(_)}}function h(f){try{l(i.throw(f))}catch(_){a(_)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function el(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function tl(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function rl(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function wn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function da(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function il(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(da(arguments[e]));return t}function nl(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Yr(t){return this instanceof Yr?(this.v=t,this):new Yr(t)}function sl(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(w){return new Promise(function(D,C){s.push([y,w,D,C])>1||c(y,w)})})}function c(y,w){try{h(i[y](w))}catch(D){_(s[0][3],D)}}function h(y){y.value instanceof Yr?Promise.resolve(y.value.v).then(l,f):_(s[0][2],y)}function l(y){c("next",y)}function f(y){c("throw",y)}function _(y,w){y(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ol(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Yr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function al(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof wn=="function"?wn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function cl(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ul(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ll(t){return t&&t.__esModule?t:{default:t}}function hl(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function fl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var dl=Object.freeze({__proto__:null,get __assign(){return bn},__asyncDelegator:ol,__asyncGenerator:sl,__asyncValues:al,__await:Yr,__awaiter:Zu,__classPrivateFieldGet:hl,__classPrivateFieldSet:fl,__createBinding:tl,__decorate:Ju,__exportStar:rl,__extends:Gu,__generator:el,__importDefault:ll,__importStar:ul,__makeTemplateObject:cl,__metadata:Xu,__param:Qu,__read:da,__rest:Yu,__spread:il,__spreadArrays:nl,__values:wn}),pa=er(dl),ni={};Object.defineProperty(ni,"__esModule",{value:!0});function pl(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}ni.safeJsonParse=pl;function gl(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}ni.safeJsonStringify=gl;var Lr={exports:{}},Ls;function yl(){return Ls||(Ls=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof vt<"u"&&vt.localStorage?Lr.exports=vt.localStorage:typeof window<"u"&&window.localStorage?Lr.exports=window.localStorage:Lr.exports=new e}()),Lr.exports}var Ji={},Fr={},Fs;function _l(){if(Fs)return Fr;Fs=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.IKeyValueStorage=void 0;class t{}return Fr.IKeyValueStorage=t,Fr}var Ur={},Us;function bl(){if(Us)return Ur;Us=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.parseEntry=void 0;const t=ni;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return Ur.parseEntry=e,Ur}var Ms;function wl(){return Ms||(Ms=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=pa;e.__exportStar(_l(),t),e.__exportStar(bl(),t)}(Ji)),Ji}Object.defineProperty($i,"__esModule",{value:!0});$i.KeyValueStorage=void 0;const Er=pa,js=ni,ml=Er.__importDefault(yl()),vl=wl();class ga{constructor(){this.localStorage=ml.default}getKeys(){return Er.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Er.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(vl.parseEntry)})}getItem(e){return Er.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return js.safeJsonParse(r)})}setItem(e,r){return Er.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,js.safeJsonStringify(r))})}removeItem(e){return Er.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}$i.KeyValueStorage=ga;var El=$i.default=ga,Ir={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mn=function(t,e){return mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},mn(t,e)};function Dl(t,e){mn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var vn=function(){return vn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},vn.apply(this,arguments)};function Sl(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ol(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function xl(t,e){return function(r,i){e(r,i,t)}}function Il(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Pl(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(_){a(_)}}function h(f){try{l(i.throw(f))}catch(_){a(_)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Al(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Tl(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Cl(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function En(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ya(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Nl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ya(arguments[e]));return t}function Rl(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Jr(t){return this instanceof Jr?(this.v=t,this):new Jr(t)}function $l(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(w){return new Promise(function(D,C){s.push([y,w,D,C])>1||c(y,w)})})}function c(y,w){try{h(i[y](w))}catch(D){_(s[0][3],D)}}function h(y){y.value instanceof Jr?Promise.resolve(y.value.v).then(l,f):_(s[0][2],y)}function l(y){c("next",y)}function f(y){c("throw",y)}function _(y,w){y(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ll(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Jr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Fl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof En=="function"?En(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Ul(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ml(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function jl(t){return t&&t.__esModule?t:{default:t}}function ql(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Bl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var zl=Object.freeze({__proto__:null,get __assign(){return vn},__asyncDelegator:Ll,__asyncGenerator:$l,__asyncValues:Fl,__await:Jr,__awaiter:Pl,__classPrivateFieldGet:ql,__classPrivateFieldSet:Bl,__createBinding:Tl,__decorate:Ol,__exportStar:Cl,__extends:Dl,__generator:Al,__importDefault:jl,__importStar:Ml,__makeTemplateObject:Ul,__metadata:Il,__param:xl,__read:ya,__rest:Sl,__spread:Nl,__spreadArrays:Rl,__values:En}),Li=er(zl),Mr={},Kl=er(Wu),X={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dn=function(t,e){return Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Dn(t,e)};function Hl(t,e){Dn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Sn=function(){return Sn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sn.apply(this,arguments)};function Vl(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Wl(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function kl(t,e){return function(r,i){e(r,i,t)}}function Gl(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Yl(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(_){a(_)}}function h(f){try{l(i.throw(f))}catch(_){a(_)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Jl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ql(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Xl(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function On(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _a(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Zl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_a(arguments[e]));return t}function eh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Qr(t){return this instanceof Qr?(this.v=t,this):new Qr(t)}function th(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(w){return new Promise(function(D,C){s.push([y,w,D,C])>1||c(y,w)})})}function c(y,w){try{h(i[y](w))}catch(D){_(s[0][3],D)}}function h(y){y.value instanceof Qr?Promise.resolve(y.value.v).then(l,f):_(s[0][2],y)}function l(y){c("next",y)}function f(y){c("throw",y)}function _(y,w){y(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function rh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Qr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function ih(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof On=="function"?On(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function nh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function sh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function oh(t){return t&&t.__esModule?t:{default:t}}function ah(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ch(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var uh=Object.freeze({__proto__:null,get __assign(){return Sn},__asyncDelegator:rh,__asyncGenerator:th,__asyncValues:ih,__await:Qr,__awaiter:Yl,__classPrivateFieldGet:ah,__classPrivateFieldSet:ch,__createBinding:Ql,__decorate:Wl,__exportStar:Xl,__extends:Hl,__generator:Jl,__importDefault:oh,__importStar:sh,__makeTemplateObject:nh,__metadata:Gl,__param:kl,__read:_a,__rest:Vl,__spread:Zl,__spreadArrays:eh,__values:On}),Fi=er(uh),Qi={},jr={},qs;function lh(){if(qs)return jr;qs=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return jr.delay=t,jr}var cr={},Xi={},ur={},Bs;function hh(){return Bs||(Bs=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.ONE_THOUSAND=ur.ONE_HUNDRED=void 0,ur.ONE_HUNDRED=100,ur.ONE_THOUSAND=1e3),ur}var Zi={},zs;function fh(){return zs||(zs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Zi)),Zi}var Ks;function ba(){return Ks||(Ks=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Fi;e.__exportStar(hh(),t),e.__exportStar(fh(),t)}(Xi)),Xi}var Hs;function dh(){if(Hs)return cr;Hs=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.fromMiliseconds=cr.toMiliseconds=void 0;const t=ba();function e(i){return i*t.ONE_THOUSAND}cr.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return cr.fromMiliseconds=r,cr}var Vs;function ph(){return Vs||(Vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Fi;e.__exportStar(lh(),t),e.__exportStar(dh(),t)}(Qi)),Qi}var vr={},Ws;function gh(){if(Ws)return vr;Ws=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return vr.Watch=t,vr.default=t,vr}var en={},qr={},ks;function yh(){if(ks)return qr;ks=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.IWatch=void 0;class t{}return qr.IWatch=t,qr}var Gs;function _h(){return Gs||(Gs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Fi.__exportStar(yh(),t)}(en)),en}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Fi;e.__exportStar(ph(),t),e.__exportStar(gh(),t),e.__exportStar(_h(),t),e.__exportStar(ba(),t)})(X);var tn={},Br={};let yr=class{};var bh=Object.freeze({__proto__:null,IEvents:yr}),wh=er(bh),Ys;function mh(){if(Ys)return Br;Ys=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.IHeartBeat=void 0;const t=wh;class e extends t.IEvents{constructor(i){super()}}return Br.IHeartBeat=e,Br}var Js;function wa(){return Js||(Js=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Li.__exportStar(mh(),t)}(tn)),tn}var rn={},lr={},Qs;function vh(){if(Qs)return lr;Qs=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.HEARTBEAT_EVENTS=lr.HEARTBEAT_INTERVAL=void 0;const t=X;return lr.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,lr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},lr}var Xs;function ma(){return Xs||(Xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Li.__exportStar(vh(),t)}(rn)),rn}var Zs;function Eh(){if(Zs)return Mr;Zs=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.HeartBeat=void 0;const t=Li,e=Kl,r=X,i=wa(),n=ma();class s extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=c?.interval||n.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Mr.HeartBeat=s,Mr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Li;e.__exportStar(Eh(),t),e.__exportStar(wa(),t),e.__exportStar(ma(),t)})(Ir);var me={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xn=function(t,e){return xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},xn(t,e)};function Dh(t,e){xn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var In=function(){return In=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},In.apply(this,arguments)};function Sh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Oh(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function xh(t,e){return function(r,i){e(r,i,t)}}function Ih(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ph(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(_){a(_)}}function h(f){try{l(i.throw(f))}catch(_){a(_)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Ah(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Th(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Ch(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Pn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function va(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Nh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(va(arguments[e]));return t}function Rh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Xr(t){return this instanceof Xr?(this.v=t,this):new Xr(t)}function $h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(w){return new Promise(function(D,C){s.push([y,w,D,C])>1||c(y,w)})})}function c(y,w){try{h(i[y](w))}catch(D){_(s[0][3],D)}}function h(y){y.value instanceof Xr?Promise.resolve(y.value.v).then(l,f):_(s[0][2],y)}function l(y){c("next",y)}function f(y){c("throw",y)}function _(y,w){y(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Lh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Xr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Fh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Pn=="function"?Pn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Uh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Mh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function jh(t){return t&&t.__esModule?t:{default:t}}function qh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Bh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var zh=Object.freeze({__proto__:null,get __assign(){return In},__asyncDelegator:Lh,__asyncGenerator:$h,__asyncValues:Fh,__await:Xr,__awaiter:Ph,__classPrivateFieldGet:qh,__classPrivateFieldSet:Bh,__createBinding:Th,__decorate:Oh,__exportStar:Ch,__extends:Dh,__generator:Ah,__importDefault:jh,__importStar:Mh,__makeTemplateObject:Uh,__metadata:Ih,__param:xh,__read:va,__rest:Sh,__spread:Nh,__spreadArrays:Rh,__values:Pn}),Kh=er(zh),nn,eo;function Hh(){if(eo)return nn;eo=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}nn=e;function e(r,i,n){var s=n&&n.stringify||t,a=1;if(typeof r=="object"&&r!==null){var c=i.length+a;if(c===1)return r;var h=new Array(c);h[0]=s(r);for(var l=1;l<c;l++)h[l]=s(i[l]);return h.join(" ")}if(typeof r!="string")return r;var f=i.length;if(f===0)return r;for(var _="",y=1-a,w=-1,D=r&&r.length||0,C=0;C<D;){if(r.charCodeAt(C)===37&&C+1<D){switch(w=w>-1?w:0,r.charCodeAt(C+1)){case 100:case 102:if(y>=f||i[y]==null)break;w<C&&(_+=r.slice(w,C)),_+=Number(i[y]),w=C+2,C++;break;case 105:if(y>=f||i[y]==null)break;w<C&&(_+=r.slice(w,C)),_+=Math.floor(Number(i[y])),w=C+2,C++;break;case 79:case 111:case 106:if(y>=f||i[y]===void 0)break;w<C&&(_+=r.slice(w,C));var $=typeof i[y];if($==="string"){_+="'"+i[y]+"'",w=C+2,C++;break}if($==="function"){_+=i[y].name||"<anonymous>",w=C+2,C++;break}_+=s(i[y]),w=C+2,C++;break;case 115:if(y>=f)break;w<C&&(_+=r.slice(w,C)),_+=String(i[y]),w=C+2,C++;break;case 37:w<C&&(_+=r.slice(w,C)),_+="%",w=C+2,C++,y--;break}++y}++C}return w===-1?r:(w<D&&(_+=r.slice(w)),_)}return nn}var sn,to;function Vh(){if(to)return sn;to=1;const t=Hh();sn=n;const e=v().console||{},r={mapHttpRequest:D,mapHttpResponse:D,wrapRequestSerializer:C,wrapResponseSerializer:C,wrapErrorSerializer:C,req:D,res:D,err:y};function i(p,o){return Array.isArray(p)?p.filter(function(R){return R!=="!stdSerializers.err"}):p===!0?Object.keys(o):!1}function n(p){p=p||{},p.browser=p.browser||{};const o=p.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const d=p.browser.write||e;p.browser.write&&(p.browser.asObject=!0);const R=p.serializers||{},N=i(p.browser.serialize,R);let L=p.browser.serialize;Array.isArray(p.browser.serialize)&&p.browser.serialize.indexOf("!stdSerializers.err")>-1&&(L=!1);const K=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),p.enabled===!1&&(p.level="silent");const G=p.level||"info",S=Object.create(d);S.log||(S.log=$),Object.defineProperty(S,"levelVal",{get:W}),Object.defineProperty(S,"level",{get:B,set:U});const T={transmit:o,serialize:N,asObject:p.browser.asObject,levels:K,timestamp:w(p)};S.levels=n.levels,S.level=G,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=$,S.serializers=R,S._serialize=N,S._stdErrSerialize=L,S.child=j,o&&(S._logEvent=_());function W(){return this.level==="silent"?1/0:this.levels.values[this.level]}function B(){return this._level}function U(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,s(T,S,"error","log"),s(T,S,"fatal","error"),s(T,S,"warn","error"),s(T,S,"info","log"),s(T,S,"debug","log"),s(T,S,"trace","log")}function j(F,z){if(!F)throw new Error("missing bindings for child Pino");z=z||{},N&&F.serializers&&(z.serializers=F.serializers);const te=z.serializers;if(N&&te){var H=Object.assign({},R,te),Z=p.browser.serialize===!0?Object.keys(H):N;delete F.serializers,h([F],Z,H,this._stdErrSerialize)}function J(ee){this._childLevel=(ee._childLevel|0)+1,this.error=l(ee,F,"error"),this.fatal=l(ee,F,"fatal"),this.warn=l(ee,F,"warn"),this.info=l(ee,F,"info"),this.debug=l(ee,F,"debug"),this.trace=l(ee,F,"trace"),H&&(this.serializers=H,this._serialize=Z),o&&(this._logEvent=_([].concat(ee._logEvent.bindings,F)))}return J.prototype=this,new J(this)}return S}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:q,epochTime:E,unixTime:I,isoTime:b});function s(p,o,d,R){const N=Object.getPrototypeOf(o);o[d]=o.levelVal>o.levels.values[d]?$:N[d]?N[d]:e[d]||e[R]||$,a(p,o,d)}function a(p,o,d){!p.transmit&&o[d]===$||(o[d]=function(R){return function(){const L=p.timestamp(),K=new Array(arguments.length),G=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var S=0;S<K.length;S++)K[S]=arguments[S];if(p.serialize&&!p.asObject&&h(K,this._serialize,this.serializers,this._stdErrSerialize),p.asObject?R.call(G,c(this,d,K,L)):R.apply(G,K),p.transmit){const T=p.transmit.level||o.level,W=n.levels.values[T],B=n.levels.values[d];if(B<W)return;f(this,{ts:L,methodLevel:d,methodValue:B,transmitLevel:T,transmitValue:n.levels.values[p.transmit.level||o.level],send:p.transmit.send,val:o.levelVal},K)}}}(o[d]))}function c(p,o,d,R){p._serialize&&h(d,p._serialize,p.serializers,p._stdErrSerialize);const N=d.slice();let L=N[0];const K={};R&&(K.time=R),K.level=n.levels.values[o];let G=(p._childLevel|0)+1;if(G<1&&(G=1),L!==null&&typeof L=="object"){for(;G--&&typeof N[0]=="object";)Object.assign(K,N.shift());L=N.length?t(N.shift(),N):void 0}else typeof L=="string"&&(L=t(N.shift(),N));return L!==void 0&&(K.msg=L),K}function h(p,o,d,R){for(const N in p)if(R&&p[N]instanceof Error)p[N]=n.stdSerializers.err(p[N]);else if(typeof p[N]=="object"&&!Array.isArray(p[N]))for(const L in p[N])o&&o.indexOf(L)>-1&&L in d&&(p[N][L]=d[L](p[N][L]))}function l(p,o,d){return function(){const R=new Array(1+arguments.length);R[0]=o;for(var N=1;N<R.length;N++)R[N]=arguments[N-1];return p[d].apply(this,R)}}function f(p,o,d){const R=o.send,N=o.ts,L=o.methodLevel,K=o.methodValue,G=o.val,S=p._logEvent.bindings;h(d,p._serialize||Object.keys(p.serializers),p.serializers,p._stdErrSerialize===void 0?!0:p._stdErrSerialize),p._logEvent.ts=N,p._logEvent.messages=d.filter(function(T){return S.indexOf(T)===-1}),p._logEvent.level.label=L,p._logEvent.level.value=K,R(L,p._logEvent,G),p._logEvent=_(S)}function _(p){return{ts:0,messages:[],bindings:p||[],level:{label:"",value:0}}}function y(p){const o={type:p.constructor.name,msg:p.message,stack:p.stack};for(const d in p)o[d]===void 0&&(o[d]=p[d]);return o}function w(p){return typeof p.timestamp=="function"?p.timestamp:p.timestamp===!1?q:E}function D(){return{}}function C(p){return p}function $(){}function q(){return!1}function E(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function b(){return new Date(Date.now()).toISOString()}function v(){function p(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return p(self)||p(window)||p(this)||{}}}return sn}var hr={},ro;function Ea(){return ro||(ro=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.PINO_CUSTOM_CONTEXT_KEY=hr.PINO_LOGGER_DEFAULTS=void 0,hr.PINO_LOGGER_DEFAULTS={level:"info"},hr.PINO_CUSTOM_CONTEXT_KEY="custom_context"),hr}var ht={},io;function Wh(){if(io)return ht;io=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.generateChildLogger=ht.formatChildLoggerContext=ht.getLoggerContext=ht.setBrowserLoggerContext=ht.getBrowserLoggerContext=ht.getDefaultLoggerOptions=void 0;const t=Ea();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ht.getDefaultLoggerOptions=e;function r(c,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}ht.getBrowserLoggerContext=r;function i(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]=h,c}ht.setBrowserLoggerContext=i;function n(c,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return typeof c.bindings>"u"?l=r(c,h):l=c.bindings().context||"",l}ht.getLoggerContext=n;function s(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=n(c,l);return f.trim()?`${f}/${h}`:h}ht.formatChildLoggerContext=s;function a(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(c,h,l),_=c.child({context:f});return i(_,f,l)}return ht.generateChildLogger=a,ht}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Kh,r=e.__importDefault(Vh());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Ea(),t),e.__exportStar(Wh(),t)})(me);class kh extends yr{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let Gh=class extends yr{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}},Yh=class{constructor(e,r){this.logger=e,this.core=r}};class Jh extends yr{constructor(e,r){super(),this.relayer=e,this.logger=r}}let Qh=class extends yr{constructor(e){super()}},Xh=class{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}},Zh=class extends yr{constructor(e,r){super(),this.relayer=e,this.logger=r}},ef=class extends yr{constructor(e,r){super(),this.core=e,this.logger=r}};class tf{constructor(e,r){this.projectId=e,this.logger=r}}let rf=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},nf=class{constructor(e){this.client=e}};const sf=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),of=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Da(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return of(t)}catch{return t}}function kn(t){return typeof t=="string"?t:sf(t)||""}var Gn={},Pr={},Ui={},Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});Mi.BrowserRandomSource=void 0;const no=65536;class af{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=no)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,no)));return r}}Mi.BrowserRandomSource=af;function cf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ji={},Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});function uf(t){for(var e=0;e<t.length;e++)t[e]=0;return t}Dt.wipe=uf;var lf={},hf=Object.freeze({__proto__:null,default:lf}),ff=er(hf);Object.defineProperty(ji,"__esModule",{value:!0});ji.NodeRandomSource=void 0;const df=Dt;class pf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof cf<"u"){const e=ff;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,df.wipe)(r),i}}ji.NodeRandomSource=pf;Object.defineProperty(Ui,"__esModule",{value:!0});Ui.SystemRandomSource=void 0;const gf=Mi,yf=ji;class _f{constructor(){if(this.isAvailable=!1,this.name="",this._source=new gf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new yf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Ui.SystemRandomSource=_f;var ne={},Sa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,h){var l=c>>>16&65535,f=c&65535,_=h>>>16&65535,y=h&65535;return f*y+(l*y+f*_<<16>>>0)|0}t.mul=Math.imul||e;function r(c,h){return c+h|0}t.add=r;function i(c,h){return c-h|0}t.sub=i;function n(c,h){return c<<h|c>>>32-h}t.rotl=n;function s(c,h){return c<<32-h|c>>>h}t.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Sa);Object.defineProperty(ne,"__esModule",{value:!0});var Oa=Sa;function bf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ne.readInt16BE=bf;function wf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ne.readUint16BE=wf;function mf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ne.readInt16LE=mf;function vf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ne.readUint16LE=vf;function xa(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ne.writeUint16BE=xa;ne.writeInt16BE=xa;function Ia(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ne.writeUint16LE=Ia;ne.writeInt16LE=Ia;function An(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ne.readInt32BE=An;function Tn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ne.readUint32BE=Tn;function Cn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ne.readInt32LE=Cn;function Nn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ne.readUint32LE=Nn;function Ii(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ne.writeUint32BE=Ii;ne.writeInt32BE=Ii;function Pi(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ne.writeUint32LE=Pi;ne.writeInt32LE=Pi;function Ef(t,e){e===void 0&&(e=0);var r=An(t,e),i=An(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ne.readInt64BE=Ef;function Df(t,e){e===void 0&&(e=0);var r=Tn(t,e),i=Tn(t,e+4);return r*4294967296+i}ne.readUint64BE=Df;function Sf(t,e){e===void 0&&(e=0);var r=Cn(t,e),i=Cn(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ne.readInt64LE=Sf;function Of(t,e){e===void 0&&(e=0);var r=Nn(t,e),i=Nn(t,e+4);return i*4294967296+r}ne.readUint64LE=Of;function Pa(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ii(t/4294967296>>>0,e,r),Ii(t>>>0,e,r+4),e}ne.writeUint64BE=Pa;ne.writeInt64BE=Pa;function Aa(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Pi(t>>>0,e,r),Pi(t/4294967296>>>0,e,r+4),e}ne.writeUint64LE=Aa;ne.writeInt64LE=Aa;function xf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ne.readUintBE=xf;function If(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ne.readUintLE=If;function Pf(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Oa.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ne.writeUintBE=Pf;function Af(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Oa.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ne.writeUintLE=Af;function Tf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ne.readFloat32BE=Tf;function Cf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ne.readFloat32LE=Cf;function Nf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ne.readFloat64BE=Nf;function Rf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ne.readFloat64LE=Rf;function $f(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ne.writeFloat32BE=$f;function Lf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ne.writeFloat32LE=Lf;function Ff(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ne.writeFloat64BE=Ff;function Uf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ne.writeFloat64LE=Uf;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Ui,r=ne,i=Dt;t.defaultRandomSource=new e.SystemRandomSource;function n(l,f=t.defaultRandomSource){return f.randomBytes(l)}t.randomBytes=n;function s(l=t.defaultRandomSource){const f=n(4,l),_=(0,r.readUint32LE)(f);return(0,i.wipe)(f),_}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(l,f=a,_=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let y="";const w=f.length,D=256-256%w;for(;l>0;){const C=n(Math.ceil(l*256/D),_);for(let $=0;$<C.length&&l>0;$++){const q=C[$];q<D&&(y+=f.charAt(q%w),l--)}(0,i.wipe)(C)}return y}t.randomString=c;function h(l,f=a,_=t.defaultRandomSource){const y=Math.ceil(l/(Math.log(f.length)/Math.LN2));return c(y,f,_)}t.randomStringForEntropy=h})(Pr);var Ta={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=Dt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,_=l/536870912|0,y=l<<3,w=l%128<112?128:256;this._buffer[f]=128;for(var D=f+1;D<w-8;D++)this._buffer[D]=0;e.writeUint32BE(_,this._buffer,w-8),e.writeUint32BE(y,this._buffer,w-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,w),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)e.writeUint32BE(this._stateHi[D],h,D*8),e.writeUint32BE(this._stateLo[D],h,D*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,l,f,_,y,w){for(var D=l[0],C=l[1],$=l[2],q=l[3],E=l[4],I=l[5],b=l[6],v=l[7],p=f[0],o=f[1],d=f[2],R=f[3],N=f[4],L=f[5],K=f[6],G=f[7],S,T,W,B,U,j,F,z;w>=128;){for(var te=0;te<16;te++){var H=8*te+y;c[te]=e.readUint32BE(_,H),h[te]=e.readUint32BE(_,H+4)}for(var te=0;te<80;te++){var Z=D,J=C,ee=$,A=q,P=E,O=I,u=b,m=v,V=p,Y=o,fe=d,be=R,pe=N,Ee=L,Le=K,Ce=G;if(S=v,T=G,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=(E>>>14|N<<32-14)^(E>>>18|N<<32-18)^(N>>>41-32|E<<32-(41-32)),T=(N>>>14|E<<32-14)^(N>>>18|E<<32-18)^(E>>>41-32|N<<32-(41-32)),U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,S=E&I^~E&b,T=N&L^~N&K,U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,S=n[te*2],T=n[te*2+1],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,S=c[te%16],T=h[te%16],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,W=F&65535|z<<16,B=U&65535|j<<16,S=W,T=B,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=(D>>>28|p<<32-28)^(p>>>34-32|D<<32-(34-32))^(p>>>39-32|D<<32-(39-32)),T=(p>>>28|D<<32-28)^(D>>>34-32|p<<32-(34-32))^(D>>>39-32|p<<32-(39-32)),U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,S=D&C^D&$^C&$,T=p&o^p&d^o&d,U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,m=F&65535|z<<16,Ce=U&65535|j<<16,S=A,T=be,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=W,T=B,U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,A=F&65535|z<<16,be=U&65535|j<<16,C=Z,$=J,q=ee,E=A,I=P,b=O,v=u,D=m,o=V,d=Y,R=fe,N=be,L=pe,K=Ee,G=Le,p=Ce,te%16===15)for(var H=0;H<16;H++)S=c[H],T=h[H],U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=c[(H+9)%16],T=h[(H+9)%16],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,W=c[(H+1)%16],B=h[(H+1)%16],S=(W>>>1|B<<32-1)^(W>>>8|B<<32-8)^W>>>7,T=(B>>>1|W<<32-1)^(B>>>8|W<<32-8)^(B>>>7|W<<32-7),U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,W=c[(H+14)%16],B=h[(H+14)%16],S=(W>>>19|B<<32-19)^(B>>>61-32|W<<32-(61-32))^W>>>6,T=(B>>>19|W<<32-19)^(W>>>61-32|B<<32-(61-32))^(B>>>6|W<<32-6),U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,c[H]=F&65535|z<<16,h[H]=U&65535|j<<16}S=D,T=p,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[0],T=f[0],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[0]=D=F&65535|z<<16,f[0]=p=U&65535|j<<16,S=C,T=o,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[1],T=f[1],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[1]=C=F&65535|z<<16,f[1]=o=U&65535|j<<16,S=$,T=d,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[2],T=f[2],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[2]=$=F&65535|z<<16,f[2]=d=U&65535|j<<16,S=q,T=R,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[3],T=f[3],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[3]=q=F&65535|z<<16,f[3]=R=U&65535|j<<16,S=E,T=N,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[4],T=f[4],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[4]=E=F&65535|z<<16,f[4]=N=U&65535|j<<16,S=I,T=L,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[5],T=f[5],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[5]=I=F&65535|z<<16,f[5]=L=U&65535|j<<16,S=b,T=K,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[6],T=f[6],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[6]=b=F&65535|z<<16,f[6]=K=U&65535|j<<16,S=v,T=G,U=T&65535,j=T>>>16,F=S&65535,z=S>>>16,S=l[7],T=f[7],U+=T&65535,j+=T>>>16,F+=S&65535,z+=S>>>16,j+=U>>>16,F+=j>>>16,z+=F>>>16,l[7]=v=F&65535|z<<16,f[7]=G=U&65535|j<<16,y+=128,w-=128}return y}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(Ta);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=Pr,r=Ta,i=Dt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(A){const P=new Float64Array(16);if(A)for(let O=0;O<A.length;O++)P[O]=A[O];return P}const s=new Uint8Array(32);s[0]=9;const a=n(),c=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(A,P){for(let O=0;O<16;O++)A[O]=P[O]|0}function D(A){let P=1;for(let O=0;O<16;O++){let u=A[O]+P+65535;P=Math.floor(u/65536),A[O]=u-P*65536}A[0]+=P-1+37*(P-1)}function C(A,P,O){const u=~(O-1);for(let m=0;m<16;m++){const V=u&(A[m]^P[m]);A[m]^=V,P[m]^=V}}function $(A,P){const O=n(),u=n();for(let m=0;m<16;m++)u[m]=P[m];D(u),D(u),D(u);for(let m=0;m<2;m++){O[0]=u[0]-65517;for(let Y=1;Y<15;Y++)O[Y]=u[Y]-65535-(O[Y-1]>>16&1),O[Y-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const V=O[15]>>16&1;O[14]&=65535,C(u,O,1-V)}for(let m=0;m<16;m++)A[2*m]=u[m]&255,A[2*m+1]=u[m]>>8}function q(A,P){let O=0;for(let u=0;u<32;u++)O|=A[u]^P[u];return(1&O-1>>>8)-1}function E(A,P){const O=new Uint8Array(32),u=new Uint8Array(32);return $(O,A),$(u,P),q(O,u)}function I(A){const P=new Uint8Array(32);return $(P,A),P[0]&1}function b(A,P){for(let O=0;O<16;O++)A[O]=P[2*O]+(P[2*O+1]<<8);A[15]&=32767}function v(A,P,O){for(let u=0;u<16;u++)A[u]=P[u]+O[u]}function p(A,P,O){for(let u=0;u<16;u++)A[u]=P[u]-O[u]}function o(A,P,O){let u,m,V=0,Y=0,fe=0,be=0,pe=0,Ee=0,Le=0,Ce=0,_e=0,ge=0,de=0,le=0,ue=0,ce=0,oe=0,re=0,he=0,ye=0,ie=0,we=0,ve=0,Se=0,Oe=0,De=0,It=0,Nt=0,Vt=0,wt=0,rr=0,Cr=0,fi=0,Fe=O[0],Ne=O[1],Ue=O[2],Me=O[3],je=O[4],Re=O[5],Ke=O[6],He=O[7],Ve=O[8],We=O[9],ke=O[10],ze=O[11],qe=O[12],Pe=O[13],Ge=O[14],Ye=O[15];u=P[0],V+=u*Fe,Y+=u*Ne,fe+=u*Ue,be+=u*Me,pe+=u*je,Ee+=u*Re,Le+=u*Ke,Ce+=u*He,_e+=u*Ve,ge+=u*We,de+=u*ke,le+=u*ze,ue+=u*qe,ce+=u*Pe,oe+=u*Ge,re+=u*Ye,u=P[1],Y+=u*Fe,fe+=u*Ne,be+=u*Ue,pe+=u*Me,Ee+=u*je,Le+=u*Re,Ce+=u*Ke,_e+=u*He,ge+=u*Ve,de+=u*We,le+=u*ke,ue+=u*ze,ce+=u*qe,oe+=u*Pe,re+=u*Ge,he+=u*Ye,u=P[2],fe+=u*Fe,be+=u*Ne,pe+=u*Ue,Ee+=u*Me,Le+=u*je,Ce+=u*Re,_e+=u*Ke,ge+=u*He,de+=u*Ve,le+=u*We,ue+=u*ke,ce+=u*ze,oe+=u*qe,re+=u*Pe,he+=u*Ge,ye+=u*Ye,u=P[3],be+=u*Fe,pe+=u*Ne,Ee+=u*Ue,Le+=u*Me,Ce+=u*je,_e+=u*Re,ge+=u*Ke,de+=u*He,le+=u*Ve,ue+=u*We,ce+=u*ke,oe+=u*ze,re+=u*qe,he+=u*Pe,ye+=u*Ge,ie+=u*Ye,u=P[4],pe+=u*Fe,Ee+=u*Ne,Le+=u*Ue,Ce+=u*Me,_e+=u*je,ge+=u*Re,de+=u*Ke,le+=u*He,ue+=u*Ve,ce+=u*We,oe+=u*ke,re+=u*ze,he+=u*qe,ye+=u*Pe,ie+=u*Ge,we+=u*Ye,u=P[5],Ee+=u*Fe,Le+=u*Ne,Ce+=u*Ue,_e+=u*Me,ge+=u*je,de+=u*Re,le+=u*Ke,ue+=u*He,ce+=u*Ve,oe+=u*We,re+=u*ke,he+=u*ze,ye+=u*qe,ie+=u*Pe,we+=u*Ge,ve+=u*Ye,u=P[6],Le+=u*Fe,Ce+=u*Ne,_e+=u*Ue,ge+=u*Me,de+=u*je,le+=u*Re,ue+=u*Ke,ce+=u*He,oe+=u*Ve,re+=u*We,he+=u*ke,ye+=u*ze,ie+=u*qe,we+=u*Pe,ve+=u*Ge,Se+=u*Ye,u=P[7],Ce+=u*Fe,_e+=u*Ne,ge+=u*Ue,de+=u*Me,le+=u*je,ue+=u*Re,ce+=u*Ke,oe+=u*He,re+=u*Ve,he+=u*We,ye+=u*ke,ie+=u*ze,we+=u*qe,ve+=u*Pe,Se+=u*Ge,Oe+=u*Ye,u=P[8],_e+=u*Fe,ge+=u*Ne,de+=u*Ue,le+=u*Me,ue+=u*je,ce+=u*Re,oe+=u*Ke,re+=u*He,he+=u*Ve,ye+=u*We,ie+=u*ke,we+=u*ze,ve+=u*qe,Se+=u*Pe,Oe+=u*Ge,De+=u*Ye,u=P[9],ge+=u*Fe,de+=u*Ne,le+=u*Ue,ue+=u*Me,ce+=u*je,oe+=u*Re,re+=u*Ke,he+=u*He,ye+=u*Ve,ie+=u*We,we+=u*ke,ve+=u*ze,Se+=u*qe,Oe+=u*Pe,De+=u*Ge,It+=u*Ye,u=P[10],de+=u*Fe,le+=u*Ne,ue+=u*Ue,ce+=u*Me,oe+=u*je,re+=u*Re,he+=u*Ke,ye+=u*He,ie+=u*Ve,we+=u*We,ve+=u*ke,Se+=u*ze,Oe+=u*qe,De+=u*Pe,It+=u*Ge,Nt+=u*Ye,u=P[11],le+=u*Fe,ue+=u*Ne,ce+=u*Ue,oe+=u*Me,re+=u*je,he+=u*Re,ye+=u*Ke,ie+=u*He,we+=u*Ve,ve+=u*We,Se+=u*ke,Oe+=u*ze,De+=u*qe,It+=u*Pe,Nt+=u*Ge,Vt+=u*Ye,u=P[12],ue+=u*Fe,ce+=u*Ne,oe+=u*Ue,re+=u*Me,he+=u*je,ye+=u*Re,ie+=u*Ke,we+=u*He,ve+=u*Ve,Se+=u*We,Oe+=u*ke,De+=u*ze,It+=u*qe,Nt+=u*Pe,Vt+=u*Ge,wt+=u*Ye,u=P[13],ce+=u*Fe,oe+=u*Ne,re+=u*Ue,he+=u*Me,ye+=u*je,ie+=u*Re,we+=u*Ke,ve+=u*He,Se+=u*Ve,Oe+=u*We,De+=u*ke,It+=u*ze,Nt+=u*qe,Vt+=u*Pe,wt+=u*Ge,rr+=u*Ye,u=P[14],oe+=u*Fe,re+=u*Ne,he+=u*Ue,ye+=u*Me,ie+=u*je,we+=u*Re,ve+=u*Ke,Se+=u*He,Oe+=u*Ve,De+=u*We,It+=u*ke,Nt+=u*ze,Vt+=u*qe,wt+=u*Pe,rr+=u*Ge,Cr+=u*Ye,u=P[15],re+=u*Fe,he+=u*Ne,ye+=u*Ue,ie+=u*Me,we+=u*je,ve+=u*Re,Se+=u*Ke,Oe+=u*He,De+=u*Ve,It+=u*We,Nt+=u*ke,Vt+=u*ze,wt+=u*qe,rr+=u*Pe,Cr+=u*Ge,fi+=u*Ye,V+=38*he,Y+=38*ye,fe+=38*ie,be+=38*we,pe+=38*ve,Ee+=38*Se,Le+=38*Oe,Ce+=38*De,_e+=38*It,ge+=38*Nt,de+=38*Vt,le+=38*wt,ue+=38*rr,ce+=38*Cr,oe+=38*fi,m=1,u=V+m+65535,m=Math.floor(u/65536),V=u-m*65536,u=Y+m+65535,m=Math.floor(u/65536),Y=u-m*65536,u=fe+m+65535,m=Math.floor(u/65536),fe=u-m*65536,u=be+m+65535,m=Math.floor(u/65536),be=u-m*65536,u=pe+m+65535,m=Math.floor(u/65536),pe=u-m*65536,u=Ee+m+65535,m=Math.floor(u/65536),Ee=u-m*65536,u=Le+m+65535,m=Math.floor(u/65536),Le=u-m*65536,u=Ce+m+65535,m=Math.floor(u/65536),Ce=u-m*65536,u=_e+m+65535,m=Math.floor(u/65536),_e=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=de+m+65535,m=Math.floor(u/65536),de=u-m*65536,u=le+m+65535,m=Math.floor(u/65536),le=u-m*65536,u=ue+m+65535,m=Math.floor(u/65536),ue=u-m*65536,u=ce+m+65535,m=Math.floor(u/65536),ce=u-m*65536,u=oe+m+65535,m=Math.floor(u/65536),oe=u-m*65536,u=re+m+65535,m=Math.floor(u/65536),re=u-m*65536,V+=m-1+37*(m-1),m=1,u=V+m+65535,m=Math.floor(u/65536),V=u-m*65536,u=Y+m+65535,m=Math.floor(u/65536),Y=u-m*65536,u=fe+m+65535,m=Math.floor(u/65536),fe=u-m*65536,u=be+m+65535,m=Math.floor(u/65536),be=u-m*65536,u=pe+m+65535,m=Math.floor(u/65536),pe=u-m*65536,u=Ee+m+65535,m=Math.floor(u/65536),Ee=u-m*65536,u=Le+m+65535,m=Math.floor(u/65536),Le=u-m*65536,u=Ce+m+65535,m=Math.floor(u/65536),Ce=u-m*65536,u=_e+m+65535,m=Math.floor(u/65536),_e=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=de+m+65535,m=Math.floor(u/65536),de=u-m*65536,u=le+m+65535,m=Math.floor(u/65536),le=u-m*65536,u=ue+m+65535,m=Math.floor(u/65536),ue=u-m*65536,u=ce+m+65535,m=Math.floor(u/65536),ce=u-m*65536,u=oe+m+65535,m=Math.floor(u/65536),oe=u-m*65536,u=re+m+65535,m=Math.floor(u/65536),re=u-m*65536,V+=m-1+37*(m-1),A[0]=V,A[1]=Y,A[2]=fe,A[3]=be,A[4]=pe,A[5]=Ee,A[6]=Le,A[7]=Ce,A[8]=_e,A[9]=ge,A[10]=de,A[11]=le,A[12]=ue,A[13]=ce,A[14]=oe,A[15]=re}function d(A,P){o(A,P,P)}function R(A,P){const O=n();let u;for(u=0;u<16;u++)O[u]=P[u];for(u=253;u>=0;u--)d(O,O),u!==2&&u!==4&&o(O,O,P);for(u=0;u<16;u++)A[u]=O[u]}function N(A,P){const O=n();let u;for(u=0;u<16;u++)O[u]=P[u];for(u=250;u>=0;u--)d(O,O),u!==1&&o(O,O,P);for(u=0;u<16;u++)A[u]=O[u]}function L(A,P){const O=n(),u=n(),m=n(),V=n(),Y=n(),fe=n(),be=n(),pe=n(),Ee=n();p(O,A[1],A[0]),p(Ee,P[1],P[0]),o(O,O,Ee),v(u,A[0],A[1]),v(Ee,P[0],P[1]),o(u,u,Ee),o(m,A[3],P[3]),o(m,m,l),o(V,A[2],P[2]),v(V,V,V),p(Y,u,O),p(fe,V,m),v(be,V,m),v(pe,u,O),o(A[0],Y,fe),o(A[1],pe,be),o(A[2],be,fe),o(A[3],Y,pe)}function K(A,P,O){for(let u=0;u<4;u++)C(A[u],P[u],O)}function G(A,P){const O=n(),u=n(),m=n();R(m,P[2]),o(O,P[0],m),o(u,P[1],m),$(A,u),A[31]^=I(O)<<7}function S(A,P,O){w(A[0],a),w(A[1],c),w(A[2],c),w(A[3],a);for(let u=255;u>=0;--u){const m=O[u/8|0]>>(u&7)&1;K(A,P,m),L(P,A),L(A,A),K(A,P,m)}}function T(A,P){const O=[n(),n(),n(),n()];w(O[0],f),w(O[1],_),w(O[2],c),o(O[3],f,_),S(A,O,P)}function W(A){if(A.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const P=(0,r.hash)(A);P[0]&=248,P[31]&=127,P[31]|=64;const O=new Uint8Array(32),u=[n(),n(),n(),n()];T(u,P),G(O,u);const m=new Uint8Array(64);return m.set(A),m.set(O,32),{publicKey:O,secretKey:m}}t.generateKeyPairFromSeed=W;function B(A){const P=(0,e.randomBytes)(32,A),O=W(P);return(0,i.wipe)(P),O}t.generateKeyPair=B;function U(A){if(A.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(A.subarray(32))}t.extractPublicKeyFromSecretKey=U;const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function F(A,P){let O,u,m,V;for(u=63;u>=32;--u){for(O=0,m=u-32,V=u-12;m<V;++m)P[m]+=O-16*P[u]*j[m-(u-32)],O=Math.floor((P[m]+128)/256),P[m]-=O*256;P[m]+=O,P[u]=0}for(O=0,m=0;m<32;m++)P[m]+=O-(P[31]>>4)*j[m],O=P[m]>>8,P[m]&=255;for(m=0;m<32;m++)P[m]-=O*j[m];for(u=0;u<32;u++)P[u+1]+=P[u]>>8,A[u]=P[u]&255}function z(A){const P=new Float64Array(64);for(let O=0;O<64;O++)P[O]=A[O];for(let O=0;O<64;O++)A[O]=0;F(A,P)}function te(A,P){const O=new Float64Array(64),u=[n(),n(),n(),n()],m=(0,r.hash)(A.subarray(0,32));m[0]&=248,m[31]&=127,m[31]|=64;const V=new Uint8Array(64);V.set(m.subarray(32),32);const Y=new r.SHA512;Y.update(V.subarray(32)),Y.update(P);const fe=Y.digest();Y.clean(),z(fe),T(u,fe),G(V,u),Y.reset(),Y.update(V.subarray(0,32)),Y.update(A.subarray(32)),Y.update(P);const be=Y.digest();z(be);for(let pe=0;pe<32;pe++)O[pe]=fe[pe];for(let pe=0;pe<32;pe++)for(let Ee=0;Ee<32;Ee++)O[pe+Ee]+=be[pe]*m[Ee];return F(V.subarray(32),O),V}t.sign=te;function H(A,P){const O=n(),u=n(),m=n(),V=n(),Y=n(),fe=n(),be=n();return w(A[2],c),b(A[1],P),d(m,A[1]),o(V,m,h),p(m,m,A[2]),v(V,A[2],V),d(Y,V),d(fe,Y),o(be,fe,Y),o(O,be,m),o(O,O,V),N(O,O),o(O,O,m),o(O,O,V),o(O,O,V),o(A[0],O,V),d(u,A[0]),o(u,u,V),E(u,m)&&o(A[0],A[0],y),d(u,A[0]),o(u,u,V),E(u,m)?-1:(I(A[0])===P[31]>>7&&p(A[0],a,A[0]),o(A[3],A[0],A[1]),0)}function Z(A,P,O){const u=new Uint8Array(32),m=[n(),n(),n(),n()],V=[n(),n(),n(),n()];if(O.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(H(V,A))return!1;const Y=new r.SHA512;Y.update(O.subarray(0,32)),Y.update(A),Y.update(P);const fe=Y.digest();return z(fe),S(m,V,fe),T(V,O.subarray(32)),L(m,V),G(u,m),!q(O,u)}t.verify=Z;function J(A){let P=[n(),n(),n(),n()];if(H(P,A))throw new Error("Ed25519: invalid public key");let O=n(),u=n(),m=P[1];v(O,c,m),p(u,c,m),R(u,u),o(O,O,u);let V=new Uint8Array(32);return $(V,O),V}t.convertPublicKeyToX25519=J;function ee(A){const P=(0,r.hash)(A.subarray(0,32));P[0]&=248,P[31]&=127,P[31]|=64;const O=new Uint8Array(P.subarray(0,32));return(0,i.wipe)(P),O}t.convertSecretKeyToX25519=ee})(Gn);const Mf="EdDSA",jf="JWT",Ca=".",Na="base64url",qf="utf8",Bf="utf8",zf=":",Kf="did",Hf="key",so="base58btc",Vf="z",Wf="K36",kf=32;function Yn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Ra(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Yn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Rn(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Ra(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return Yn(r)}function Gf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var C=0,$=0,q=0,E=D.length;q!==E&&D[q]===0;)q++,C++;for(var I=(E-q)*f+1>>>0,b=new Uint8Array(I);q!==E;){for(var v=D[q],p=0,o=I-1;(v!==0||p<$)&&o!==-1;o--,p++)v+=256*b[o]>>>0,b[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");$=p,q++}for(var d=I-$;d!==I&&b[d]===0;)d++;for(var R=h.repeat(C);d<I;++d)R+=t.charAt(b[d]);return R}function y(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var C=0;if(D[C]!==" "){for(var $=0,q=0;D[C]===h;)$++,C++;for(var E=(D.length-C)*l+1>>>0,I=new Uint8Array(E);D[C];){var b=r[D.charCodeAt(C)];if(b===255)return;for(var v=0,p=E-1;(b!==0||v<q)&&p!==-1;p--,v++)b+=c*I[p]>>>0,I[p]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");q=v,C++}if(D[C]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var d=new Uint8Array($+(E-o)),R=$;o!==E;)d[R++]=I[o++];return d}}}function w(D){var C=y(D);if(C)return C;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:y,decode:w}}var Yf=Gf,Jf=Yf;const Qf=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Xf=t=>new TextEncoder().encode(t),Zf=t=>new TextDecoder().decode(t);class ed{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class td{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $a(this,e)}}class rd{constructor(e){this.decoders=e}or(e){return $a(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $a=(t,e)=>new rd({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class id{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new ed(e,r,i),this.decoder=new td(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qi=({name:t,prefix:e,encode:r,decode:i})=>new id(t,e,r,i),si=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Jf(r,e);return qi({prefix:t,name:e,encode:i,decode:s=>Qf(n(s))})},nd=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|_,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},sd=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>qi({prefix:e,name:t,encode(n){return sd(n,i,r)},decode(n){return nd(n,i,r,t)}}),od=qi({prefix:"\0",name:"identity",encode:t=>Zf(t),decode:t=>Xf(t)});var ad=Object.freeze({__proto__:null,identity:od});const cd=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ud=Object.freeze({__proto__:null,base2:cd});const ld=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hd=Object.freeze({__proto__:null,base8:ld});const fd=si({prefix:"9",name:"base10",alphabet:"0123456789"});var dd=Object.freeze({__proto__:null,base10:fd});const pd=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),gd=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var yd=Object.freeze({__proto__:null,base16:pd,base16upper:gd});const _d=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bd=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wd=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),md=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vd=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ed=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dd=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Sd=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Od=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var xd=Object.freeze({__proto__:null,base32:_d,base32hex:vd,base32hexpad:Dd,base32hexpadupper:Sd,base32hexupper:Ed,base32pad:wd,base32padupper:md,base32upper:bd,base32z:Od});const Id=si({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Pd=si({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ad=Object.freeze({__proto__:null,base36:Id,base36upper:Pd});const Td=si({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Cd=si({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Nd=Object.freeze({__proto__:null,base58btc:Td,base58flickr:Cd});const Rd=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$d=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ld=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Fd=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ud=Object.freeze({__proto__:null,base64:Rd,base64pad:$d,base64url:Ld,base64urlpad:Fd});const La=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Md=La.reduce((t,e,r)=>(t[r]=e,t),[]),jd=La.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function qd(t){return t.reduce((e,r)=>(e+=Md[r],e),"")}function Bd(t){const e=[];for(const r of t){const i=jd[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const zd=qi({prefix:"\u{1F680}",name:"base256emoji",encode:qd,decode:Bd});var Kd=Object.freeze({__proto__:null,base256emoji:zd});new TextEncoder;new TextDecoder;const oo={...ad,...ud,...hd,...dd,...yd,...xd,...Ad,...Nd,...Ud,...Kd};function Fa(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ao=Fa("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),on=Fa("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ra(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ua={utf8:ao,"utf-8":ao,hex:oo.base16,latin1:on,ascii:on,binary:on,...oo};function gt(t,e="utf8"){const r=Ua[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function bt(t,e="utf8"){const r=Ua[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Yn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Ai(t){return gt(bt(kn(t),qf),Na)}function Ma(t){const e=bt(Wf,so),r=Vf+gt(Rn([e,t]),so);return[Kf,Hf,r].join(zf)}function Hd(t){return gt(t,Na)}function Vd(t){return bt([Ai(t.header),Ai(t.payload)].join(Ca),Bf)}function Wd(t){return[Ai(t.header),Ai(t.payload),Hd(t.signature)].join(Ca)}function co(t=Pr.randomBytes(kf)){return Gn.generateKeyPairFromSeed(t)}async function kd(t,e,r,i,n=X.fromMiliseconds(Date.now())){const s={alg:Mf,typ:jf},a=Ma(i.publicKey),c=n+r,h={iss:a,sub:t,aud:e,iat:n,exp:c},l=Vd({header:s,payload:h}),f=Gn.sign(i.secretKey,l);return Wd({header:s,payload:h,signature:f})}var Jn={},Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});var ot=ne,$n=Dt,Gd=20;function Yd(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],_=r[19]<<24|r[18]<<16|r[17]<<8|r[16],y=r[23]<<24|r[22]<<16|r[21]<<8|r[20],w=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],C=e[3]<<24|e[2]<<16|e[1]<<8|e[0],$=e[7]<<24|e[6]<<16|e[5]<<8|e[4],q=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=i,b=n,v=s,p=a,o=c,d=h,R=l,N=f,L=_,K=y,G=w,S=D,T=C,W=$,B=q,U=E,j=0;j<Gd;j+=2)I=I+o|0,T^=I,T=T>>>32-16|T<<16,L=L+T|0,o^=L,o=o>>>32-12|o<<12,b=b+d|0,W^=b,W=W>>>32-16|W<<16,K=K+W|0,d^=K,d=d>>>32-12|d<<12,v=v+R|0,B^=v,B=B>>>32-16|B<<16,G=G+B|0,R^=G,R=R>>>32-12|R<<12,p=p+N|0,U^=p,U=U>>>32-16|U<<16,S=S+U|0,N^=S,N=N>>>32-12|N<<12,v=v+R|0,B^=v,B=B>>>32-8|B<<8,G=G+B|0,R^=G,R=R>>>32-7|R<<7,p=p+N|0,U^=p,U=U>>>32-8|U<<8,S=S+U|0,N^=S,N=N>>>32-7|N<<7,b=b+d|0,W^=b,W=W>>>32-8|W<<8,K=K+W|0,d^=K,d=d>>>32-7|d<<7,I=I+o|0,T^=I,T=T>>>32-8|T<<8,L=L+T|0,o^=L,o=o>>>32-7|o<<7,I=I+d|0,U^=I,U=U>>>32-16|U<<16,G=G+U|0,d^=G,d=d>>>32-12|d<<12,b=b+R|0,T^=b,T=T>>>32-16|T<<16,S=S+T|0,R^=S,R=R>>>32-12|R<<12,v=v+N|0,W^=v,W=W>>>32-16|W<<16,L=L+W|0,N^=L,N=N>>>32-12|N<<12,p=p+o|0,B^=p,B=B>>>32-16|B<<16,K=K+B|0,o^=K,o=o>>>32-12|o<<12,v=v+N|0,W^=v,W=W>>>32-8|W<<8,L=L+W|0,N^=L,N=N>>>32-7|N<<7,p=p+o|0,B^=p,B=B>>>32-8|B<<8,K=K+B|0,o^=K,o=o>>>32-7|o<<7,b=b+R|0,T^=b,T=T>>>32-8|T<<8,S=S+T|0,R^=S,R=R>>>32-7|R<<7,I=I+d|0,U^=I,U=U>>>32-8|U<<8,G=G+U|0,d^=G,d=d>>>32-7|d<<7;ot.writeUint32LE(I+i|0,t,0),ot.writeUint32LE(b+n|0,t,4),ot.writeUint32LE(v+s|0,t,8),ot.writeUint32LE(p+a|0,t,12),ot.writeUint32LE(o+c|0,t,16),ot.writeUint32LE(d+h|0,t,20),ot.writeUint32LE(R+l|0,t,24),ot.writeUint32LE(N+f|0,t,28),ot.writeUint32LE(L+_|0,t,32),ot.writeUint32LE(K+y|0,t,36),ot.writeUint32LE(G+w|0,t,40),ot.writeUint32LE(S+D|0,t,44),ot.writeUint32LE(T+C|0,t,48),ot.writeUint32LE(W+$|0,t,52),ot.writeUint32LE(B+q|0,t,56),ot.writeUint32LE(U+E|0,t,60)}function ja(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=n}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Yd(c,s,t);for(var l=h;l<h+64&&l<r.length;l++)i[l]=r[l]^c[l-h];Qd(s,0,a)}return $n.wipe(c),n===0&&$n.wipe(s),i}Bi.streamXOR=ja;function Jd(t,e,r,i){return i===void 0&&(i=0),$n.wipe(r),ja(t,e,r,r,i)}Bi.stream=Jd;function Qd(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var qa={},tr={};Object.defineProperty(tr,"__esModule",{value:!0});function Xd(t,e,r){return~(t-1)&e|t-1&r}tr.select=Xd;function Zd(t,e){return(t|0)-(e|0)-1>>>31&1}tr.lessOrEqual=Zd;function Ba(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}tr.compare=Ba;function ep(t,e){return t.length===0||e.length===0?!1:Ba(t,e)!==0}tr.equal=ep;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=tr,r=Dt;t.DIGEST_LENGTH=16;var i=function(){function a(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var l=c[2]|c[3]<<8;this._r[1]=(h>>>13|l<<3)&8191;var f=c[4]|c[5]<<8;this._r[2]=(l>>>10|f<<6)&7939;var _=c[6]|c[7]<<8;this._r[3]=(f>>>7|_<<9)&8191;var y=c[8]|c[9]<<8;this._r[4]=(_>>>4|y<<12)&255,this._r[5]=y>>>1&8190;var w=c[10]|c[11]<<8;this._r[6]=(y>>>14|w<<2)&8191;var D=c[12]|c[13]<<8;this._r[7]=(w>>>11|D<<5)&8065;var C=c[14]|c[15]<<8;this._r[8]=(D>>>8|C<<8)&8191,this._r[9]=C>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,h,l){for(var f=this._fin?0:2048,_=this._h[0],y=this._h[1],w=this._h[2],D=this._h[3],C=this._h[4],$=this._h[5],q=this._h[6],E=this._h[7],I=this._h[8],b=this._h[9],v=this._r[0],p=this._r[1],o=this._r[2],d=this._r[3],R=this._r[4],N=this._r[5],L=this._r[6],K=this._r[7],G=this._r[8],S=this._r[9];l>=16;){var T=c[h+0]|c[h+1]<<8;_+=T&8191;var W=c[h+2]|c[h+3]<<8;y+=(T>>>13|W<<3)&8191;var B=c[h+4]|c[h+5]<<8;w+=(W>>>10|B<<6)&8191;var U=c[h+6]|c[h+7]<<8;D+=(B>>>7|U<<9)&8191;var j=c[h+8]|c[h+9]<<8;C+=(U>>>4|j<<12)&8191,$+=j>>>1&8191;var F=c[h+10]|c[h+11]<<8;q+=(j>>>14|F<<2)&8191;var z=c[h+12]|c[h+13]<<8;E+=(F>>>11|z<<5)&8191;var te=c[h+14]|c[h+15]<<8;I+=(z>>>8|te<<8)&8191,b+=te>>>5|f;var H=0,Z=H;Z+=_*v,Z+=y*(5*S),Z+=w*(5*G),Z+=D*(5*K),Z+=C*(5*L),H=Z>>>13,Z&=8191,Z+=$*(5*N),Z+=q*(5*R),Z+=E*(5*d),Z+=I*(5*o),Z+=b*(5*p),H+=Z>>>13,Z&=8191;var J=H;J+=_*p,J+=y*v,J+=w*(5*S),J+=D*(5*G),J+=C*(5*K),H=J>>>13,J&=8191,J+=$*(5*L),J+=q*(5*N),J+=E*(5*R),J+=I*(5*d),J+=b*(5*o),H+=J>>>13,J&=8191;var ee=H;ee+=_*o,ee+=y*p,ee+=w*v,ee+=D*(5*S),ee+=C*(5*G),H=ee>>>13,ee&=8191,ee+=$*(5*K),ee+=q*(5*L),ee+=E*(5*N),ee+=I*(5*R),ee+=b*(5*d),H+=ee>>>13,ee&=8191;var A=H;A+=_*d,A+=y*o,A+=w*p,A+=D*v,A+=C*(5*S),H=A>>>13,A&=8191,A+=$*(5*G),A+=q*(5*K),A+=E*(5*L),A+=I*(5*N),A+=b*(5*R),H+=A>>>13,A&=8191;var P=H;P+=_*R,P+=y*d,P+=w*o,P+=D*p,P+=C*v,H=P>>>13,P&=8191,P+=$*(5*S),P+=q*(5*G),P+=E*(5*K),P+=I*(5*L),P+=b*(5*N),H+=P>>>13,P&=8191;var O=H;O+=_*N,O+=y*R,O+=w*d,O+=D*o,O+=C*p,H=O>>>13,O&=8191,O+=$*v,O+=q*(5*S),O+=E*(5*G),O+=I*(5*K),O+=b*(5*L),H+=O>>>13,O&=8191;var u=H;u+=_*L,u+=y*N,u+=w*R,u+=D*d,u+=C*o,H=u>>>13,u&=8191,u+=$*p,u+=q*v,u+=E*(5*S),u+=I*(5*G),u+=b*(5*K),H+=u>>>13,u&=8191;var m=H;m+=_*K,m+=y*L,m+=w*N,m+=D*R,m+=C*d,H=m>>>13,m&=8191,m+=$*o,m+=q*p,m+=E*v,m+=I*(5*S),m+=b*(5*G),H+=m>>>13,m&=8191;var V=H;V+=_*G,V+=y*K,V+=w*L,V+=D*N,V+=C*R,H=V>>>13,V&=8191,V+=$*d,V+=q*o,V+=E*p,V+=I*v,V+=b*(5*S),H+=V>>>13,V&=8191;var Y=H;Y+=_*S,Y+=y*G,Y+=w*K,Y+=D*L,Y+=C*N,H=Y>>>13,Y&=8191,Y+=$*R,Y+=q*d,Y+=E*o,Y+=I*p,Y+=b*v,H+=Y>>>13,Y&=8191,H=(H<<2)+H|0,H=H+Z|0,Z=H&8191,H=H>>>13,J+=H,_=Z,y=J,w=ee,D=A,C=P,$=O,q=u,E=m,I=V,b=Y,h+=16,l-=16}this._h[0]=_,this._h[1]=y,this._h[2]=w,this._h[3]=D,this._h[4]=C,this._h[5]=$,this._h[6]=q,this._h[7]=E,this._h[8]=I,this._h[9]=b},a.prototype.finish=function(c,h){h===void 0&&(h=0);var l=new Uint16Array(10),f,_,y,w;if(this._leftover){for(w=this._leftover,this._buffer[w++]=1;w<16;w++)this._buffer[w]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,w=2;w<10;w++)this._h[w]+=f,f=this._h[w]>>>13,this._h[w]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,l[0]=this._h[0]+5,f=l[0]>>>13,l[0]&=8191,w=1;w<10;w++)l[w]=this._h[w]+f,f=l[w]>>>13,l[w]&=8191;for(l[9]-=1<<13,_=(f^1)-1,w=0;w<10;w++)l[w]&=_;for(_=~_,w=0;w<10;w++)this._h[w]=this._h[w]&_|l[w];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,y=this._h[0]+this._pad[0],this._h[0]=y&65535,w=1;w<8;w++)y=(this._h[w]+this._pad[w]|0)+(y>>>16)|0,this._h[w]=y&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var h=0,l=c.length,f;if(this._leftover){f=16-this._leftover,f>l&&(f=l);for(var _=0;_<f;_++)this._buffer[this._leftover+_]=c[h+_];if(l-=f,h+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(f=l-l%16,this._blocks(c,h,f),h+=f,l-=f),l){for(var _=0;_<l;_++)this._buffer[this._leftover+_]=c[h+_];this._leftover+=l}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=i;function n(a,c){var h=new i(a);h.update(c);var l=h.digest();return h.clean(),l}t.oneTimeAuth=n;function s(a,c){return a.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(a,c)}t.equal=s})(qa);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Bi,r=qa,i=Dt,n=ne,s=tr;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,f,_,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var w=new Uint8Array(16);w.set(l,w.length-l.length);var D=new Uint8Array(32);e.stream(this._key,w,D,4);var C=f.length+this.tagLength,$;if(y){if(y.length!==C)throw new Error("ChaCha20Poly1305: incorrect destination length");$=y}else $=new Uint8Array(C);return e.streamXOR(this._key,w,f,$,4),this._authenticate($.subarray($.length-this.tagLength,$.length),D,$.subarray(0,$.length-this.tagLength),_),i.wipe(w),$},h.prototype.open=function(l,f,_,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var w=new Uint8Array(16);w.set(l,w.length-l.length);var D=new Uint8Array(32);e.stream(this._key,w,D,4);var C=new Uint8Array(this.tagLength);if(this._authenticate(C,D,f.subarray(0,f.length-this.tagLength),_),!s.equal(C,f.subarray(f.length-this.tagLength,f.length)))return null;var $=f.length-this.tagLength,q;if(y){if(y.length!==$)throw new Error("ChaCha20Poly1305: incorrect destination length");q=y}else q=new Uint8Array($);return e.streamXOR(this._key,w,f.subarray(0,f.length-this.tagLength),q,4),i.wipe(w),q},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(l,f,_,y){var w=new r.Poly1305(f);y&&(w.update(y),y.length%16>0&&w.update(a.subarray(y.length%16))),w.update(_),_.length%16>0&&w.update(a.subarray(_.length%16));var D=new Uint8Array(8);y&&n.writeUint64LE(y.length,D),w.update(D),n.writeUint64LE(_.length,D),w.update(D);for(var C=w.digest(),$=0;$<C.length;$++)l[$]=C[$];w.clean(),i.wipe(C),i.wipe(D)},h}();t.ChaCha20Poly1305=c})(Jn);var za={},oi={},Qn={};Object.defineProperty(Qn,"__esModule",{value:!0});function tp(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Qn.isSerializableHash=tp;Object.defineProperty(oi,"__esModule",{value:!0});var Lt=Qn,rp=tr,ip=Dt,Ka=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Lt.isSerializableHash(this._inner)&&Lt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ip.wipe(i)}return t.prototype.reset=function(){if(!Lt.isSerializableHash(this._inner)||!Lt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Lt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Lt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Lt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Lt.isSerializableHash(this._inner)||!Lt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Lt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();oi.HMAC=Ka;function np(t,e,r){var i=new Ka(t,e);i.update(r);var n=i.digest();return i.clean(),n}oi.hmac=np;oi.equal=rp.equal;Object.defineProperty(za,"__esModule",{value:!0});var uo=oi,lo=Dt,sp=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=uo.hmac(this._hash,i,r);this._hmac=new uo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),lo.wipe(this._buffer),lo.wipe(this._counter),this._bufpos=0},t}(),op=za.HKDF=sp,zi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=Dt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._temp,this._state,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,_=l/536870912|0,y=l<<3,w=l%64<56?64:128;this._buffer[f]=128;for(var D=f+1;D<w-8;D++)this._buffer[D]=0;e.writeUint32BE(_,this._buffer,w-8),e.writeUint32BE(y,this._buffer,w-4),s(this._temp,this._state,this._buffer,0,w),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)e.writeUint32BE(this._state[D],h,D*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,l,f,_){for(;_>=64;){for(var y=h[0],w=h[1],D=h[2],C=h[3],$=h[4],q=h[5],E=h[6],I=h[7],b=0;b<16;b++){var v=f+b*4;c[b]=e.readUint32BE(l,v)}for(var b=16;b<64;b++){var p=c[b-2],o=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=c[b-15];var d=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;c[b]=(o+c[b-7]|0)+(d+c[b-16]|0)}for(var b=0;b<64;b++){var o=((($>>>6|$<<26)^($>>>11|$<<21)^($>>>25|$<<7))+($&q^~$&E)|0)+(I+(n[b]+c[b]|0)|0)|0,d=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&w^y&D^w&D)|0;I=E,E=q,q=$,$=C+o|0,C=D,D=w,w=y,y=o+d|0}h[0]+=y,h[1]+=w,h[2]+=D,h[3]+=C,h[4]+=$,h[5]+=q,h[6]+=E,h[7]+=I,f+=64,_-=64}return f}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(zi);var Xn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=Pr,r=Dt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(b){const v=new Float64Array(16);if(b)for(let p=0;p<b.length;p++)v[p]=b[p];return v}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function a(b){let v=1;for(let p=0;p<16;p++){let o=b[p]+v+65535;v=Math.floor(o/65536),b[p]=o-v*65536}b[0]+=v-1+37*(v-1)}function c(b,v,p){const o=~(p-1);for(let d=0;d<16;d++){const R=o&(b[d]^v[d]);b[d]^=R,v[d]^=R}}function h(b,v){const p=i(),o=i();for(let d=0;d<16;d++)o[d]=v[d];a(o),a(o),a(o);for(let d=0;d<2;d++){p[0]=o[0]-65517;for(let N=1;N<15;N++)p[N]=o[N]-65535-(p[N-1]>>16&1),p[N-1]&=65535;p[15]=o[15]-32767-(p[14]>>16&1);const R=p[15]>>16&1;p[14]&=65535,c(o,p,1-R)}for(let d=0;d<16;d++)b[2*d]=o[d]&255,b[2*d+1]=o[d]>>8}function l(b,v){for(let p=0;p<16;p++)b[p]=v[2*p]+(v[2*p+1]<<8);b[15]&=32767}function f(b,v,p){for(let o=0;o<16;o++)b[o]=v[o]+p[o]}function _(b,v,p){for(let o=0;o<16;o++)b[o]=v[o]-p[o]}function y(b,v,p){let o,d,R=0,N=0,L=0,K=0,G=0,S=0,T=0,W=0,B=0,U=0,j=0,F=0,z=0,te=0,H=0,Z=0,J=0,ee=0,A=0,P=0,O=0,u=0,m=0,V=0,Y=0,fe=0,be=0,pe=0,Ee=0,Le=0,Ce=0,_e=p[0],ge=p[1],de=p[2],le=p[3],ue=p[4],ce=p[5],oe=p[6],re=p[7],he=p[8],ye=p[9],ie=p[10],we=p[11],ve=p[12],Se=p[13],Oe=p[14],De=p[15];o=v[0],R+=o*_e,N+=o*ge,L+=o*de,K+=o*le,G+=o*ue,S+=o*ce,T+=o*oe,W+=o*re,B+=o*he,U+=o*ye,j+=o*ie,F+=o*we,z+=o*ve,te+=o*Se,H+=o*Oe,Z+=o*De,o=v[1],N+=o*_e,L+=o*ge,K+=o*de,G+=o*le,S+=o*ue,T+=o*ce,W+=o*oe,B+=o*re,U+=o*he,j+=o*ye,F+=o*ie,z+=o*we,te+=o*ve,H+=o*Se,Z+=o*Oe,J+=o*De,o=v[2],L+=o*_e,K+=o*ge,G+=o*de,S+=o*le,T+=o*ue,W+=o*ce,B+=o*oe,U+=o*re,j+=o*he,F+=o*ye,z+=o*ie,te+=o*we,H+=o*ve,Z+=o*Se,J+=o*Oe,ee+=o*De,o=v[3],K+=o*_e,G+=o*ge,S+=o*de,T+=o*le,W+=o*ue,B+=o*ce,U+=o*oe,j+=o*re,F+=o*he,z+=o*ye,te+=o*ie,H+=o*we,Z+=o*ve,J+=o*Se,ee+=o*Oe,A+=o*De,o=v[4],G+=o*_e,S+=o*ge,T+=o*de,W+=o*le,B+=o*ue,U+=o*ce,j+=o*oe,F+=o*re,z+=o*he,te+=o*ye,H+=o*ie,Z+=o*we,J+=o*ve,ee+=o*Se,A+=o*Oe,P+=o*De,o=v[5],S+=o*_e,T+=o*ge,W+=o*de,B+=o*le,U+=o*ue,j+=o*ce,F+=o*oe,z+=o*re,te+=o*he,H+=o*ye,Z+=o*ie,J+=o*we,ee+=o*ve,A+=o*Se,P+=o*Oe,O+=o*De,o=v[6],T+=o*_e,W+=o*ge,B+=o*de,U+=o*le,j+=o*ue,F+=o*ce,z+=o*oe,te+=o*re,H+=o*he,Z+=o*ye,J+=o*ie,ee+=o*we,A+=o*ve,P+=o*Se,O+=o*Oe,u+=o*De,o=v[7],W+=o*_e,B+=o*ge,U+=o*de,j+=o*le,F+=o*ue,z+=o*ce,te+=o*oe,H+=o*re,Z+=o*he,J+=o*ye,ee+=o*ie,A+=o*we,P+=o*ve,O+=o*Se,u+=o*Oe,m+=o*De,o=v[8],B+=o*_e,U+=o*ge,j+=o*de,F+=o*le,z+=o*ue,te+=o*ce,H+=o*oe,Z+=o*re,J+=o*he,ee+=o*ye,A+=o*ie,P+=o*we,O+=o*ve,u+=o*Se,m+=o*Oe,V+=o*De,o=v[9],U+=o*_e,j+=o*ge,F+=o*de,z+=o*le,te+=o*ue,H+=o*ce,Z+=o*oe,J+=o*re,ee+=o*he,A+=o*ye,P+=o*ie,O+=o*we,u+=o*ve,m+=o*Se,V+=o*Oe,Y+=o*De,o=v[10],j+=o*_e,F+=o*ge,z+=o*de,te+=o*le,H+=o*ue,Z+=o*ce,J+=o*oe,ee+=o*re,A+=o*he,P+=o*ye,O+=o*ie,u+=o*we,m+=o*ve,V+=o*Se,Y+=o*Oe,fe+=o*De,o=v[11],F+=o*_e,z+=o*ge,te+=o*de,H+=o*le,Z+=o*ue,J+=o*ce,ee+=o*oe,A+=o*re,P+=o*he,O+=o*ye,u+=o*ie,m+=o*we,V+=o*ve,Y+=o*Se,fe+=o*Oe,be+=o*De,o=v[12],z+=o*_e,te+=o*ge,H+=o*de,Z+=o*le,J+=o*ue,ee+=o*ce,A+=o*oe,P+=o*re,O+=o*he,u+=o*ye,m+=o*ie,V+=o*we,Y+=o*ve,fe+=o*Se,be+=o*Oe,pe+=o*De,o=v[13],te+=o*_e,H+=o*ge,Z+=o*de,J+=o*le,ee+=o*ue,A+=o*ce,P+=o*oe,O+=o*re,u+=o*he,m+=o*ye,V+=o*ie,Y+=o*we,fe+=o*ve,be+=o*Se,pe+=o*Oe,Ee+=o*De,o=v[14],H+=o*_e,Z+=o*ge,J+=o*de,ee+=o*le,A+=o*ue,P+=o*ce,O+=o*oe,u+=o*re,m+=o*he,V+=o*ye,Y+=o*ie,fe+=o*we,be+=o*ve,pe+=o*Se,Ee+=o*Oe,Le+=o*De,o=v[15],Z+=o*_e,J+=o*ge,ee+=o*de,A+=o*le,P+=o*ue,O+=o*ce,u+=o*oe,m+=o*re,V+=o*he,Y+=o*ye,fe+=o*ie,be+=o*we,pe+=o*ve,Ee+=o*Se,Le+=o*Oe,Ce+=o*De,R+=38*J,N+=38*ee,L+=38*A,K+=38*P,G+=38*O,S+=38*u,T+=38*m,W+=38*V,B+=38*Y,U+=38*fe,j+=38*be,F+=38*pe,z+=38*Ee,te+=38*Le,H+=38*Ce,d=1,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=N+d+65535,d=Math.floor(o/65536),N=o-d*65536,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=S+d+65535,d=Math.floor(o/65536),S=o-d*65536,o=T+d+65535,d=Math.floor(o/65536),T=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=te+d+65535,d=Math.floor(o/65536),te=o-d*65536,o=H+d+65535,d=Math.floor(o/65536),H=o-d*65536,o=Z+d+65535,d=Math.floor(o/65536),Z=o-d*65536,R+=d-1+37*(d-1),d=1,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=N+d+65535,d=Math.floor(o/65536),N=o-d*65536,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=S+d+65535,d=Math.floor(o/65536),S=o-d*65536,o=T+d+65535,d=Math.floor(o/65536),T=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=te+d+65535,d=Math.floor(o/65536),te=o-d*65536,o=H+d+65535,d=Math.floor(o/65536),H=o-d*65536,o=Z+d+65535,d=Math.floor(o/65536),Z=o-d*65536,R+=d-1+37*(d-1),b[0]=R,b[1]=N,b[2]=L,b[3]=K,b[4]=G,b[5]=S,b[6]=T,b[7]=W,b[8]=B,b[9]=U,b[10]=j,b[11]=F,b[12]=z,b[13]=te,b[14]=H,b[15]=Z}function w(b,v){y(b,v,v)}function D(b,v){const p=i();for(let o=0;o<16;o++)p[o]=v[o];for(let o=253;o>=0;o--)w(p,p),o!==2&&o!==4&&y(p,p,v);for(let o=0;o<16;o++)b[o]=p[o]}function C(b,v){const p=new Uint8Array(32),o=new Float64Array(80),d=i(),R=i(),N=i(),L=i(),K=i(),G=i();for(let B=0;B<31;B++)p[B]=b[B];p[31]=b[31]&127|64,p[0]&=248,l(o,v);for(let B=0;B<16;B++)R[B]=o[B];d[0]=L[0]=1;for(let B=254;B>=0;--B){const U=p[B>>>3]>>>(B&7)&1;c(d,R,U),c(N,L,U),f(K,d,N),_(d,d,N),f(N,R,L),_(R,R,L),w(L,K),w(G,d),y(d,N,d),y(N,R,K),f(K,d,N),_(d,d,N),w(R,d),_(N,L,G),y(d,N,s),f(d,d,L),y(N,N,d),y(d,L,G),y(L,R,o),w(R,K),c(d,R,U),c(N,L,U)}for(let B=0;B<16;B++)o[B+16]=d[B],o[B+32]=N[B],o[B+48]=R[B],o[B+64]=L[B];const S=o.subarray(32),T=o.subarray(16);D(S,S),y(T,T,S);const W=new Uint8Array(32);return h(W,T),W}t.scalarMult=C;function $(b){return C(b,n)}t.scalarMultBase=$;function q(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(b);return{publicKey:$(v),secretKey:v}}t.generateKeyPairFromSeed=q;function E(b){const v=(0,e.randomBytes)(32,b),p=q(v);return(0,r.wipe)(v),p}t.generateKeyPair=E;function I(b,v,p=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=C(b,v);if(p){let d=0;for(let R=0;R<o.length;R++)d|=o[R];if(d===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=I})(Xn);var ho=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},ap=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),cp=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),up=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),lp=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),hp=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),fp=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,dp=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,fo=3,pp=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",fp]],po=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function gp(t){return t?go(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new hp:typeof navigator<"u"?go(navigator.userAgent):bp()}function yp(t){return t!==""&&pp.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function go(t){var e=yp(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new lp;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<fo&&(n=ho(ho([],n,!0),wp(fo-n.length),!0)):n=[];var s=n.join("."),a=_p(t),c=dp.exec(t);return c&&c[1]?new up(r,s,a,c[1]):new ap(r,s,a)}function _p(t){for(var e=0,r=po.length;e<r;e++){var i=po[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function bp(){var t=typeof process<"u"&&process.version;return t?new cp(process.version.slice(1)):null}function wp(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=Va=xe.getLocation=xe.getLocationOrThrow=Zn=xe.getNavigator=xe.getNavigatorOrThrow=Ha=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function _r(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=_r;function Ar(t){const e=_r(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=Ar;function mp(){return Ar("document")}xe.getDocumentOrThrow=mp;function vp(){return _r("document")}var Ha=xe.getDocument=vp;function Ep(){return Ar("navigator")}xe.getNavigatorOrThrow=Ep;function Dp(){return _r("navigator")}var Zn=xe.getNavigator=Dp;function Sp(){return Ar("location")}xe.getLocationOrThrow=Sp;function Op(){return _r("location")}var Va=xe.getLocation=Op;function xp(){return Ar("crypto")}xe.getCryptoOrThrow=xp;function Ip(){return _r("crypto")}xe.getCrypto=Ip;function Pp(){return Ar("localStorage")}xe.getLocalStorageOrThrow=Pp;function Ap(){return _r("localStorage")}xe.getLocalStorage=Ap;var es={};Object.defineProperty(es,"__esModule",{value:!0});var Wa=es.getWindowMetadata=void 0;const yo=xe;function Tp(){let t,e;try{t=yo.getDocumentOrThrow(),e=yo.getLocationOrThrow()}catch{return null}function r(){const _=t.getElementsByTagName("link"),y=[];for(let w=0;w<_.length;w++){const D=_[w],C=D.getAttribute("rel");if(C&&C.toLowerCase().indexOf("icon")>-1){const $=D.getAttribute("href");if($)if($.toLowerCase().indexOf("https:")===-1&&$.toLowerCase().indexOf("http:")===-1&&$.indexOf("//")!==0){let q=e.protocol+"//"+e.host;if($.indexOf("/")===0)q+=$;else{const E=e.pathname.split("/");E.pop();const I=E.join("/");q+=I+"/"+$}y.push(q)}else if($.indexOf("//")===0){const q=e.protocol+$;y.push(q)}else y.push($)}}return y}function i(..._){const y=t.getElementsByTagName("meta");for(let w=0;w<y.length;w++){const D=y[w],C=["itemprop","property","name"].map($=>D.getAttribute($)).filter($=>$?_.includes($):!1);if(C.length&&C){const $=D.getAttribute("content");if($)return $}}return""}function n(){let _=i("name","og:site_name","og:title","twitter:title");return _||(_=t.title),_}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),c=s(),h=e.origin,l=r();return{description:c,url:h,icons:l,name:a}}Wa=es.getWindowMetadata=Tp;var Zr={},Cp=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ka="%[a-f0-9]{2}",_o=new RegExp("("+ka+")|([^%]+?)","gi"),bo=new RegExp("("+ka+")+","gi");function Ln(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Ln(r),Ln(i))}function Np(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(_o)||[],r=1;r<e.length;r++)t=Ln(e,r).join(""),e=t.match(_o)||[];return t}}function Rp(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=bo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Np(r[0]);i!==r[0]&&(e[r[0]]=i)}r=bo.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var a=n[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var $p=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Rp(t)}},Lp=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Fp=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var a=i[s],c=t[a];(n?e.indexOf(a)!==-1:e(a,c,t))&&(r[a]=c)}return r};(function(t){const e=Cp,r=$p,i=Lp,n=Fp,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function c(E){switch(E.arrayFormat){case"index":return I=>(b,v)=>{const p=b.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?b:v===null?[...b,[f(I,E),"[",p,"]"].join("")]:[...b,[f(I,E),"[",f(p,E),"]=",f(v,E)].join("")]};case"bracket":return I=>(b,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?b:v===null?[...b,[f(I,E),"[]"].join("")]:[...b,[f(I,E),"[]=",f(v,E)].join("")];case"colon-list-separator":return I=>(b,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?b:v===null?[...b,[f(I,E),":list="].join("")]:[...b,[f(I,E),":list=",f(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const I=E.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(v,p)=>p===void 0||E.skipNull&&p===null||E.skipEmptyString&&p===""?v:(p=p===null?"":p,v.length===0?[[f(b,E),I,f(p,E)].join("")]:[[v,f(p,E)].join(E.arrayFormatSeparator)])}default:return I=>(b,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?b:v===null?[...b,f(I,E)]:[...b,[f(I,E),"=",f(v,E)].join("")]}}function h(E){let I;switch(E.arrayFormat){case"index":return(b,v,p)=>{if(I=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!I){p[b]=v;return}p[b]===void 0&&(p[b]={}),p[b][I[1]]=v};case"bracket":return(b,v,p)=>{if(I=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!I){p[b]=v;return}if(p[b]===void 0){p[b]=[v];return}p[b]=[].concat(p[b],v)};case"colon-list-separator":return(b,v,p)=>{if(I=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!I){p[b]=v;return}if(p[b]===void 0){p[b]=[v];return}p[b]=[].concat(p[b],v)};case"comma":case"separator":return(b,v,p)=>{const o=typeof v=="string"&&v.includes(E.arrayFormatSeparator),d=typeof v=="string"&&!o&&_(v,E).includes(E.arrayFormatSeparator);v=d?_(v,E):v;const R=o||d?v.split(E.arrayFormatSeparator).map(N=>_(N,E)):v===null?v:_(v,E);p[b]=R};case"bracket-separator":return(b,v,p)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){p[b]=v&&_(v,E);return}const d=v===null?[]:v.split(E.arrayFormatSeparator).map(R=>_(R,E));if(p[b]===void 0){p[b]=d;return}p[b]=[].concat(p[b],d)};default:return(b,v,p)=>{if(p[b]===void 0){p[b]=v;return}p[b]=[].concat(p[b],v)}}}function l(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(E,I){return I.encode?I.strict?e(E):encodeURIComponent(E):E}function _(E,I){return I.decode?r(E):E}function y(E){return Array.isArray(E)?E.sort():typeof E=="object"?y(Object.keys(E)).sort((I,b)=>Number(I)-Number(b)).map(I=>E[I]):E}function w(E){const I=E.indexOf("#");return I!==-1&&(E=E.slice(0,I)),E}function D(E){let I="";const b=E.indexOf("#");return b!==-1&&(I=E.slice(b)),I}function C(E){E=w(E);const I=E.indexOf("?");return I===-1?"":E.slice(I+1)}function $(E,I){return I.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):I.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function q(E,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),l(I.arrayFormatSeparator);const b=h(I),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const p of E.split("&")){if(p==="")continue;let[o,d]=i(I.decode?p.replace(/\+/g," "):p,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?d:_(d,I),b(_(o,I),d,v)}for(const p of Object.keys(v)){const o=v[p];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=$(o[d],I);else v[p]=$(o,I)}return I.sort===!1?v:(I.sort===!0?Object.keys(v).sort():Object.keys(v).sort(I.sort)).reduce((p,o)=>{const d=v[o];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?p[o]=y(d):p[o]=d,p},Object.create(null))}t.extract=C,t.parse=q,t.stringify=(E,I)=>{if(!E)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),l(I.arrayFormatSeparator);const b=d=>I.skipNull&&s(E[d])||I.skipEmptyString&&E[d]==="",v=c(I),p={};for(const d of Object.keys(E))b(d)||(p[d]=E[d]);const o=Object.keys(p);return I.sort!==!1&&o.sort(I.sort),o.map(d=>{const R=E[d];return R===void 0?"":R===null?f(d,I):Array.isArray(R)?R.length===0&&I.arrayFormat==="bracket-separator"?f(d,I)+"[]":R.reduce(v(d),[]).join("&"):f(d,I)+"="+f(R,I)}).filter(d=>d.length>0).join("&")},t.parseUrl=(E,I)=>{I=Object.assign({decode:!0},I);const[b,v]=i(E,"#");return Object.assign({url:b.split("?")[0]||"",query:q(C(E),I)},I&&I.parseFragmentIdentifier&&v?{fragmentIdentifier:_(v,I)}:{})},t.stringifyUrl=(E,I)=>{I=Object.assign({encode:!0,strict:!0,[a]:!0},I);const b=w(E.url).split("?")[0]||"",v=t.extract(E.url),p=t.parse(v,{sort:!1}),o=Object.assign(p,E.query);let d=t.stringify(o,I);d&&(d=`?${d}`);let R=D(E.url);return E.fragmentIdentifier&&(R=`#${I[a]?f(E.fragmentIdentifier,I):E.fragmentIdentifier}`),`${b}${d}${R}`},t.pick=(E,I,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[a]:!1},b);const{url:v,query:p,fragmentIdentifier:o}=t.parseUrl(E,b);return t.stringifyUrl({url:v,query:n(p,I),fragmentIdentifier:o},b)},t.exclude=(E,I,b)=>{const v=Array.isArray(I)?p=>!I.includes(p):(p,o)=>!I(p,o);return t.pick(E,v,b)}})(Zr);const Up={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Ga(t,e){return t.includes(":")?[t]:e.chains||[]}const Ya="base10",pt="base16",Fn="base64pad",ts="utf8",Ja=0,br=1,Mp=0,wo=1,Un=12,rs=32;function jp(){const t=Xn.generateKeyPair();return{privateKey:gt(t.secretKey,pt),publicKey:gt(t.publicKey,pt)}}function Mn(){const t=Pr.randomBytes(rs);return gt(t,pt)}function qp(t,e){const r=Xn.sharedKey(bt(t,pt),bt(e,pt)),i=new op(zi.SHA256,r).expand(rs);return gt(i,pt)}function Bp(t){const e=zi.hash(bt(t,pt));return gt(e,pt)}function Or(t){const e=zi.hash(bt(t,ts));return gt(e,pt)}function zp(t){return bt(`${t}`,Ya)}function ai(t){return Number(gt(t,Ya))}function Kp(t){const e=zp(typeof t.type<"u"?t.type:Ja);if(ai(e)===br&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?bt(t.senderPublicKey,pt):void 0,i=typeof t.iv<"u"?bt(t.iv,pt):Pr.randomBytes(Un),n=new Jn.ChaCha20Poly1305(bt(t.symKey,pt)).seal(i,bt(t.message,ts));return Vp({type:e,sealed:n,iv:i,senderPublicKey:r})}function Hp(t){const e=new Jn.ChaCha20Poly1305(bt(t.symKey,pt)),{sealed:r,iv:i}=Ti(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return gt(n,ts)}function Vp(t){if(ai(t.type)===br){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return gt(Rn([t.type,t.senderPublicKey,t.iv,t.sealed]),Fn)}return gt(Rn([t.type,t.iv,t.sealed]),Fn)}function Ti(t){const e=bt(t,Fn),r=e.slice(Mp,wo),i=wo;if(ai(r)===br){const c=i+rs,h=c+Un,l=e.slice(i,c),f=e.slice(c,h),_=e.slice(h);return{type:r,sealed:_,iv:f,senderPublicKey:l}}const n=i+Un,s=e.slice(i,n),a=e.slice(n);return{type:r,sealed:a,iv:s}}function Wp(t,e){const r=Ti(t);return Qa({type:ai(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?gt(r.senderPublicKey,pt):void 0,receiverPublicKey:e?.receiverPublicKey})}function Qa(t){const e=t?.type||Ja;if(e===br){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function mo(t){return t.type===br&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var kp=Object.defineProperty,vo=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,Yp=Object.prototype.propertyIsEnumerable,Eo=(t,e,r)=>e in t?kp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Do=(t,e)=>{for(var r in e||(e={}))Gp.call(e,r)&&Eo(t,r,e[r]);if(vo)for(var r of vo(e))Yp.call(e,r)&&Eo(t,r,e[r]);return t};const Jp="ReactNative",Et={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Qp="js";function is(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ki(){return!Ha()&&!!Zn()&&navigator.product===Jp}function ci(){return!is()&&!!Zn()}function ui(){return Ki()?Et.reactNative:is()?Et.node:ci()?Et.browser:Et.unknown}function Xp(t,e){let r=Zr.parse(t);return r=Do(Do({},r),e),t=Zr.stringify(r),t}function Zp(){return Wa()||{name:"",description:"",url:"",icons:[""]}}function eg(){if(ui()===Et.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=gp();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function tg(){var t;const e=ui();return e===Et.browser?[e,((t=Va())==null?void 0:t.host)||"unknown"].join(":"):e}function rg(t,e,r){const i=eg(),n=tg();return[[t,e].join("-"),[Qp,r].join("-"),i,n].join("/")}function ig({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a}){const c=r.split("?"),h=rg(t,e,i),l={auth:n,ua:h,projectId:s,useOnCloseEvent:a||void 0},f=Xp(c[1]||"",l);return c[0]+"?"+f}function pr(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Xa(t){return Object.fromEntries(t.entries())}function Za(t){return new Map(Object.entries(t))}function Dr(t=X.FIVE_MINUTES,e){const r=X.toMiliseconds(t||X.FIVE_MINUTES);let i,n,s;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,c)=>{s=setTimeout(()=>{c(new Error(e))},r),i=a,n=c})}}function ei(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function ec(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function ng(t){return ec("topic",t)}function sg(t){return ec("id",t)}function tc(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function At(t,e){return X.fromMiliseconds((e||Date.now())+X.toMiliseconds(t))}function Jt(t){return Date.now()>=X.toMiliseconds(t)}function Be(t,e){return`${t}${e?`:${e}`:""}`}async function og({id:t,topic:e,wcDeepLink:r}){try{if(!r)return;let n=(typeof r=="string"?JSON.parse(r):r)?.href;if(typeof n!="string")return;n.endsWith("/")&&(n=n.slice(0,-1));const s=`${n}/wc?requestId=${t}&sessionTopic=${e}`,a=ui();a===Et.browser?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):a===Et.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(s)}catch(i){console.error(i)}}const ag="irn";function jn(t){return t?.relay||{protocol:ag}}function Si(t){const e=Up[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var cg=Object.defineProperty,So=Object.getOwnPropertySymbols,ug=Object.prototype.hasOwnProperty,lg=Object.prototype.propertyIsEnumerable,Oo=(t,e,r)=>e in t?cg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hg=(t,e)=>{for(var r in e||(e={}))ug.call(e,r)&&Oo(t,r,e[r]);if(So)for(var r of So(e))lg.call(e,r)&&Oo(t,r,e[r]);return t};function fg(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function dg(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Zr.parse(s);return{protocol:i,topic:pg(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:fg(a)}}function pg(t){return t.startsWith("//")?t.substring(2):t}function gg(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function yg(t){return`${t.protocol}:${t.topic}@${t.version}?`+Zr.stringify(hg({symKey:t.symKey},gg(t.relay)))}function Tr(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function _g(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Tr(r.accounts))}),e}function bg(t,e){const r=[];return Object.values(t).forEach(i=>{Tr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function wg(t,e){const r=[];return Object.values(t).forEach(i=>{Tr(i.accounts).includes(e)&&r.push(...i.events)}),r}function mg(t,e){const r=Oi(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return i}const vg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Eg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function k(t,e){const{message:r,code:i}=Eg[t];return{message:e?`${r} ${e}`:r,code:i}}function Ze(t,e){const{message:r,code:i}=vg[t];return{message:e?`${r} ${e}`:r,code:i}}function li(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function kr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function dt(t){return typeof t>"u"}function et(t,e){return e&&dt(t)?!0:typeof t=="string"&&!!t.trim().length}function ns(t,e){return e&&dt(t)?!0:typeof t=="number"&&!isNaN(t)}function Dg(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return pr(n,i)?(i.forEach(a=>{const{accounts:c,methods:h,events:l}=t.namespaces[a],f=Tr(c),_=r[a];(!pr(Ga(a,_),f)||!pr(_.methods,h)||!pr(_.events,l))&&(s=!1)}),s):!1}function Ci(t){return et(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Sg(t){if(et(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Ci(r)}}return!1}function Og(t){if(et(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function xg(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Ig(t){return t?.topic}function Pg(t,e){let r=null;return et(t?.publicKey,!1)||(r=k("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function xo(t){let e=!0;return li(t)?t.length&&(e=t.every(r=>et(r,!1))):e=!1,e}function Ag(t,e,r){let i=null;return li(e)&&e.length?e.forEach(n=>{i||Ci(n)||(i=Ze("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):Ci(t)||(i=Ze("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Tg(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const a=Ag(n,Ga(n,s),`${e} ${r}`);a&&(i=a)}),i}function Cg(t,e){let r=null;return li(t)?t.forEach(i=>{r||Sg(i)||(r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Ng(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Cg(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function Rg(t,e){let r=null;return xo(t?.methods)?xo(t?.events)||(r=Ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function rc(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Rg(i,`${e}, namespace`);n&&(r=n)}),r}function $g(t,e,r){let i=null;if(t&&kr(t)){const n=rc(t,e);n&&(i=n);const s=Tg(t,e,r);s&&(i=s)}else i=k("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Oi(t,e){let r=null;if(t&&kr(t)){const i=rc(t,e);i&&(r=i);const n=Ng(t,e);n&&(r=n)}else r=k("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function ic(t){return et(t.protocol,!0)}function Lg(t,e){let r=!1;return e&&!t?r=!0:t&&li(t)&&t.length&&t.forEach(i=>{r=ic(i)}),r}function Fg(t){return typeof t=="number"}function _t(t){return typeof t<"u"&&typeof t!==null}function Ug(t){return!(!t||typeof t!="object"||!t.code||!ns(t.code,!1)||!t.message||!et(t.message,!1))}function Mg(t){return!(dt(t)||!et(t.method,!1))}function jg(t){return!(dt(t)||dt(t.result)&&dt(t.error)||!ns(t.id,!1)||!et(t.jsonrpc,!1))}function qg(t){return!(dt(t)||!et(t.name,!1))}function Io(t,e){return!(!Ci(e)||!_g(t).includes(e))}function Bg(t,e,r){return et(r,!1)?bg(t,e).includes(r):!1}function zg(t,e,r){return et(r,!1)?wg(t,e).includes(r):!1}function Po(t,e,r){let i=null;const n=Kg(t),s=Hg(e),a=Object.keys(n),c=Object.keys(s),h=Ao(Object.keys(t)),l=Ao(Object.keys(e)),f=h.filter(_=>!l.includes(_));return f.length&&(i=k("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),pr(a,c)||(i=k("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(_=>{if(!_.includes(":")||i)return;const y=Tr(e[_].accounts);y.includes(_)||(i=k("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${_}
        Required: ${_}
        Approved: ${y.toString()}`))}),a.forEach(_=>{i||(pr(n[_].methods,s[_].methods)?pr(n[_].events,s[_].events)||(i=k("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${_}`)):i=k("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${_}`))}),i}function Kg(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function Ao(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Hg(t){const e={};return Object.keys(t).forEach(r=>{r.includes(":")?e[r]=t[r]:Tr(t[r].accounts)?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}),e}function Vg(t,e){return ns(t,!1)&&t<=e.max&&t>=e.min}function To(){const t=ui();return new Promise(e=>{switch(t){case Et.browser:e(Wg());break;case Et.reactNative:e(kg());break;case Et.node:e(Gg());break;default:e(!0)}})}function Wg(){return ci()&&navigator?.onLine}async function kg(){return Ki()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function Gg(){return!0}function Yg(t){switch(ui()){case Et.browser:Jg(t);break;case Et.reactNative:Qg(t);break}}function Jg(t){ci()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function Qg(t){Ki()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const an={};let Ei=class{static get(e){return an[e]}static set(e,r){an[e]=r}static delete(e){delete an[e]}};const Xg="PARSE_ERROR",Zg="INVALID_REQUEST",ey="METHOD_NOT_FOUND",ty="INVALID_PARAMS",nc="INTERNAL_ERROR",ss="SERVER_ERROR",ry=[-32700,-32600,-32601,-32602,-32603],Gr={[Xg]:{code:-32700,message:"Parse error"},[Zg]:{code:-32600,message:"Invalid Request"},[ey]:{code:-32601,message:"Method not found"},[ty]:{code:-32602,message:"Invalid params"},[nc]:{code:-32603,message:"Internal error"},[ss]:{code:-32e3,message:"Server error"}},sc=ss;function iy(t){return ry.includes(t)}function Co(t){return Object.keys(Gr).includes(t)?Gr[t]:Gr[sc]}function ny(t){const e=Object.values(Gr).find(r=>r.code===t);return e||Gr[sc]}function sy(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var oc={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qn=function(t,e){return qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},qn(t,e)};function oy(t,e){qn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Bn=function(){return Bn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bn.apply(this,arguments)};function ay(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function cy(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function uy(t,e){return function(r,i){e(r,i,t)}}function ly(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function hy(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(_){a(_)}}function h(f){try{l(i.throw(f))}catch(_){a(_)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function fy(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function dy(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function py(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function zn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ac(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function gy(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ac(arguments[e]));return t}function yy(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function ti(t){return this instanceof ti?(this.v=t,this):new ti(t)}function _y(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(w){return new Promise(function(D,C){s.push([y,w,D,C])>1||c(y,w)})})}function c(y,w){try{h(i[y](w))}catch(D){_(s[0][3],D)}}function h(y){y.value instanceof ti?Promise.resolve(y.value.v).then(l,f):_(s[0][2],y)}function l(y){c("next",y)}function f(y){c("throw",y)}function _(y,w){y(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function by(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:ti(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function wy(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof zn=="function"?zn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function my(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function vy(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Ey(t){return t&&t.__esModule?t:{default:t}}function Dy(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Sy(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Oy=Object.freeze({__proto__:null,get __assign(){return Bn},__asyncDelegator:by,__asyncGenerator:_y,__asyncValues:wy,__await:ti,__awaiter:hy,__classPrivateFieldGet:Dy,__classPrivateFieldSet:Sy,__createBinding:dy,__decorate:cy,__exportStar:py,__extends:oy,__generator:fy,__importDefault:Ey,__importStar:vy,__makeTemplateObject:my,__metadata:ly,__param:uy,__read:ac,__rest:ay,__spread:gy,__spreadArrays:yy,__values:zn}),xy=er(Oy),qt={},No;function Iy(){if(No)return qt;No=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.isBrowserCryptoAvailable=qt.getSubtleCrypto=qt.getBrowerCrypto=void 0;function t(){return vt?.crypto||vt?.msCrypto||{}}qt.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}qt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return qt.isBrowserCryptoAvailable=r,qt}var Bt={},Ro;function Py(){if(Ro)return Bt;Ro=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.isBrowser=Bt.isNode=Bt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Bt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Bt.isNode=e;function r(){return!t()&&!e()}return Bt.isBrowser=r,Bt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=xy;e.__exportStar(Iy(),t),e.__exportStar(Py(),t)})(oc);function os(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function cc(t=6){return BigInt(os(t))}function ri(t,e,r){return{id:r||os(),jsonrpc:"2.0",method:t,params:e}}function as(t,e){return{id:t,jsonrpc:"2.0",result:e}}function cs(t,e,r){return{id:t,jsonrpc:"2.0",error:Ay(e,r)}}function Ay(t,e){return typeof t>"u"?Co(nc):(typeof t=="string"&&(t=Object.assign(Object.assign({},Co(ss)),{message:t})),typeof e<"u"&&(t.data=e),iy(t.code)&&(t=ny(t.code)),t)}class Ty{}class Cy extends Ty{constructor(){super()}}class Ny extends Cy{constructor(e){super()}}const Ry="^wss?:";function $y(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Ly(t,e){const r=$y(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function $o(t){return Ly(t,Ry)}function Fy(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function uc(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function us(t){return uc(t)&&"method"in t}function Hi(t){return uc(t)&&(Ht(t)||Tt(t))}function Ht(t){return"result"in t}function Tt(t){return"error"in t}class Uy extends Ny{constructor(e){super(e),this.events=new ae,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ri(e.method,e.params||[],e.id||cc().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Tt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Hi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const My=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),jy=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Lo=t=>t.split("?")[0],Fo=10,qy=My();class By{constructor(e){if(this.url=e,this.events=new ae,this.registering=!1,!$o(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(kn(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!$o(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=oc.isReactNative()?void 0:{rejectUnauthorized:!Fy(e)},s=new qy(e,[],n);jy()?s.onerror=a=>{const c=a;i(this.emitError(c.error))}:s.on("error",a=>{i(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Da(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=cs(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return sy(e,Lo(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Fo&&this.events.setMaxListeners(Fo)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Lo(this.url)}`));return this.events.emit("register_error",r),r}}var Ni={exports:{}};Ni.exports;(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,c="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",f="[object Boolean]",_="[object Date]",y="[object Error]",w="[object Function]",D="[object GeneratorFunction]",C="[object Map]",$="[object Number]",q="[object Null]",E="[object Object]",I="[object Promise]",b="[object Proxy]",v="[object RegExp]",p="[object Set]",o="[object String]",d="[object Symbol]",R="[object Undefined]",N="[object WeakMap]",L="[object ArrayBuffer]",K="[object DataView]",G="[object Float32Array]",S="[object Float64Array]",T="[object Int8Array]",W="[object Int16Array]",B="[object Int32Array]",U="[object Uint8Array]",j="[object Uint8ClampedArray]",F="[object Uint16Array]",z="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,H=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,J={};J[G]=J[S]=J[T]=J[W]=J[B]=J[U]=J[j]=J[F]=J[z]=!0,J[c]=J[h]=J[L]=J[f]=J[K]=J[_]=J[y]=J[w]=J[C]=J[$]=J[E]=J[v]=J[p]=J[o]=J[N]=!1;var ee=typeof vt=="object"&&vt&&vt.Object===Object&&vt,A=typeof self=="object"&&self&&self.Object===Object&&self,P=ee||A||Function("return this")(),O=e&&!e.nodeType&&e,u=O&&!0&&t&&!t.nodeType&&t,m=u&&u.exports===O,V=m&&ee.process,Y=function(){try{return V&&V.binding&&V.binding("util")}catch{}}(),fe=Y&&Y.isTypedArray;function be(g,x){for(var M=-1,Q=g==null?0:g.length,Ie=0,se=[];++M<Q;){var $e=g[M];x($e,M,g)&&(se[Ie++]=$e)}return se}function pe(g,x){for(var M=-1,Q=x.length,Ie=g.length;++M<Q;)g[Ie+M]=x[M];return g}function Ee(g,x){for(var M=-1,Q=g==null?0:g.length;++M<Q;)if(x(g[M],M,g))return!0;return!1}function Le(g,x){for(var M=-1,Q=Array(g);++M<g;)Q[M]=x(M);return Q}function Ce(g){return function(x){return g(x)}}function _e(g,x){return g.has(x)}function ge(g,x){return g?.[x]}function de(g){var x=-1,M=Array(g.size);return g.forEach(function(Q,Ie){M[++x]=[Ie,Q]}),M}function le(g,x){return function(M){return g(x(M))}}function ue(g){var x=-1,M=Array(g.size);return g.forEach(function(Q){M[++x]=Q}),M}var ce=Array.prototype,oe=Function.prototype,re=Object.prototype,he=P["__core-js_shared__"],ye=oe.toString,ie=re.hasOwnProperty,we=function(){var g=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),ve=re.toString,Se=RegExp("^"+ye.call(ie).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Oe=m?P.Buffer:void 0,De=P.Symbol,It=P.Uint8Array,Nt=re.propertyIsEnumerable,Vt=ce.splice,wt=De?De.toStringTag:void 0,rr=Object.getOwnPropertySymbols,Cr=Oe?Oe.isBuffer:void 0,fi=le(Object.keys,Object),Fe=wr(P,"DataView"),Ne=wr(P,"Map"),Ue=wr(P,"Promise"),Me=wr(P,"Set"),je=wr(P,"WeakMap"),Re=wr(Object,"create"),Ke=nr(Fe),He=nr(Ne),Ve=nr(Ue),We=nr(Me),ke=nr(je),ze=De?De.prototype:void 0,qe=ze?ze.valueOf:void 0;function Pe(g){var x=-1,M=g==null?0:g.length;for(this.clear();++x<M;){var Q=g[x];this.set(Q[0],Q[1])}}function Ge(){this.__data__=Re?Re(null):{},this.size=0}function Ye(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function Pc(g){var x=this.__data__;if(Re){var M=x[g];return M===i?void 0:M}return ie.call(x,g)?x[g]:void 0}function Ac(g){var x=this.__data__;return Re?x[g]!==void 0:ie.call(x,g)}function Tc(g,x){var M=this.__data__;return this.size+=this.has(g)?0:1,M[g]=Re&&x===void 0?i:x,this}Pe.prototype.clear=Ge,Pe.prototype.delete=Ye,Pe.prototype.get=Pc,Pe.prototype.has=Ac,Pe.prototype.set=Tc;function Mt(g){var x=-1,M=g==null?0:g.length;for(this.clear();++x<M;){var Q=g[x];this.set(Q[0],Q[1])}}function Cc(){this.__data__=[],this.size=0}function Nc(g){var x=this.__data__,M=pi(x,g);if(M<0)return!1;var Q=x.length-1;return M==Q?x.pop():Vt.call(x,M,1),--this.size,!0}function Rc(g){var x=this.__data__,M=pi(x,g);return M<0?void 0:x[M][1]}function $c(g){return pi(this.__data__,g)>-1}function Lc(g,x){var M=this.__data__,Q=pi(M,g);return Q<0?(++this.size,M.push([g,x])):M[Q][1]=x,this}Mt.prototype.clear=Cc,Mt.prototype.delete=Nc,Mt.prototype.get=Rc,Mt.prototype.has=$c,Mt.prototype.set=Lc;function ir(g){var x=-1,M=g==null?0:g.length;for(this.clear();++x<M;){var Q=g[x];this.set(Q[0],Q[1])}}function Fc(){this.size=0,this.__data__={hash:new Pe,map:new(Ne||Mt),string:new Pe}}function Uc(g){var x=gi(this,g).delete(g);return this.size-=x?1:0,x}function Mc(g){return gi(this,g).get(g)}function jc(g){return gi(this,g).has(g)}function qc(g,x){var M=gi(this,g),Q=M.size;return M.set(g,x),this.size+=M.size==Q?0:1,this}ir.prototype.clear=Fc,ir.prototype.delete=Uc,ir.prototype.get=Mc,ir.prototype.has=jc,ir.prototype.set=qc;function di(g){var x=-1,M=g==null?0:g.length;for(this.__data__=new ir;++x<M;)this.add(g[x])}function Bc(g){return this.__data__.set(g,i),this}function zc(g){return this.__data__.has(g)}di.prototype.add=di.prototype.push=Bc,di.prototype.has=zc;function Wt(g){var x=this.__data__=new Mt(g);this.size=x.size}function Kc(){this.__data__=new Mt,this.size=0}function Hc(g){var x=this.__data__,M=x.delete(g);return this.size=x.size,M}function Vc(g){return this.__data__.get(g)}function Wc(g){return this.__data__.has(g)}function kc(g,x){var M=this.__data__;if(M instanceof Mt){var Q=M.__data__;if(!Ne||Q.length<r-1)return Q.push([g,x]),this.size=++M.size,this;M=this.__data__=new ir(Q)}return M.set(g,x),this.size=M.size,this}Wt.prototype.clear=Kc,Wt.prototype.delete=Hc,Wt.prototype.get=Vc,Wt.prototype.has=Wc,Wt.prototype.set=kc;function Gc(g,x){var M=yi(g),Q=!M&&uu(g),Ie=!M&&!Q&&ki(g),se=!M&&!Q&&!Ie&&Ds(g),$e=M||Q||Ie||se,Je=$e?Le(g.length,String):[],tt=Je.length;for(var Te in g)(x||ie.call(g,Te))&&!($e&&(Te=="length"||Ie&&(Te=="offset"||Te=="parent")||se&&(Te=="buffer"||Te=="byteLength"||Te=="byteOffset")||nu(Te,tt)))&&Je.push(Te);return Je}function pi(g,x){for(var M=g.length;M--;)if(ws(g[M][0],x))return M;return-1}function Yc(g,x,M){var Q=x(g);return yi(g)?Q:pe(Q,M(g))}function Nr(g){return g==null?g===void 0?R:q:wt&&wt in Object(g)?ru(g):cu(g)}function gs(g){return Rr(g)&&Nr(g)==c}function ys(g,x,M,Q,Ie){return g===x?!0:g==null||x==null||!Rr(g)&&!Rr(x)?g!==g&&x!==x:Jc(g,x,M,Q,ys,Ie)}function Jc(g,x,M,Q,Ie,se){var $e=yi(g),Je=yi(x),tt=$e?h:kt(g),Te=Je?h:kt(x);tt=tt==c?E:tt,Te=Te==c?E:Te;var mt=tt==E,Pt=Te==E,nt=tt==Te;if(nt&&ki(g)){if(!ki(x))return!1;$e=!0,mt=!1}if(nt&&!mt)return se||(se=new Wt),$e||Ds(g)?_s(g,x,M,Q,Ie,se):eu(g,x,tt,M,Q,Ie,se);if(!(M&n)){var St=mt&&ie.call(g,"__wrapped__"),Ot=Pt&&ie.call(x,"__wrapped__");if(St||Ot){var Gt=St?g.value():g,jt=Ot?x.value():x;return se||(se=new Wt),Ie(Gt,jt,M,Q,se)}}return nt?(se||(se=new Wt),tu(g,x,M,Q,Ie,se)):!1}function Qc(g){if(!Es(g)||ou(g))return!1;var x=ms(g)?Se:H;return x.test(nr(g))}function Xc(g){return Rr(g)&&vs(g.length)&&!!J[Nr(g)]}function Zc(g){if(!au(g))return fi(g);var x=[];for(var M in Object(g))ie.call(g,M)&&M!="constructor"&&x.push(M);return x}function _s(g,x,M,Q,Ie,se){var $e=M&n,Je=g.length,tt=x.length;if(Je!=tt&&!($e&&tt>Je))return!1;var Te=se.get(g);if(Te&&se.get(x))return Te==x;var mt=-1,Pt=!0,nt=M&s?new di:void 0;for(se.set(g,x),se.set(x,g);++mt<Je;){var St=g[mt],Ot=x[mt];if(Q)var Gt=$e?Q(Ot,St,mt,x,g,se):Q(St,Ot,mt,g,x,se);if(Gt!==void 0){if(Gt)continue;Pt=!1;break}if(nt){if(!Ee(x,function(jt,sr){if(!_e(nt,sr)&&(St===jt||Ie(St,jt,M,Q,se)))return nt.push(sr)})){Pt=!1;break}}else if(!(St===Ot||Ie(St,Ot,M,Q,se))){Pt=!1;break}}return se.delete(g),se.delete(x),Pt}function eu(g,x,M,Q,Ie,se,$e){switch(M){case K:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case L:return!(g.byteLength!=x.byteLength||!se(new It(g),new It(x)));case f:case _:case $:return ws(+g,+x);case y:return g.name==x.name&&g.message==x.message;case v:case o:return g==x+"";case C:var Je=de;case p:var tt=Q&n;if(Je||(Je=ue),g.size!=x.size&&!tt)return!1;var Te=$e.get(g);if(Te)return Te==x;Q|=s,$e.set(g,x);var mt=_s(Je(g),Je(x),Q,Ie,se,$e);return $e.delete(g),mt;case d:if(qe)return qe.call(g)==qe.call(x)}return!1}function tu(g,x,M,Q,Ie,se){var $e=M&n,Je=bs(g),tt=Je.length,Te=bs(x),mt=Te.length;if(tt!=mt&&!$e)return!1;for(var Pt=tt;Pt--;){var nt=Je[Pt];if(!($e?nt in x:ie.call(x,nt)))return!1}var St=se.get(g);if(St&&se.get(x))return St==x;var Ot=!0;se.set(g,x),se.set(x,g);for(var Gt=$e;++Pt<tt;){nt=Je[Pt];var jt=g[nt],sr=x[nt];if(Q)var Ss=$e?Q(sr,jt,nt,x,g,se):Q(jt,sr,nt,g,x,se);if(!(Ss===void 0?jt===sr||Ie(jt,sr,M,Q,se):Ss)){Ot=!1;break}Gt||(Gt=nt=="constructor")}if(Ot&&!Gt){var _i=g.constructor,bi=x.constructor;_i!=bi&&"constructor"in g&&"constructor"in x&&!(typeof _i=="function"&&_i instanceof _i&&typeof bi=="function"&&bi instanceof bi)&&(Ot=!1)}return se.delete(g),se.delete(x),Ot}function bs(g){return Yc(g,fu,iu)}function gi(g,x){var M=g.__data__;return su(x)?M[typeof x=="string"?"string":"hash"]:M.map}function wr(g,x){var M=ge(g,x);return Qc(M)?M:void 0}function ru(g){var x=ie.call(g,wt),M=g[wt];try{g[wt]=void 0;var Q=!0}catch{}var Ie=ve.call(g);return Q&&(x?g[wt]=M:delete g[wt]),Ie}var iu=rr?function(g){return g==null?[]:(g=Object(g),be(rr(g),function(x){return Nt.call(g,x)}))}:du,kt=Nr;(Fe&&kt(new Fe(new ArrayBuffer(1)))!=K||Ne&&kt(new Ne)!=C||Ue&&kt(Ue.resolve())!=I||Me&&kt(new Me)!=p||je&&kt(new je)!=N)&&(kt=function(g){var x=Nr(g),M=x==E?g.constructor:void 0,Q=M?nr(M):"";if(Q)switch(Q){case Ke:return K;case He:return C;case Ve:return I;case We:return p;case ke:return N}return x});function nu(g,x){return x=x??a,!!x&&(typeof g=="number"||Z.test(g))&&g>-1&&g%1==0&&g<x}function su(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function ou(g){return!!we&&we in g}function au(g){var x=g&&g.constructor,M=typeof x=="function"&&x.prototype||re;return g===M}function cu(g){return ve.call(g)}function nr(g){if(g!=null){try{return ye.call(g)}catch{}try{return g+""}catch{}}return""}function ws(g,x){return g===x||g!==g&&x!==x}var uu=gs(function(){return arguments}())?gs:function(g){return Rr(g)&&ie.call(g,"callee")&&!Nt.call(g,"callee")},yi=Array.isArray;function lu(g){return g!=null&&vs(g.length)&&!ms(g)}var ki=Cr||pu;function hu(g,x){return ys(g,x)}function ms(g){if(!Es(g))return!1;var x=Nr(g);return x==w||x==D||x==l||x==b}function vs(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=a}function Es(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Rr(g){return g!=null&&typeof g=="object"}var Ds=fe?Ce(fe):Xc;function fu(g){return lu(g)?Gc(g):Zc(g)}function du(){return[]}function pu(){return!1}t.exports=hu})(Ni,Ni.exports);var zy=Ni.exports,Ky=ku(zy);function Hy(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var C=0,$=0,q=0,E=D.length;q!==E&&D[q]===0;)q++,C++;for(var I=(E-q)*f+1>>>0,b=new Uint8Array(I);q!==E;){for(var v=D[q],p=0,o=I-1;(v!==0||p<$)&&o!==-1;o--,p++)v+=256*b[o]>>>0,b[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");$=p,q++}for(var d=I-$;d!==I&&b[d]===0;)d++;for(var R=h.repeat(C);d<I;++d)R+=t.charAt(b[d]);return R}function y(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var C=0;if(D[C]!==" "){for(var $=0,q=0;D[C]===h;)$++,C++;for(var E=(D.length-C)*l+1>>>0,I=new Uint8Array(E);D[C];){var b=r[D.charCodeAt(C)];if(b===255)return;for(var v=0,p=E-1;(b!==0||v<q)&&p!==-1;p--,v++)b+=c*I[p]>>>0,I[p]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");q=v,C++}if(D[C]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var d=new Uint8Array($+(E-o)),R=$;o!==E;)d[R++]=I[o++];return d}}}function w(D){var C=y(D);if(C)return C;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:y,decode:w}}var Vy=Hy,Wy=Vy;const lc=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ky=t=>new TextEncoder().encode(t),Gy=t=>new TextDecoder().decode(t);class Yy{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Jy{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hc(this,e)}}class Qy{constructor(e){this.decoders=e}or(e){return hc(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hc=(t,e)=>new Qy({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Xy{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Yy(e,r,i),this.decoder=new Jy(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Vi=({name:t,prefix:e,encode:r,decode:i})=>new Xy(t,e,r,i),hi=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Wy(r,e);return Vi({prefix:t,name:e,encode:i,decode:s=>lc(n(s))})},Zy=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|_,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},e0=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},it=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Vi({prefix:e,name:t,encode(n){return e0(n,i,r)},decode(n){return Zy(n,i,r,t)}}),t0=Vi({prefix:"\0",name:"identity",encode:t=>Gy(t),decode:t=>ky(t)});var r0=Object.freeze({__proto__:null,identity:t0});const i0=it({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var n0=Object.freeze({__proto__:null,base2:i0});const s0=it({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var o0=Object.freeze({__proto__:null,base8:s0});const a0=hi({prefix:"9",name:"base10",alphabet:"0123456789"});var c0=Object.freeze({__proto__:null,base10:a0});const u0=it({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),l0=it({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var h0=Object.freeze({__proto__:null,base16:u0,base16upper:l0});const f0=it({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),d0=it({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),p0=it({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),g0=it({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),y0=it({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_0=it({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),b0=it({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w0=it({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),m0=it({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var v0=Object.freeze({__proto__:null,base32:f0,base32upper:d0,base32pad:p0,base32padupper:g0,base32hex:y0,base32hexupper:_0,base32hexpad:b0,base32hexpadupper:w0,base32z:m0});const E0=hi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),D0=hi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var S0=Object.freeze({__proto__:null,base36:E0,base36upper:D0});const O0=hi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),x0=hi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var I0=Object.freeze({__proto__:null,base58btc:O0,base58flickr:x0});const P0=it({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),A0=it({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),T0=it({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),C0=it({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var N0=Object.freeze({__proto__:null,base64:P0,base64pad:A0,base64url:T0,base64urlpad:C0});const fc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),R0=fc.reduce((t,e,r)=>(t[r]=e,t),[]),$0=fc.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function L0(t){return t.reduce((e,r)=>(e+=R0[r],e),"")}function F0(t){const e=[];for(const r of t){const i=$0[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const U0=Vi({prefix:"\u{1F680}",name:"base256emoji",encode:L0,decode:F0});var M0=Object.freeze({__proto__:null,base256emoji:U0}),j0=dc,Uo=128,q0=127,B0=~q0,z0=Math.pow(2,31);function dc(t,e,r){e=e||[],r=r||0;for(var i=r;t>=z0;)e[r++]=t&255|Uo,t/=128;for(;t&B0;)e[r++]=t&255|Uo,t>>>=7;return e[r]=t|0,dc.bytes=r-i+1,e}var K0=Kn,H0=128,Mo=127;function Kn(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw Kn.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&Mo)<<n:(a&Mo)*Math.pow(2,n),n+=7}while(a>=H0);return Kn.bytes=s-i,r}var V0=Math.pow(2,7),W0=Math.pow(2,14),k0=Math.pow(2,21),G0=Math.pow(2,28),Y0=Math.pow(2,35),J0=Math.pow(2,42),Q0=Math.pow(2,49),X0=Math.pow(2,56),Z0=Math.pow(2,63),e_=function(t){return t<V0?1:t<W0?2:t<k0?3:t<G0?4:t<Y0?5:t<J0?6:t<Q0?7:t<X0?8:t<Z0?9:10},t_={encode:j0,decode:K0,encodingLength:e_},pc=t_;const jo=(t,e,r=0)=>(pc.encode(t,e,r),e),qo=t=>pc.encodingLength(t),Hn=(t,e)=>{const r=e.byteLength,i=qo(t),n=i+qo(r),s=new Uint8Array(n+r);return jo(t,s,0),jo(r,s,i),s.set(e,n),new r_(t,r,e,s)};class r_{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const gc=({name:t,code:e,encode:r})=>new i_(t,e,r);class i_{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Hn(this.code,r):r.then(i=>Hn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const yc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),n_=gc({name:"sha2-256",code:18,encode:yc("SHA-256")}),s_=gc({name:"sha2-512",code:19,encode:yc("SHA-512")});var o_=Object.freeze({__proto__:null,sha256:n_,sha512:s_});const _c=0,a_="identity",bc=lc,c_=t=>Hn(_c,bc(t)),u_={code:_c,name:a_,encode:bc,digest:c_};var l_=Object.freeze({__proto__:null,identity:u_});new TextEncoder,new TextDecoder;const Bo={...r0,...n0,...o0,...c0,...h0,...v0,...S0,...I0,...N0,...M0};({...o_,...l_});function wc(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function h_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?wc(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function mc(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const zo=mc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),cn=mc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=h_(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),f_={utf8:zo,"utf-8":zo,hex:Bo.base16,latin1:cn,ascii:cn,binary:cn,...Bo};function d_(t,e="utf8"){const r=f_[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wc(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const vc="wc",p_=2,ls="core",Xt=`${vc}@2:${ls}:`,g_={name:ls,logger:"error"},y_={database:":memory:"},__="crypto",Ko="client_ed25519_seed",b_=X.ONE_DAY,w_="keychain",m_="0.3",v_="messages",E_="0.3",D_=X.SIX_HOURS,S_="publisher",Ec="irn",O_="error",Dc="wss://relay.walletconnect.com",Ho="wss://relay.walletconnect.org",x_="relayer",lt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},I_="_subscription",zt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},P_=X.ONE_SECOND,A_="2.10.0",T_=1e4,C_="0.3",N_="WALLETCONNECT_CLIENT_ID",Ut={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},R_="subscription",$_="0.3",L_=X.FIVE_SECONDS*1e3,F_="pairing",U_="0.3",zr={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},Ft={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},M_="history",j_="0.3",q_="expirer",xt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},B_="0.3",un="verify-api",xi="https://verify.walletconnect.com",Vo="https://verify.walletconnect.org";class z_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=w_,this.version=m_,this.initialized=!1,this.storagePrefix=Xt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=k("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=me.generateChildLogger(r,this.name)}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Xa(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Za(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class K_{constructor(e,r,i){this.core=e,this.logger=r,this.name=__,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=co(n);return Ma(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=jp();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=co(s),c=Mn();return await kd(c,n,b_,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const c=this.getPrivateKey(n),h=qp(c,s);return this.setSymKey(h,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||Bp(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const c=Qa(a),h=kn(s);if(mo(c)){const y=c.senderPublicKey,w=c.receiverPublicKey;n=await this.generateSharedKey(y,w)}const l=this.getSymKey(n),{type:f,senderPublicKey:_}=c;return Kp({type:f,symKey:l,message:h,senderPublicKey:_})},this.decode=async(n,s,a)=>{this.isInitialized();const c=Wp(s,a);if(mo(c)){const h=c.receiverPublicKey,l=c.senderPublicKey;n=await this.generateSharedKey(h,l)}try{const h=this.getSymKey(n),l=Hp({symKey:h,encoded:s});return Da(l)}catch(h){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}},this.getPayloadType=n=>{const s=Ti(n);return ai(s.type)},this.getPayloadSenderPublicKey=n=>{const s=Ti(n);return s.senderPublicKey?gt(s.senderPublicKey,pt):void 0},this.core=e,this.logger=me.generateChildLogger(r,this.name),this.keychain=i||new z_(this.core,this.logger)}get context(){return me.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ko)}catch{e=Mn(),await this.keychain.set(Ko,e)}return d_(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class H_ extends Yh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=v_,this.version=E_,this.initialized=!1,this.storagePrefix=Xt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=Or(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=Or(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=me.generateChildLogger(e,this.name),this.core=r}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Xa(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Za(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class V_ extends Jh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ae,this.name=S_,this.queue=new Map,this.publishTimeout=X.toMiliseconds(X.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{var a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const c=s?.ttl||D_,h=jn(s),l=s?.prompt||!1,f=s?.tag||0,_=s?.id||cc().toString(),y={topic:i,message:n,opts:{ttl:c,relay:h,prompt:l,tag:f,id:_}},w=setTimeout(()=>this.queue.set(_,y),this.publishTimeout);try{await await ei(this.rpcPublish(i,n,c,h,l,f,_),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(_),this.relayer.events.emit(lt.publish,y)}catch(D){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(a=s?.internal)!=null&&a.throwOnFailedPublish)throw this.removeRequestFromQueue(_),D;return}finally{clearTimeout(w)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=me.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return me.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,a,c){var h,l,f,_;const y={method:Si(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:a},id:c};return dt((h=y.params)==null?void 0:h.prompt)&&((l=y.params)==null||delete l.prompt),dt((f=y.params)==null?void 0:f.tag)&&((_=y.params)==null||delete _.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:y}),this.relayer.request(y)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ir.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(lt.connection_stalled);return}this.checkQueue()}),this.relayer.on(lt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class W_{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var k_=Object.defineProperty,G_=Object.defineProperties,Y_=Object.getOwnPropertyDescriptors,Wo=Object.getOwnPropertySymbols,J_=Object.prototype.hasOwnProperty,Q_=Object.prototype.propertyIsEnumerable,ko=(t,e,r)=>e in t?k_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kr=(t,e)=>{for(var r in e||(e={}))J_.call(e,r)&&ko(t,r,e[r]);if(Wo)for(var r of Wo(e))Q_.call(e,r)&&ko(t,r,e[r]);return t},ln=(t,e)=>G_(t,Y_(e));class X_ extends Zh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new W_,this.events=new ae,this.name=R_,this.version=$_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Xt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=jn(n),a={topic:i,relay:s};this.pending.set(i,a);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const a=new X.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),n(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=L_&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=me.generateChildLogger(r,this.name),this.clientId=""}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=jn(i);await this.rpcUnsubscribe(e,r,n);const s=Ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:Si(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await ei(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(lt.connection_stalled)}return Or(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Si(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await ei(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(lt.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:Si(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,ln(Kr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Kr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Kr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ut.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ut.deleted,ln(Kr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ut.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Ut.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);li(r)&&this.onBatchSubscribe(r.map((i,n)=>ln(Kr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Ir.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(lt.connect,async()=>{await this.onConnect()}),this.relayer.on(lt.disconnect,()=>{this.onDisconnect()}),this.events.on(Ut.created,async e=>{const r=Ut.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ut.deleted,async e=>{const r=Ut.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var Z_=Object.defineProperty,Go=Object.getOwnPropertySymbols,e1=Object.prototype.hasOwnProperty,t1=Object.prototype.propertyIsEnumerable,Yo=(t,e,r)=>e in t?Z_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,r1=(t,e)=>{for(var r in e||(e={}))e1.call(e,r)&&Yo(t,r,e[r]);if(Go)for(var r of Go(e))t1.call(e,r)&&Yo(t,r,e[r]);return t};class i1 extends Qh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ae,this.name=x_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(lt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(lt.error,r)},this.registerProviderListeners=()=>{this.provider.on(zt.payload,this.onPayloadHandler),this.provider.on(zt.connect,this.onConnectHandler),this.provider.on(zt.disconnect,this.onDisconnectHandler),this.provider.on(zt.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?me.generateChildLogger(e.logger,this.name):me.pino(me.getDefaultLoggerOptions({level:e.logger||O_})),this.messages=new H_(this.logger,e.core),this.subscriber=new X_(this,this.logger),this.publisher=new V_(this,this.logger),this.relayUrl=e?.relayUrl||Dc,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ho}...`),await this.restartTransport(Ho)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},T_)}get context(){return me.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var i;this.isInitialized();let n=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";return n||(await Promise.all([new Promise(s=>{this.subscriber.once(Ut.created,a=>{a.topic===e&&s()})}),new Promise(async s=>{n=await this.subscriber.subscribe(e,r),s()})]),n)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ei(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Ut.resubscribed,()=>{r()})}),new Promise(async(r,i)=>{try{await ei(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(n){i(n);return}r()})])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.provider.events.emit(zt.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await To())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Uy(new By(ig({sdkVersion:A_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.debug(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),us(e)){if(!e.method.endsWith(I_))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,a={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(r1({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Hi(e)&&this.events.emit(lt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(lt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=as(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(zt.payload,this.onPayloadHandler),this.provider.off(zt.connect,this.onConnectHandler),this.provider.off(zt.disconnect,this.onDisconnectHandler),this.provider.off(zt.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(lt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await To();Yg(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(lt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},X.toMiliseconds(P_)))}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var n1=Object.defineProperty,Jo=Object.getOwnPropertySymbols,s1=Object.prototype.hasOwnProperty,o1=Object.prototype.propertyIsEnumerable,Qo=(t,e,r)=>e in t?n1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xo=(t,e)=>{for(var r in e||(e={}))s1.call(e,r)&&Qo(t,r,e[r]);if(Jo)for(var r of Jo(e))o1.call(e,r)&&Qo(t,r,e[r]);return t};class Wi extends Xh{constructor(e,r,i,n=Xt,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=C_,this.cached=[],this.initialized=!1,this.storagePrefix=Xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!dt(a)?this.map.set(this.getKey(a),a):xg(a)?this.map.set(a.id,a):Ig(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(h=>Ky(c[h],a[h]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const h=Xo(Xo({},this.getData(a)),c);this.map.set(a,h),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=me.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class a1{constructor(e,r){this.core=e,this.logger=r,this.name=F_,this.version=U_,this.events=new ae,this.initialized=!1,this.storagePrefix=Xt,this.ignoredPayloadTypes=[br],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Mn(),n=await this.core.crypto.setSymKey(i),s=At(X.FIVE_MINUTES),a={protocol:Ec},c={topic:n,expiry:s,relay:a,active:!1},h=yg({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:a}=dg(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const c=At(X.FIVE_MINUTES),h={topic:n,relay:a,expiry:c,active:!1};return await this.pairings.set(n,h),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:a}),this.core.expirer.set(n,c),i.activatePairing&&await this.activate({topic:n}),h},this.activate=async({topic:i})=>{this.isInitialized();const n=At(X.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:c,reject:h}=Dr();this.events.once(Be("pairing_ping",s),({error:l})=>{l?h(l):c()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ze("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const a=ri(n,s),c=await this.core.crypto.encode(i,a),h=zr[n].req;return this.core.history.set(i,a),this.core.relayer.publish(i,c,h),a.id},this.sendResult=async(i,n,s)=>{const a=as(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=zr[h.request.method].res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=cs(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=zr[h.request.method]?zr[h.request.method].res:zr.unregistered_method.res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Jt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Ht(n)?this.events.emit(Be("pairing_ping",s),{}):Tt(n)&&this.events.emit(Be("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const c=Ze("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!_t(i)){const{message:n}=k("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Og(i.uri)){const{message:n}=k("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!_t(i)){const{message:s}=k("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!_t(i)){const{message:s}=k("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!et(i,!1)){const{message:n}=k("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=k("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Jt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=k("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=me.generateChildLogger(r,this.name),this.pairings=new Wi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return me.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(lt.message,async e=>{const{topic:r,message:i}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);try{us(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Hi(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.core.history.delete(r,n.id))}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(xt.expired,async e=>{const{topic:r}=tc(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class c1 extends Gh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ae,this.name=M_,this.version=j_,this.cached=[],this.initialized=!1,this.storagePrefix=Xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:At(X.THIRTY_DAYS)};this.records.set(a.id,a),this.events.emit(Ft.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Tt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Ft.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Ft.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=me.generateChildLogger(r,this.name)}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:ri(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ft.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ft.created,e=>{const r=Ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ft.updated,e=>{const r=Ft.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ft.deleted,e=>{const r=Ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Ir.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{X.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class u1 extends ef{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ae,this.name=q_,this.version=B_,this.cached=[],this.initialized=!1,this.storagePrefix=Xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(xt.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(xt.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=me.generateChildLogger(r,this.name)}get context(){return me.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return ng(e);if(typeof e=="number")return sg(e);const{message:r}=k("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(xt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;X.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(xt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Ir.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(xt.created,e=>{const r=xt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(xt.expired,e=>{const r=xt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(xt.deleted,e=>{const r=xt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}}class l1 extends tf{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=un,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||Ki()||!ci())return;const n=i?.verifyUrl||xi;this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(s){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(s)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Vo;try{await this.createIframe()}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{if(this.isDevEnv)return"";const n=i?.verifyUrl||xi;let s="";try{s=await this.fetchAttestation(i.attestationId,n)}catch(a){this.logger.warn(`failed to resolve attestation: ${i.attestationId} from url: ${n}`),this.logger.warn(a),s=await this.fetchAttestation(i.attestationId,Vo)}return s},this.fetchAttestation=async(i,n)=>{var s;this.logger.info(`resolving attestation: ${i} from url: ${n}`);const a=this.startAbortTimer(X.ONE_SECOND*2),c=await fetch(`${n}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(a),c.status===200?(s=await c.json())==null?void 0:s.origin:""},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var n;try{if(!this.iframe)return;(n=this.iframe.contentWindow)==null||n.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;const n=s=>{s.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",n),i())};await Promise.race([new Promise(s=>{if(document.getElementById(un))return s();window.addEventListener("message",n);const a=document.createElement("iframe");a.id=un,a.src=`${this.verifyUrl}/${this.projectId}`,a.style.display="none",document.body.append(a),this.iframe=a,i=s}),new Promise((s,a)=>setTimeout(()=>{window.removeEventListener("message",n),a("verify iframe load timeout")},X.toMiliseconds(X.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=me.generateChildLogger(r,this.name),this.verifyUrl=xi,this.abortController=new AbortController,this.isDevEnv=is()&&process.env.IS_VITEST}get context(){return me.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}}var h1=Object.defineProperty,Zo=Object.getOwnPropertySymbols,f1=Object.prototype.hasOwnProperty,d1=Object.prototype.propertyIsEnumerable,ea=(t,e,r)=>e in t?h1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ta=(t,e)=>{for(var r in e||(e={}))f1.call(e,r)&&ea(t,r,e[r]);if(Zo)for(var r of Zo(e))d1.call(e,r)&&ea(t,r,e[r]);return t};class hs extends kh{constructor(e){super(e),this.protocol=vc,this.version=p_,this.name=ls,this.events=new ae,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Dc;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:me.pino(me.getDefaultLoggerOptions({level:e?.logger||g_.logger}));this.logger=me.generateChildLogger(r,this.name),this.heartbeat=new Ir.HeartBeat,this.crypto=new K_(this,this.logger,e?.keychain),this.history=new c1(this,this.logger),this.expirer=new u1(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new El(ta(ta({},y_),e?.storageOptions)),this.relayer=new i1({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new a1(this,this.logger),this.verify=new l1(this.projectId||"",this.logger)}static async init(e){const r=new hs(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(N_,i),r}get context(){return me.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const p1=hs,Sc="wc",Oc=2,xc="client",fs=`${Sc}@${Oc}:${xc}:`,hn={name:xc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ra="WALLETCONNECT_DEEPLINK_CHOICE",g1="proposal",y1="Proposal expired",_1="session",Di=X.SEVEN_DAYS,b1="engine",Hr={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1115}}},fn={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},Kt={idle:"IDLE",active:"ACTIVE"},w1="request",m1=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var v1=Object.defineProperty,E1=Object.defineProperties,D1=Object.getOwnPropertyDescriptors,ia=Object.getOwnPropertySymbols,S1=Object.prototype.hasOwnProperty,O1=Object.prototype.propertyIsEnumerable,na=(t,e,r)=>e in t?v1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yt=(t,e)=>{for(var r in e||(e={}))S1.call(e,r)&&na(t,r,e[r]);if(ia)for(var r of ia(e))O1.call(e,r)&&na(t,r,e[r]);return t},Vr=(t,e)=>E1(t,D1(e));class x1 extends nf{constructor(e){super(e),this.name=b1,this.events=new ae,this.initialized=!1,this.ignoredPayloadTypes=[br],this.requestQueue={state:Kt.idle,queue:[]},this.sessionRequestQueue={state:Kt.idle,queue:[]},this.requestQueueDelay=X.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Hr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const i=Vr(yt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:h}=i;let l=n,f,_=!1;if(l&&(_=this.client.core.pairing.pairings.get(l).active),!l||!_){const{topic:I,uri:b}=await this.client.core.pairing.create();l=I,f=b}const y=await this.client.core.crypto.generateKeyPair(),w=yt({requiredNamespaces:s,optionalNamespaces:a,relays:h??[{protocol:Ec}],proposer:{publicKey:y,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:D,resolve:C,done:$}=Dr(X.FIVE_MINUTES,y1);if(this.events.once(Be("session_connect"),async({error:I,session:b})=>{if(I)D(I);else if(b){b.self.publicKey=y;const v=Vr(yt({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces});await this.client.session.set(b.topic,v),await this.setExpiry(b.topic,b.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:b.peer.metadata}),C(v)}}),!l){const{message:I}=k("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(I)}const q=await this.sendRequest({topic:l,method:"wc_sessionPropose",params:w}),E=At(X.FIVE_MINUTES);return await this.setProposal(q,yt({id:q,expiry:E},w)),{uri:f,approval:$}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(i);let{pairingTopic:h,proposer:l,requiredNamespaces:f,optionalNamespaces:_}=c;h=h||"",kr(f)||(f=mg(s,"approve()"));const y=await this.client.core.crypto.generateKeyPair(),w=l.publicKey,D=await this.client.core.crypto.generateSharedKey(y,w);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:l.metadata}),await this.sendResult({id:i,topic:h,result:{relay:{protocol:n??"irn"},responderPublicKey:y}}),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const C=yt({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:_,pairingTopic:h,controller:{publicKey:y,metadata:this.client.metadata},expiry:At(Di)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(D),await this.sendRequest({topic:D,method:"wc_sessionSettle",params:C,throwOnFailedPublish:!0});const $=Vr(yt({},C),{topic:D,pairingTopic:h,acknowledged:!1,self:C.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:y});return await this.client.session.set(D,$),await this.setExpiry(D,At(Di)),{topic:D,acknowledged:()=>new Promise(q=>setTimeout(()=>q(this.client.session.get(D)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n}}),{done:a,resolve:c,reject:h}=Dr();return this.events.once(Be("session_update",s),({error:l})=>{l?h(l):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:a}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:s,resolve:a,reject:c}=Dr();return this.events.once(Be("session_extend",n),({error:h})=>{h?c(h):a()}),await this.setExpiry(i,At(Di)),{acknowledged:s}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:a}=r,c=os(),{done:h,resolve:l,reject:f}=Dr(a);return this.events.once(Be("session_request",c),({error:_,result:y})=>{_?f(_):l(y)}),await Promise.all([new Promise(async _=>{await this.sendRequest({clientRpcId:c,topic:s,method:"wc_sessionRequest",params:{request:n,chainId:i},expiry:a,throwOnFailedPublish:!0}).catch(y=>f(y)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),_()}),new Promise(async _=>{const y=await this.client.core.storage.getItem(ra);og({id:c,topic:s,wcDeepLink:y}),_()}),h()]).then(_=>_[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ht(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0}):Tt(n)&&await this.sendError(s,i,n.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:s,resolve:a,reject:c}=Dr();this.events.once(Be("session_ping",n),({error:h})=>{h?c(h):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest({topic:i,method:"wc_sessionDelete",params:Ze("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Dg(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var a,c;return((a=s.peerMetadata)==null?void 0:a.url)&&((c=s.peerMetadata)==null?void 0:c.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(n.publicKey)&&await this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(ra).catch(s=>this.client.logger.warn(s))},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Ze("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=Kt.idle)},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Hr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:a}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:a}),i&&this.client.core.expirer.set(n,At(i))},this.sendRequest=async r=>{const{topic:i,method:n,params:s,expiry:a,relayRpcId:c,clientRpcId:h,throwOnFailedPublish:l}=r,f=ri(n,s,h);if(ci()&&m1.includes(n)){const w=Or(JSON.stringify(f));this.client.core.verify.register({attestationId:w})}const _=await this.client.core.crypto.encode(i,f),y=Hr[n].req;return a&&(y.ttl=a),c&&(y.id=c),this.client.core.history.set(i,f),l?(y.internal=Vr(yt({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,_,y)):this.client.core.relayer.publish(i,_,y).catch(w=>this.client.logger.error(w)),f.id},this.sendResult=async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:a}=r,c=as(i,s),h=await this.client.core.crypto.encode(n,c),l=await this.client.core.history.get(n,i),f=Hr[l.request.method].res;a?(f.internal=Vr(yt({},f.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,h,f)):this.client.core.relayer.publish(n,h,f).catch(_=>this.client.logger.error(_)),await this.client.core.history.resolve(c)},this.sendError=async(r,i,n)=>{const s=cs(r,n),a=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),h=Hr[c.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{Jt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Jt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Kt.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Kt.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Kt.idle},this.processRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:n}=k("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(yt({},i.params));const a=At(X.FIVE_MINUTES),c=yt({id:s,pairingTopic:r,expiry:a},n);await this.setProposal(s,c);const h=Or(JSON.stringify(i)),l=await this.getVerifyContext(h,c.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:c,verifyContext:l})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ht(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const l=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const f=await this.client.core.relayer.subscribe(l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else Tt(i)&&(await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")),this.events.emit(Be("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:h,namespaces:l,requiredNamespaces:f,optionalNamespaces:_,sessionProperties:y,pairingTopic:w}=i.params,D=yt({topic:r,relay:a,expiry:h,namespaces:l,acknowledged:!0,pairingTopic:w,requiredNamespaces:f,optionalNamespaces:_,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},y&&{sessionProperties:y});await this.sendResult({id:i.id,topic:r,result:!0}),this.events.emit(Be("session_connect"),{session:D}),this.cleanupDuplicatePairings(D)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ht(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Be("session_approve",n),{})):Tt(i)&&(await this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.events.emit(Be("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{const a=`${r}_session_update`,c=Ei.get(a);if(c&&this.isRequestOutOfSync(c,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidUpdate(yt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_update",{id:s,topic:r,params:n}),Ei.set(a,s)}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.isRequestOutOfSync=(r,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit(Be("session_update",n),{}):Tt(i)&&this.events.emit(Be("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,At(Di)),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit(Be("session_extend",n),{}):Tt(i)&&this.events.emit(Be("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ht(i)?this.events.emit(Be("session_ping",n),{}):Tt(i)&&this.events.emit(Be("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(lt.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult({id:n,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(yt({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s}),this.addSessionRequestToSessionRequestQueue({id:n,topic:r,params:s}),await this.processSessionRequestQueue()}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ht(i)?this.events.emit(Be("session_request",n),{result:i.result}):Tt(i)&&this.events.emit(Be("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{const a=`${r}_session_event_${s.event.name}`,c=Ei.get(a);if(c&&this.isRequestOutOfSync(c,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(yt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),Ei.set(a,n)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Kt.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===Kt.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:i,topic:n,params:s}=r,a=Or(JSON.stringify(ri("wc_sessionRequest",s,i))),c=this.client.session.get(n),h=await this.getVerifyContext(a,c.peer.metadata);this.sessionRequestQueue.state=Kt.active,this.client.events.emit("session_request",{id:i,topic:n,params:s,verifyContext:h})}catch(i){this.client.logger.error(i)}},this.isValidConnect=async r=>{if(!_t(r)){const{message:h}=k("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(dt(i)||await this.isValidPairingTopic(i),!Lg(c,!0)){const{message:h}=k("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(h)}!dt(n)&&kr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!dt(s)&&kr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),dt(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=$g(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!_t(r))throw new Error(k("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),h=Oi(n,"approve()");if(h)throw new Error(h.message);const l=Po(c.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!et(s,!0)){const{message:f}=k("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}dt(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!_t(r)){const{message:s}=k("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Ug(n)){const{message:s}=k("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!_t(r)){const{message:l}=k("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!ic(i)){const{message:l}=k("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const c=Pg(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=Oi(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(Jt(a)){const{message:l}=k("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async r=>{if(!_t(r)){const{message:h}=k("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=Oi(n,"update()");if(a)throw new Error(a.message);const c=Po(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!_t(r)){const{message:n}=k("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!_t(r)){const{message:h}=k("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:a}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Io(c,s)){const{message:h}=k("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!Mg(n)){const{message:h}=k("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!Bg(c,s,n.method)){const{message:h}=k("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(a&&!Vg(a,fn)){const{message:h}=k("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${fn.min} and ${fn.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!_t(r)){const{message:s}=k("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!jg(n)){const{message:s}=k("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!_t(r)){const{message:n}=k("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!_t(r)){const{message:c}=k("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Io(a,s)){const{message:c}=k("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!qg(n)){const{message:c}=k("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!zg(a,s,n.name)){const{message:c}=k("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!_t(r)){const{message:n}=k("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||xi,validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});s&&(n.verified.origin=s,n.verified.validation=s===new URL(i.url).origin?"VALID":"INVALID")}catch(s){this.client.logger.error(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!et(n,!1)){const{message:s}=k("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}async isInitialized(){if(!this.initialized){const{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(lt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);try{us(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Hi(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.client.core.history.delete(r,n.id)):this.onRelayEventUnknownPayload({topic:r,payload:n})}catch(s){this.client.logger.error(s)}})}registerExpirerEvents(){this.client.core.expirer.on(xt.expired,async e=>{const{topic:r,id:i}=tc(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,k("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!et(e,!1)){const{message:r}=k("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=k("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Jt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=k("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!et(e,!1)){const{message:r}=k("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=k("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Jt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=k("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(et(e,!1)){const{message:r}=k("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=k("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Fg(e)){const{message:r}=k("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=k("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Jt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=k("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class I1 extends Wi{constructor(e,r){super(e,r,g1,fs),this.core=e,this.logger=r}}class P1 extends Wi{constructor(e,r){super(e,r,_1,fs),this.core=e,this.logger=r}}class A1 extends Wi{constructor(e,r){super(e,r,w1,fs,i=>i.id),this.core=e,this.logger=r}}class ds extends rf{constructor(e){super(e),this.protocol=Sc,this.version=Oc,this.name=hn.name,this.events=new ae,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||hn.name,this.metadata=e?.metadata||Zp();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:me.pino(me.getDefaultLoggerOptions({level:e?.logger||hn.logger}));this.core=e?.core||new p1(e),this.logger=me.generateChildLogger(r,this.name),this.session=new P1(this.core,this.logger),this.proposal=new I1(this.core,this.logger),this.pendingRequest=new A1(this.core,this.logger),this.engine=new x1(this)}static async init(e){const r=new ds(e);return await r.initialize(),r}get context(){return me.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var T1=Object.defineProperty,C1=Object.defineProperties,N1=Object.getOwnPropertyDescriptors,sa=Object.getOwnPropertySymbols,R1=Object.prototype.hasOwnProperty,$1=Object.prototype.propertyIsEnumerable,oa=(t,e,r)=>e in t?T1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,L1=(t,e)=>{for(var r in e||(e={}))R1.call(e,r)&&oa(t,r,e[r]);if(sa)for(var r of sa(e))$1.call(e,r)&&oa(t,r,e[r]);return t},F1=(t,e)=>C1(t,N1(e)),ps=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Ae=(t,e,r)=>(ps(t,e,"read from private field"),r?r.call(t):e.get(t)),fr=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Ri=(t,e,r,i)=>(ps(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),at=(t,e,r)=>(ps(t,e,"access private method"),r),dr,Sr,Wr,Xe,Vn,Ic,ct,ft,Wn,aa;class J1{constructor(e){fr(this,Vn),fr(this,ct),fr(this,Wn),fr(this,dr,void 0),fr(this,Sr,void 0),fr(this,Wr,void 0),fr(this,Xe,void 0),Ri(this,dr,e),Ri(this,Sr,at(this,Vn,Ic).call(this)),at(this,ct,ft).call(this)}async connect(e){const{requiredNamespaces:r,optionalNamespaces:i}=e;return new Promise(async(n,s)=>{await at(this,ct,ft).call(this);const a=Ae(this,Sr).subscribeModal(l=>{l.open||(a(),s(new Error("Modal closed")))}),{uri:c,approval:h}=await Ae(this,Xe).connect(e);if(c){const l=new Set;r&&Object.values(r).forEach(({chains:f})=>{f&&f.forEach(_=>l.add(_))}),i&&Object.values(i).forEach(({chains:f})=>{f&&f.forEach(_=>l.add(_))}),await Ae(this,Sr).openModal({uri:c,chains:Array.from(l)})}try{const l=await h();n(l)}catch(l){s(l)}finally{a(),Ae(this,Sr).closeModal()}})}async disconnect(e){await at(this,ct,ft).call(this),await Ae(this,Xe).disconnect(e)}async request(e){return await at(this,ct,ft).call(this),await Ae(this,Xe).request(e)}async getSessions(){return await at(this,ct,ft).call(this),Ae(this,Xe).session.getAll()}async getSession(){return await at(this,ct,ft).call(this),Ae(this,Xe).session.getAll().at(-1)}async onSessionEvent(e){await at(this,ct,ft).call(this),Ae(this,Xe).on("session_event",e)}async offSessionEvent(e){await at(this,ct,ft).call(this),Ae(this,Xe).off("session_event",e)}async onSessionUpdate(e){await at(this,ct,ft).call(this),Ae(this,Xe).on("session_update",e)}async offSessionUpdate(e){await at(this,ct,ft).call(this),Ae(this,Xe).off("session_update",e)}async onSessionDelete(e){await at(this,ct,ft).call(this),Ae(this,Xe).on("session_delete",e)}async offSessionDelete(e){await at(this,ct,ft).call(this),Ae(this,Xe).off("session_delete",e)}async onSessionExpire(e){await at(this,ct,ft).call(this),Ae(this,Xe).on("session_expire",e)}async offSessionExpire(e){await at(this,ct,ft).call(this),Ae(this,Xe).off("session_expire",e)}}dr=new WeakMap,Sr=new WeakMap,Wr=new WeakMap,Xe=new WeakMap,Vn=new WeakSet,Ic=function(){const{modalOptions:t,projectId:e}=Ae(this,dr);return new Fu(F1(L1({},t),{projectId:e}))},ct=new WeakSet,ft=async function(){return Ae(this,Xe)?!0:(!Ae(this,Wr)&&typeof window<"u"&&Ri(this,Wr,at(this,Wn,aa).call(this)),Ae(this,Wr))},Wn=new WeakSet,aa=async function(){Ri(this,Xe,await ds.init({metadata:Ae(this,dr).metadata,projectId:Ae(this,dr).projectId,relayUrl:Ae(this,dr).relayUrl}));const t=await Ae(this,Xe).core.crypto.getClientId();try{localStorage.setItem("WCM_WALLETCONNECT_CLIENT_ID",t)}catch{console.info("Unable to set client id")}};export{ca as A,U1 as G,Yi as Q,J1 as W,ut as a,Ct as c,M1 as o,$s as s,xr as v,Eu as x};
//# sourceMappingURL=bundle-88a258a1.js.map
