import{H as T,r as m,j as e,F as l,I as u,k as p,s as D,L as w,w as F,aj as I,y as j,ak as h,x as R,z as g}from"./index-MtGPO_T6.js";const S=(s,o)=>{let t=localStorage.getItem("QuestForStoken.0.game.sav");t||(t=`[qfs]
`,t+=`${s}="${o}"`);const i=t.split(`
`);let a=!1;for(let x=0;x<i.length;x++)if(i[x].includes(s)){a=!0,i[x]=`${s}="${o}"`;break}a||i.push(`${s}="${o}"`),localStorage.setItem("QuestForStoken.0.game.sav",i.join(`
`))},b=s=>{const o=localStorage.getItem("QuestForStoken.0.game.sav");if(!o)return!1;const t=o.split(`
`);for(let i=0;i<t.length;i++)if(t[i].includes(s)){let a=t[i].split("=")[1];return a=a.replace(/"/g,""),a=a.replace(/\r/g,""),a}return!1},U=s=>{const o=localStorage.getItem("QuestForStoken.0.game.sav");if(o){const t=o.split(`
`);for(let i=0;i<t.length;i++)if(t[i].includes(s)){t.splice(i,1);break}localStorage.setItem("QuestForStoken.0.game.sav",t.join(`
`))}},N=()=>{let s=b("Update");return s?parseInt(s)===1:!1},f="https://www.stoken.quest/";function O(){const{user:s}=T(),{isLoggedIn:o}=T(),[t,i]=m.useState({username:"guest",highscore:0,time:0}),[a,x]=m.useState([]),[L,$]=m.useState([]),[c,z]=m.useState(),v=async()=>{const n=await(await fetch(f+"leaderboard")).json();x(n)},k=async()=>{const n=await(await fetch(f+"times")).json();$(n)},E=async()=>{const n=await(await fetch(f+"rewardpool")).json(),{post:d}=n,B=(parseFloat(d.pending_payout_value.split(" ")[0])/2/2).toFixed(3),q=d.active_votes.some(H=>H.voter===(s==null?void 0:s.name));z({name:d.title,link:`https://skatehive.app/profile/@${d.author}/${d.permlink}`,reward:B,isVoted:q})},A=async()=>{if(!(s!=null&&s.name)){y();return}const n=await(await fetch(f+"getuser/"+(s==null?void 0:s.name))).json();i({username:n.username,highscore:n.highscore,time:n.time}),window.addEventListener("storage",async()=>{if(N())U("Update"),await Q();else return}),window.dispatchEvent(new Event("storage")),y()},y=()=>{const r=document.querySelector("iframe");r==null||r.setAttribute("src","QFS/index.html")},Q=async()=>{const r=b("Username")||"guest",n=b("Highscore")||0,d=b("Time")||0;r!=="guest"&&(await fetch(f+"pushscore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,highscore:n,time:d})}),i({username:r,highscore:n?parseFloat(n):0,time:d?parseInt(d):0}),v(),k())};return m.useEffect(()=>{E(),v(),k(),A()},[s]),m.useEffect(()=>{t.username!=="guest"?S("Username",t.username):U("Username"),S("Highscore",t.highscore),S("Time",t.time)},[t]),e.jsxs(l,{marginTop:12,direction:"column",align:"center",justify:"center",width:"100%",children:[t.username!=="guest"&&o()?e.jsxs(l,{direction:"row",align:"center",gap:10,marginBottom:10,children:[e.jsxs(l,{direction:"row",alignItems:"center",border:"3px solid green",gap:2,borderRadius:"md",padding:1,paddingLeft:2,paddingRight:2,children:[e.jsx(u,{src:"assets/coinspin.gif",width:"30px",height:"30px"}),e.jsx(p,{fontSize:"2xl",children:t.highscore.toFixed(0)})]}),e.jsxs(l,{direction:"row",alignItems:"center",border:"3px solid green",gap:2,borderRadius:"md",padding:1,paddingLeft:2,paddingRight:2,children:[e.jsx(u,{src:"assets/clockspin.gif",width:"28px",height:"28px"}),e.jsx(p,{fontSize:"2xl",children:t.time>60?Math.floor(t.time/60)+"m "+t.time%60+"s":t.time+"s"})]})]}):e.jsx(p,{fontSize:"2xl",fontWeight:"bold",marginBottom:10,children:"Login to save your stats!"}),e.jsx(D,{padding:2,marginBottom:10,children:e.jsx("iframe",{width:"1280",height:"720",style:{background:"#000000",borderRadius:"20px"}})}),e.jsx(p,{fontSize:"3xl",children:e.jsx(w,{style:{textDecoration:"none"},href:(c==null?void 0:c.link)||"https://peakd.com/@stoken.quest/",isExternal:!0,children:(c==null?void 0:c.name)||"The Quest For Stoken!"})}),e.jsxs(l,{direction:"row",alignItems:"center",border:"3px solid green",gap:2,borderRadius:"md",padding:1,paddingLeft:2,paddingRight:2,children:[e.jsx(u,{src:"assets/coinspin.gif",width:"30px",height:"30px"}),e.jsxs(p,{fontSize:"2xl",children:["Reward Pool: $",c==null?void 0:c.reward]})]}),e.jsxs(l,{direction:"row",justify:"space-around",align:"start",width:"100%",marginTop:10,gap:10,children:[e.jsxs(l,{direction:"column",align:"center",justify:"center",width:"50%",children:[e.jsx(p,{fontSize:"3xl",fontWeight:"bold",children:"Leaderboard"}),e.jsxs(F,{width:"100%",border:"1px solid green",children:[e.jsx(I,{children:e.jsxs(j,{children:[e.jsx(h,{border:"0px",children:"#"}),e.jsx(h,{border:"0px",children:"User"}),e.jsx(h,{border:"0px",children:"Username"}),e.jsx(h,{border:"0px",w:"20%",textAlign:"center",children:"Highscore"})," "]})}),e.jsx(R,{children:a.map((r,n)=>e.jsxs(j,{bg:(n+1)%2===0?"black":"rgba(83, 206, 63, 0.3)",color:"white",children:[" ",e.jsxs(g,{border:"0px",children:[" ",n+1]}),e.jsxs(g,{border:"0px",children:[" ",e.jsx(u,{src:`https://images.hive.blog/u/${r.username}/avatar`,alt:"profile avatar",borderRadius:"10px",border:"2px solid limegreen",boxSize:"35px"})]}),e.jsxs(g,{border:"0px",children:[" ",e.jsxs(w,{style:{textDecoration:"none"},href:"https://skatehive.app/profile/"+r.username,isExternal:!0,children:["@",r.username]})]}),e.jsxs(g,{isNumeric:!0,textAlign:"center",border:"0px",children:[" ",r.highscore.toFixed(2)]})]},n))})]})]}),e.jsxs(l,{direction:"column",align:"center",justify:"center",width:"50%",children:[e.jsx(p,{fontSize:"3xl",fontWeight:"bold",children:"Best Times"}),e.jsxs(F,{bg:"black",width:"100%",border:"1px solid green",borderRadius:"10px",children:[e.jsx(I,{children:e.jsxs(j,{children:[e.jsx(h,{border:"none",children:"#"}),e.jsx(h,{border:"none",children:"Avatar"}),e.jsx(h,{border:"none",children:"Username"}),e.jsx(h,{border:"none",w:"20%",textAlign:"center",children:"Time"})," "]})}),e.jsx(R,{children:L.map((r,n)=>e.jsxs(j,{bg:(n+1)%2===0?"black":"rgba(83, 206, 63, 0.3)",color:"white",children:[" ",e.jsxs(g,{border:"none",children:[" ",n+1]}),e.jsxs(g,{border:"none",children:[" ",e.jsx(u,{src:`https://images.hive.blog/u/${r.username}/avatar`,alt:"profile avatar",borderRadius:"10px",border:"2px solid limegreen",boxSize:"35px"})]}),e.jsxs(g,{border:"none",children:[" ",e.jsxs(w,{style:{textDecoration:"none"},href:"https://skatehive.app/profile/"+r.username,isExternal:!0,children:["@",r.username]})]}),e.jsxs(g,{isNumeric:!0,textAlign:"center",border:"none",children:[" ",r.time]})]},n))})]})]})]})]})}export{O as default};
